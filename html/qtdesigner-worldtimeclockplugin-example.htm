<html lang="en"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>World Time Clock Plugin Example | Qt Designer Manual</title>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <!-- Google Tag Manager -->
    
  <!-- End Google Tag Manager -->
  
  
</head>
<body class="qt-design-system" style="background:var(--content-bg-color)" onload="prettyPrint()">

<div data-global-resource-path="qt-design-system/components/b-sidebar.html">
    <div class="b-sidebar b-sidebar--full-width">
        
        <div class="b-sidebar__content">
            <div class="b-sidebar__topbar" data-margin-bottom="sm">
                <div class="b-topbar">
                                        <div class="b-topbar__breadcrump" translate="no">
                        <ul class="c-breadcrump">
                            <li><a href="./index.htm" translate="no">Qt 5.15</a></li>
                            <li><a href="./qtdesigner-manual.htm" translate="no">Qt Designer Manual</a></li>
                            <li><a href="./examples-designer.htm" translate="no">Qt Designer Examples</a></li>
                            <li><a>World Time Clock Plugin Example</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="b-sidebar__content__wrapper">
                <article class="b-sidebar__content__left">
                    <div class="context mainContent" style="margin: 0;padding: 0; background: 0;">
                    

<div class="context">
<h1 class="title">World Time Clock Plugin Example</h1>
<span class="subtitle"></span>
<!-- $$$worldtimeclockplugin-brief -->
<p>Creating a custom widget plugin for <i>Qt Designer</i> that uses signals and slots.</p>
<!-- @@@worldtimeclockplugin -->
<!-- $$$worldtimeclockplugin-description -->
<div class="descr"> <a name="details"></a>
<p class="centerAlign"><img alt="" src="./images/worldtimeclockplugin-example.png"></p><p>In this example, we simply extend the <a href="./qtdesigner-customwidgetplugin-example.htm" translate="no">Custom Widget Plugin</a> example and its custom widget (based on the <a href="./qtwidgets-widgets-analogclock-example.htm" translate="no">Analog Clock</a> example), by introducing the concept of signals and slots.</p>
<p>The World Time Clock Plugin example consists of two classes:</p>
<ul>
<li><code translate="no">WorldTimeClock</code> is a custom clock widget with hour and minute hands that is automatically updated every few seconds.</li>
<li><code translate="no">WorldTimeClockPlugin</code> exposes the <code translate="no">WorldTimeClock</code> class to <i>Qt Designer</i>.</li>
</ul>
<p>First we will take a look at the <code translate="no">WorldTimeClock</code> class which extends the <a href="./qtdesigner-customwidgetplugin-example.htm" translate="no">Custom Widget Plugin</a> example's <code translate="no">AnalogClock</code> class by providing a signal and a slot. Then we will take a quick look at the <code translate="no">WorldTimeClockPlugin</code> class, but this class is in most parts identical to the <a href="./qtdesigner-customwidgetplugin-example.htm" translate="no">Custom Widget Plugin</a> example's implementation.</p>
<p>Finally we take a look at the plugin's project file. The project file for custom widget plugins needs some additional information to ensure that they will work within <i>Qt Designer</i>. This is also covered in the <a href="./qtdesigner-customwidgetplugin-example.htm" translate="no">Custom Widget Plugin</a> example, but due to its importance (custom widget plugins rely on components supplied with <i>Qt Designer</i> which must be specified in the project file that we use) we will repeat it here.</p>
<a name="worldtimeclock-class"></a>
<h4 id="worldtimeclock-class">WorldTimeClock Class<a class="plink" href="#worldtimeclock-class" title="Direct link to this headline"></a></h4>
<p>The <code translate="no">WorldTimeClock</code> class inherits <a href="./qwidget.htm" translate="no">QWidget</a>, and is a custom clock widget with hour and minute hands that is automatically updated every few seconds. What makes this example different from the <a href="./qtdesigner-customwidgetplugin-example.htm" translate="no">Custom Widget Plugin</a> example, is the introduction of the signal and slot in the custom widget class:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="keyword">class</span> QDESIGNER_WIDGET_EXPORT WorldTimeClock : <span class="keyword">public</span> <span class="type"><a href="./qwidget.htm" translate="no">QWidget</a></span>
{
    Q_OBJECT

<span class="keyword">public</span>:
    <span class="keyword">explicit</span> WorldTimeClock(<span class="type"><a href="./qwidget.htm" translate="no">QWidget</a></span> <span class="operator">*</span>parent <span class="operator">=</span> nullptr);

<span class="keyword">public</span> <span class="keyword">slots</span>:
    <span class="type">void</span> setTimeZone(<span class="type">int</span> hourOffset);

<span class="keyword">signals</span>:
    <span class="type">void</span> updated(<span class="type"><a href="./qtime.htm" translate="no">QTime</a></span> currentTime);

<span class="keyword">protected</span>:
    <span class="type">void</span> paintEvent(<span class="type">QPaintEvent</span> <span class="operator">*</span>event) override;

<span class="keyword">private</span>:
    <span class="type">int</span> timeZoneOffset <span class="operator">=</span> <span class="number">0</span>;
};</pre></div>
<p>Note the use of the <a href="./qdesignercustomwidgetinterface.htm#QDESIGNER_WIDGET_EXPORT" translate="no">QDESIGNER_WIDGET_EXPORT</a> macro. This is needed to ensure that <i>Qt Designer</i> can create instances of the widget on some platforms, but it is a good idea to use it on all platforms.</p>
<p>We declare the <code translate="no">setTimeZone()</code> slot with an associated <code translate="no">timeZoneOffset</code> variable, and we declare an <code translate="no">updated()</code> signal which takes the current time as argument and is emitted whenever the widget is repainted.</p>
<p class="centerAlign"><img alt="" src="./images/worldtimeclock-connection.png"></p><p>In <i>Qt Designer</i>'s workspace we can then, for example, connect the <code translate="no">WorldTimeClock</code> widget's <code translate="no">updated()</code> signal to a <a href="./qtimeedit.htm" translate="no">QTimeEdit</a>'s <a href="./qdatetimeedit.htm#time-prop" translate="no">setTime()</a> slot using <i>Qt Designer</i>'s mode for editing signal and slots.</p>
<p class="centerAlign"><img alt="" src="./images/worldtimeclock-signalandslot.png"></p><p>We can also connect a <a href="./qspinbox.htm" translate="no">QSpinBox</a>'s <a href="./qspinbox.htm#valueChanged" translate="no">valueChanged()</a> signal to the <code translate="no">WorldTimeClock</code>'s <code translate="no">setTimeZone()</code> slot.</p>
<a name="worldtimeclockplugin-class"></a>
<h4 id="worldtimeclockplugin-class">WorldTimeClockPlugin Class<a class="plink" href="#worldtimeclockplugin-class" title="Direct link to this headline"></a></h4>
<p>The <code translate="no">WorldTimeClockPlugin</code> class exposes the <code translate="no">WorldTimeClock</code> class to <i>Qt Designer</i>. Its definition is equivalent to the <a href="./qtdesigner-customwidgetplugin-example.htm" translate="no">Custom Widget Plugin</a> example's plugin class which is explained in detail. The only part of the class definition that is specific to this particular custom widget is the class name:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="keyword">class</span> WorldTimeClockPlugin : <span class="keyword">public</span> <span class="type"><a href="./qobject.htm" translate="no">QObject</a></span><span class="operator">,</span>
                             <span class="keyword">public</span> <span class="type"><a href="./qdesignercustomwidgetinterface.htm" translate="no">QDesignerCustomWidgetInterface</a></span>
{
    Q_OBJECT
    Q_PLUGIN_METADATA(IID <span class="string">"org.qt-project.Qt.QDesignerCustomWidgetInterface"</span>)
    Q_INTERFACES(<span class="type"><a href="./qdesignercustomwidgetinterface.htm" translate="no">QDesignerCustomWidgetInterface</a></span>)

<span class="keyword">public</span>:
    <span class="keyword">explicit</span> WorldTimeClockPlugin(<span class="type"><a href="./qobject.htm" translate="no">QObject</a></span> <span class="operator">*</span>parent <span class="operator">=</span> nullptr);

    bool isContainer() <span class="keyword">const</span> override;
    bool isInitialized() <span class="keyword">const</span> override;
    <span class="type">QIcon</span> icon() <span class="keyword">const</span> override;
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> domXml() <span class="keyword">const</span> override;
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> group() <span class="keyword">const</span> override;
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> includeFile() <span class="keyword">const</span> override;
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> name() <span class="keyword">const</span> override;
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> toolTip() <span class="keyword">const</span> override;
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> whatsThis() <span class="keyword">const</span> override;
    <span class="type"><a href="./qwidget.htm" translate="no">QWidget</a></span> <span class="operator">*</span>createWidget(<span class="type"><a href="./qwidget.htm" translate="no">QWidget</a></span> <span class="operator">*</span>parent) override;
    <span class="type">void</span> initialize(<span class="type"><a href="./qdesignerformeditorinterface.htm" translate="no">QDesignerFormEditorInterface</a></span> <span class="operator">*</span>core) override;

<span class="keyword">private</span>:
    bool initialized <span class="operator">=</span> <span class="keyword">false</span>;
};</pre></div>
<p>The plugin class provides <i>Qt Designer</i> with basic information about our plugin, such as its class name and its include file. Furthermore it knows how to create instances of the <code translate="no">WorldTimeClockPlugin</code> widget. <code translate="no">WorldTimeClockPlugin</code> also defines the <a href="./qdesignercustomwidgetinterface.htm#initialize" translate="no">initialize()</a> function which is called after the plugin is loaded into <i>Qt Designer</i>. The function's <a href="./qdesignerformeditorinterface.htm" translate="no">QDesignerFormEditorInterface</a> parameter provides the plugin with a gateway to all of <i>Qt Designer</i>'s API's.</p>
<p>The <code translate="no">WorldTimeClockPlugin</code> class inherits from both <a href="./qobject.htm" translate="no">QObject</a> and <a href="./qdesignercustomwidgetinterface.htm" translate="no">QDesignerCustomWidgetInterface</a>. It is important to remember, when using multiple inheritance, to ensure that all the interfaces (i.e. the classes that doesn't inherit <a href="./qobject.htm#Q_OBJECT" translate="no">Q_OBJECT</a>) are made known to the meta object system using the <a href="./qobject.htm#Q_INTERFACES" translate="no">Q_INTERFACES</a>() macro. This enables <i>Qt Designer</i> to use <a href="./qobject.htm#qobject_cast" translate="no">qobject_cast</a>(QObject * object) to query for supported interfaces using nothing but a <a href="./qobject.htm" translate="no">QObject</a> pointer.</p>
<p>The implementation of the <code translate="no">WorldTimeClockPlugin</code> is also equivalent to the plugin interface implementation in the <a href="./qtdesigner-customwidgetplugin-example.htm" translate="no">Custom Widget Plugin</a> example (only the class name and the implementation of <a href="./qdesignercustomwidgetinterface.htm#domXml" translate="no">QDesignerCustomWidgetInterface::domXml</a>() differ). The main thing to remember is to use the <a href="./qtplugin.htm#Q_PLUGIN_METADATA" translate="no">Q_PLUGIN_METADATA</a>() macro to export the <code translate="no">WorldTimeClockPlugin</code> class for use with <i>Qt Designer</i>:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">    Q_PLUGIN_METADATA(IID <span class="string">"org.qt-project.Qt.QDesignerCustomWidgetInterface"</span>)</pre></div>
<p>Without this macro, there is no way for Qt Designer to use the widget.</p>
<a name="the-project-file-worldtimeclockplugin-pro"></a>
<h4 id="the-project-file-worldtimeclockplugin-pro">The Project File: worldtimeclockplugin.pro<a class="plink" href="#the-project-file-worldtimeclockplugin-pro" title="Direct link to this headline"></a></h4>
<p>The project file for custom widget plugins needs some additional information to ensure that they will work as expected within <i>Qt Designer</i>:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">QT          += widgets uiplugin
CONFIG     += plugin
TEMPLATE    = lib</pre></div>
<p>The <code translate="no">TEMPLATE</code> variable's value in conjunction with the keyword <code translate="no">plugin</code> in the <code translate="no">CONFIG</code> variable make <code translate="no">qmake</code> create the custom widget as a plugin library.</p>
<p>The <code translate="no">QT</code> variable contains the keyword <code translate="no">uiplugin</code>. This plugin type provides a factory function for custom widget creation by implementing the abstract interfaces <a href="./qdesignercustomwidgetinterface.htm" translate="no">QDesignerCustomWidgetInterface</a> or <a href="./qdesignercustomwidgetcollectioninterface.htm" translate="no">QDesignerCustomWidgetCollectionInterface</a>, suitable for use with <a href="./quiloader.htm" translate="no">QUiLoader</a>. It does not have a dependency on the <i>Qt Designer</i> libraries. Plugins accessing other interfaces of <i>Qt Designer</i> to implement container extensions or other <i>Qt Designer</i> specific functionality follow different rules and are covered by other examples.</p>
<p>The header and source files for the widget are declared in the usual way, and in addition we provide an implementation of the plugin interface so that <i>Qt Designer</i> can use the custom widget.</p>
<div class="pre"><pre class="cpp" translate="no">HEADERS     = worldtimeclock.h \
              worldtimeclockplugin.h
SOURCES     = worldtimeclock.cpp \
              worldtimeclockplugin.cpp</pre></div>
<p>It is important to ensure that the plugin is installed in a location that is searched by <i>Qt Designer</i>. We do this by specifying a target path for the project and adding it to the list of items to install:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">target.path = $$[QT_INSTALL_PLUGINS]/designer
INSTALLS += target</pre></div>
<p>The custom widget is created as a library, and will be installed alongside the other <i>Qt Designer</i> plugins when the project is installed (using <code translate="no">make install</code> or an equivalent installation procedure). Later, we will ensure that it is recognized as a plugin by <i>Qt Designer</i> by using the <a href="./qtplugin.htm#Q_PLUGIN_METADATA" translate="no">Q_PLUGIN_METADATA</a>() macro to export the relevant widget information.</p>
<p>Note that if you want the plugins to appear in a Visual Studio integration, the plugins must be built in release mode and their libraries must be copied into the plugin directory in the install path of the integration (for an example, see <code translate="no">C:/program files/trolltech as/visual studio integration/plugins</code>).</p>
<p>For more information about plugins, see the <a href="./plugins-howto.htm" translate="no">How to Create Qt Plugins</a> document.</p>
<p><a href="https://code.qt.io/cgit/qt/qttools.git/tree/examples/designer/worldtimeclockplugin?h=5.15" translate="no">Example project @ code.qt.io</a></p>
</div>
<!-- @@@worldtimeclockplugin -->
</div>
<p class="copy-notice">
<acronym title="Copyright">Â©</acronym> 2025 The Qt Company Ltd.
   Documentation contributions included herein are the copyrights of
   their respective owners.     The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the Free Software Foundation.     Qt and respective logos are <a href="https://doc.qt.io/qt/trademarks.html">    trademarks</a> of The Qt Company Ltd. in Finland and/or other countries
   worldwide. All other trademarks are property of their respective owners. </p>

                    </div>
                </article>
                
            </div>
        </div>
    </div>
</div>
</body></html>