<html lang="en"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Using ActiveX controls and COM in Qt | Active Qt</title>
<link rel="canonical" href="https://doc.qt.io/qt-6/activeqt-container.html">
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <!-- Google Tag Manager -->
    
  <!-- End Google Tag Manager -->
  
  
</head>
<body class="qt-design-system" style="background:var(--content-bg-color)" onload="prettyPrint()">

<div data-global-resource-path="qt-design-system/components/b-sidebar.html">
    <div class="b-sidebar b-sidebar--full-width">
        
        <div class="b-sidebar__content">
            <div class="b-sidebar__topbar" data-margin-bottom="sm">
                <div class="b-topbar">
                                        <div class="b-topbar__breadcrump" translate="no">
                        <ul class="c-breadcrump">
                            <li><a href="./index.htm" translate="no">Qt 5.15</a></li>
                            <li><a href="./activeqt-index.htm" translate="no">Active Qt</a></li>
                            <li><a>Using ActiveX controls and COM in Qt</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="b-sidebar__content__wrapper">
                <article class="b-sidebar__content__left">
                    <div class="context mainContent" style="margin: 0;padding: 0; background: 0;">
                    

<div class="context">
<h1 class="title">Using ActiveX controls and COM in Qt</h1>
<span class="subtitle"></span>
<!-- $$$activeqt-container.html-description -->
<div class="descr"> <a name="details"></a>
<p>The <a href="./qaxcontainer-module.htm" translate="no">QAxContainer</a> module is part of the <a href="./activeqt-index.htm" translate="no">ActiveQt</a> framework. It provides a library implementing a <a href="./qwidget.htm" translate="no">QWidget</a> subclass, <a href="./qaxwidget.htm" translate="no">QAxWidget</a>, that acts as a container for ActiveX controls, and a <a href="./qobject.htm" translate="no">QObject</a> subclass, <a href="./qaxobject.htm" translate="no">QAxObject</a>, that can be used to easily access non-visual COM objects. Scripting COM objects embedded using these classes is possible through the <a href="./qaxscript.htm" translate="no">QAxScript</a>, <a href="./qaxscriptmanager.htm" translate="no">QAxScriptManager</a> and <a href="./qaxscriptengine.htm" translate="no">QAxScriptEngine</a> classes, and a set of <a href="./activeqt-tools.htm" translate="no">tools</a> makes it easy to access COM objects programmatically.</p>
<p>The module consists of six classes</p>
<ol class="1" type="1"><li><a href="./qaxbase.htm" translate="no">QAxBase</a> is an abstract class that provides an API to initialize and access a COM object or ActiveX control.</li>
<li><a href="./qaxobject.htm" translate="no">QAxObject</a> provides a <a href="./qobject.htm" translate="no">QObject</a> that wraps a COM object.</li>
<li><a href="./qaxwidget.htm" translate="no">QAxWidget</a> is a <a href="./qwidget.htm" translate="no">QWidget</a> that wraps an ActiveX control.</li>
<li><a href="./qaxscriptmanager.htm" translate="no">QAxScriptManager</a>, <a href="./qaxscript.htm" translate="no">QAxScript</a> and <a href="./qaxscriptengine.htm" translate="no">QAxScriptEngine</a> provide an interface to the Windows Script Host.</li>
</ol>
<p>Some <a href="./examples-activeqt.htm" translate="no">example applications</a> that use standard ActiveX controls to provide high-level user interface functionality are provided.</p>
<p>Topics:</p>
<a name="using-the-library"></a>
<h2 id="using-the-library">Using the Library<a class="plink" href="#using-the-library" title="Direct link to this headline"></a></h2>
<p>To build Qt applications that can host COM objects and ActiveX controls link the application against the <a href="./qaxcontainer-module.htm" translate="no">QAxContainer</a> module by adding</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">QT += axcontainer</pre></div>
<p>to your application's <code translate="no">.pro</code> file.</p>
<a name="distributing-qaxcontainer-applications"></a>
<h3 id="distributing-qaxcontainer-applications">Distributing QAxContainer Applications<a class="plink" href="#distributing-qaxcontainer-applications" title="Direct link to this headline"></a></h3>
<p>The <a href="./qaxcontainer-module.htm" translate="no">QAxContainer</a> library is static, so there is no need to redistribute any additional files when using this module. Note however that the ActiveX server binaries you are using might not be installed on the target system, so you have to ship them with your package and register them during the installation process of your application.</p>
<a name="instantiating-com-objects"></a>
<h2 id="instantiating-com-objects">Instantiating COM Objects<a class="plink" href="#instantiating-com-objects" title="Direct link to this headline"></a></h2>
<p>To instantiate a COM object use the <a href="./qaxbase.htm#control-prop" translate="no">QAxBase::setControl</a>() API, or pass the name of the object directly into the constructor of the <a href="./qaxbase.htm" translate="no">QAxBase</a> subclass you are using.</p>
<p>The control can be specified in a variety of formats, but the fastest and most powerful format is to use the class ID (CLSID) of the object directly. The class ID can be prepended with information about a remote machine that the object should run on, and can include a license key for licensed controls.</p>
<a name="typical-error-messages"></a>
<h3 id="typical-error-messages">Typical Error Messages<a class="plink" href="#typical-error-messages" title="Direct link to this headline"></a></h3>
<p><a href="./activeqt-index.htm" translate="no">ActiveQt</a> prints error messages to the debug output when it encounters error situations at runtime. Usually you must run your program in the debugger to see these messages (e.g. in Visual Studio's Debug output).</p>
<a name="requested-control-could-not-be-instantiated"></a>
<h4 id="requested-control-could-not-be-instantiated">Requested control could not be instantiated<a class="plink" href="#requested-control-could-not-be-instantiated" title="Direct link to this headline"></a></h4>
<p>The control requested in <a href="./qaxbase.htm#control-prop" translate="no">QAxBase::setControl</a>() is not installed on this system, or is not accessible for the current user.</p>
<p>The control might require administrator rights, or a license key. If the control is licensed, pass the license key to <a href="./qaxbase.htm#control-prop" translate="no">QAxBase::setControl</a> as documented.</p>
<a name="accessing-the-object-api"></a>
<h2 id="accessing-the-object-api">Accessing the Object API<a class="plink" href="#accessing-the-object-api" title="Direct link to this headline"></a></h2>
<p><a href="./activeqt-index.htm" translate="no">ActiveQt</a> provides a Qt API to the COM object, and replaces COM datatypes with Qt equivalents.</p>
<p>There are four ways to call APIs on the COM object:</p>
<ul>
<li>Generating a C++ namespace</li>
<li>Call-by-name</li>
<li>Through a script engine</li>
<li>Using the native COM interfaces</li>
</ul>
<a name="generating-a-c-namespace"></a>
<h3 id="generating-a-c-namespace">Generating a C++ Namespace<a class="plink" href="#generating-a-c-namespace" title="Direct link to this headline"></a></h3>
<p>To generate a C++ namespace for the type library you want to access, use the <a href="./activeqt-dumpcpp.htm" translate="no">dumpcpp</a> tool. Run this tool manually on the type library you want to use, or integrate it into the build system by adding the type libraries to the <code translate="no">TYPELIBS</code> variable in your application's <code translate="no">.pro</code> file:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">TYPELIBS = file.tlb</pre></div>
<p>Note that <a href="./activeqt-dumpcpp.htm" translate="no">dumpcpp</a> might not be able to expose all APIs in the type library.</p>
<p>Include the resulting header file in your code to access the object APIs through the generated C++ classes. See the <a href="./activeqt-activeqt-qutlook-example.htm" translate="no">Qutlook</a> example for more information.</p>
<a name="call-by-name"></a>
<h3 id="call-by-name">Call-by-Name<a class="plink" href="#call-by-name" title="Direct link to this headline"></a></h3>
<p>Use <a href="./qaxbase.htm#dynamicCall" translate="no">QAxBase::dynamicCall</a>() and <a href="./qaxbase.htm#querySubObject" translate="no">QAxBase::querySubObject</a>() as well as the <a href="./qobject.htm#setProperty" translate="no">QObject::setProperty</a>() and <a href="./qobject.htm#property" translate="no">QObject::property</a>() APIs to call the methods and properties of the COM object through their name. Use the <a href="./activeqt-dumpdoc.htm" translate="no">dumpdoc</a> tool to get the documentation of the Qt API for any COM object and its subobjects; note that not all of the COM object's APIs might be available.</p>
<p>See the <a href="./activeqt-activeqt-mediaplayer-example.htm" translate="no">Media Player</a> example for more information.</p>
<a name="calling-function-through-a-script-engine"></a>
<h3 id="calling-function-through-a-script-engine">Calling Function Through a Script Engine<a class="plink" href="#calling-function-through-a-script-engine" title="Direct link to this headline"></a></h3>
<p>A Qt application can host any ActiveScript engine installed on the system. The script engine can then run script code that accesses the COM objects.</p>
<p>To instantiate a script engine, use <a href="./qaxscriptmanager.htm#addObject" translate="no">QAxScriptManager::addObject</a>() to register the COM objects you want to access from script, and <a href="./qaxscriptmanager.htm#load" translate="no">QAxScriptManager::load</a>() to load the script code into the engine. Then call the script functions using <a href="./qaxscriptmanager.htm#call" translate="no">QAxScriptManager::call</a>() or <a href="./qaxscript.htm#call" translate="no">QAxScript::call</a>().</p>
<p>Which APIs of the COM object are available through scripting depends on the script language used.</p>
<p>The <a href="./activeqt-testcon.htm" translate="no">ActiveX Test Container</a> demonstrates loading of script files.</p>
<a name="calling-a-function-using-the-native-com-interfaces"></a>
<h3 id="calling-a-function-using-the-native-com-interfaces">Calling a Function Using the Native COM Interfaces<a class="plink" href="#calling-a-function-using-the-native-com-interfaces" title="Direct link to this headline"></a></h3>
<p>To call functions of the COM object that can not be accessed via any of the above methods it is possible to request the COM interface directly using <a href="./qaxbase.htm#queryInterface" translate="no">QAxBase::queryInterface</a>(). To get a C++ definition of the respective interface classes use the <code translate="no">#import</code> directive with the type library provided with the control; see your compiler manual for details.</p>
<a name="typical-error-messages"></a>
<h3 id="typical-error-messages">Typical Error Messages<a class="plink" href="#typical-error-messages" title="Direct link to this headline"></a></h3>
<p><a href="./activeqt-index.htm" translate="no">ActiveQt</a> prints error messages to the debug output when it encounters error situations at runtime. Usually you must run your program in the debugger to see these messages (e.g. in Visual Studio's Debug output).</p>
<a name="qaxbase-internalinvoke-no-such-method"></a>
<h4 id="qaxbase-internalinvoke-no-such-method">QAxBase::internalInvoke: No such method<a class="plink" href="#qaxbase-internalinvoke-no-such-method" title="Direct link to this headline"></a></h4>
<p>A <a href="./qaxbase.htm#dynamicCall" translate="no">QAxBase::dynamicCall</a>() failed - the function prototype did not match any function available in the object's API.</p>
<a name="error-calling-idispatch-member-non-optional-parameter-missing"></a>
<h4 id="error-calling-idispatch-member-non-optional-parameter-missing">Error calling IDispatch member: Non-optional parameter missing<a class="plink" href="#error-calling-idispatch-member-non-optional-parameter-missing" title="Direct link to this headline"></a></h4>
<p>A <a href="./qaxbase.htm#dynamicCall" translate="no">QAxBase::dynamicCall</a>() failed - the function prototype was correct, but too few parameters were provided.</p>
<a name="error-calling-idispatch-member-type-mismatch-in-parameter-n"></a>
<h4 id="error-calling-idispatch-member-type-mismatch-in-parameter-n">Error calling IDispatch member: Type mismatch in parameter n<a class="plink" href="#error-calling-idispatch-member-type-mismatch-in-parameter-n" title="Direct link to this headline"></a></h4>
<p>A <a href="./qaxbase.htm#dynamicCall" translate="no">QAxBase::dynamicCall</a>() failed - the function prototype was correct, but the parameter at index <code translate="no">n</code> was of the wrong type and could not be coerced to the correct type.</p>
<a name="qaxscriptmanager-call-no-script-provides-this-function"></a>
<h4 id="qaxscriptmanager-call-no-script-provides-this-function">QAxScriptManager::call(): No script provides this function<a class="plink" href="#qaxscriptmanager-call-no-script-provides-this-function" title="Direct link to this headline"></a></h4>
<p>You try to call a function that is provided through an engine that doesn't provide introspection (ie. ActivePython or <a href="http://www.activestate.com/Products/activeperl/index.mhtml" translate="no">ActivePerl</a>). You need to call the function directly on the respective <a href="./qaxscript.htm" translate="no">QAxScript</a> object.</p>
</div>
<p><b>See also </b><a href="./activeqt-index.htm" translate="no">ActiveQt Framework</a>.</p>
<!-- @@@activeqt-container.html -->
</div>
<p class="copy-notice">
<acronym title="Copyright">Â©</acronym> 2025 The Qt Company Ltd.
   Documentation contributions included herein are the copyrights of
   their respective owners.     The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the Free Software Foundation.     Qt and respective logos are <a href="https://doc.qt.io/qt/trademarks.html">    trademarks</a> of The Qt Company Ltd. in Finland and/or other countries
   worldwide. All other trademarks are property of their respective owners. </p>

                    </div>
                </article>
                
            </div>
        </div>
    </div>
</div>
</body></html>