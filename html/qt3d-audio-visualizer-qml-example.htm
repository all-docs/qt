<html lang="en"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Qt 3D: Audio Visualizer Example | Qt 3D</title>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <!-- Google Tag Manager -->
    
  <!-- End Google Tag Manager -->
  
  
</head>
<body class="qt-design-system" style="background:var(--content-bg-color)" onload="prettyPrint()">

<div data-global-resource-path="qt-design-system/components/b-sidebar.html">
    <div class="b-sidebar b-sidebar--full-width">
        
        <div class="b-sidebar__content">
            <div class="b-sidebar__topbar" data-margin-bottom="sm">
                <div class="b-topbar">
                                        <div class="b-topbar__breadcrump" translate="no">
                        <ul class="c-breadcrump">
                            <li><a href="./index.htm" translate="no">Qt 5.15</a></li>
                            <li><a href="./qt3d-index.htm" translate="no">Qt 3D</a></li>
                            <li><a>Qt 3D: Audio Visualizer Example</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="b-sidebar__content__wrapper">
                <article class="b-sidebar__content__left">
                    <div class="context mainContent" style="margin: 0;padding: 0; background: 0;">
                    

<div class="context">
<h1 class="title">Qt 3D: Audio Visualizer Example</h1>
<span class="subtitle"></span>
<!-- $$$audio-visualizer-qml-brief -->
<p>Demonstrates combining Qt 3D rendering and Qt Quick 2 elements.</p>
<!-- @@@audio-visualizer-qml -->
<!-- $$$audio-visualizer-qml-description -->
<div class="descr"> <a name="details"></a>
<p class="centerAlign"><img alt="" src="./images/audio-visualizer-qml-example.png"></p><p><i>Audio</i> Visualizer demonstrates how to implement an application that combines the use of Qt 3D rendering with Qt Quick 2D elements. The example uses media player to play music and it visualizes the magnitude of the music as animated bars.</p>
<a name="running-the-example"></a>
<h4 id="running-the-example">Running the Example<a class="plink" href="#running-the-example" title="Direct link to this headline"></a></h4>
<p>To run the example from <a href="http://doc.qt.io/qtcreator/index.html" translate="no">Qt Creator</a>, open the <b>Welcome</b> mode and select the example from <b>Examples</b>. For more information, visit <a href="https://doc.qt.io/qtcreator/creator-build-example-application.html" translate="no">Building and Running an Example</a>.</p>
<a name="qt-quick-2d-implementation"></a>
<h4 id="qt-quick-2d-implementation">Qt Quick 2D Implementation<a class="plink" href="#qt-quick-2d-implementation" title="Direct link to this headline"></a></h4>
<p>The Qt Quick Implementation in <code translate="no">audio-visualizer-qml/main.qml</code> of the example uses <code translate="no">MediaPlayer</code> to play audio content.</p>
<div class="pre"><pre class="qml prettyprint" translate="no"><span class="type">MediaPlayer</span> {
    <span class="name">id</span>: <span class="name">mediaPlayer</span>
    <span class="name">autoPlay</span>: <span class="number">true</span>
    <span class="name">volume</span>: <span class="number">0.5</span>
    <span class="name">source</span>: <span class="string">"qrc:/music/tiltshifted_lost_neon_sun.mp3"</span></pre></div>
<p>The player is controlled with the <code translate="no">playButton</code> and c{stopButton}. Based on the clicked buttons the <code translate="no">state</code> of the <code translate="no">mainview</code> changes.</p>
<p>The 3D content is rendered using the <code translate="no">Scene3D</code> type. The state of the Audio Visualizer is maintained in the <code translate="no">mainview</code>. It's passed on to the <code translate="no">visualizer</code> as it's needed for the bar animations.</p>
<div class="pre"><pre class="qml prettyprint" translate="no"><span class="type"><a href="./qml-qtquick-scene3d-scene3d.htm" translate="no">Scene3D</a></span> {
    <span class="name">anchors</span>.fill: <span class="name">parent</span>

    <span class="type">Visualizer</span> {
        <span class="name">id</span>: <span class="name">visualizer</span>
        <span class="name">animationState</span>: <span class="name">mainview</span>.<span class="name">state</span>
        <span class="name">numberOfBars</span>: <span class="number">120</span>
        <span class="name">barRotationTimeMs</span>: <span class="number">8160</span> <span class="comment">// 68 ms per bar</span>
    }
}</pre></div>
<a name="qt-3d-implementation"></a>
<h4 id="qt-3d-implementation">Qt 3D Implementation<a class="plink" href="#qt-3d-implementation" title="Direct link to this headline"></a></h4>
<p>The 3D elements of the example are created in <code translate="no">audio-visualizer-qml/Visualizer.qml</code>. The camera is set to a fixed position to show the visualized bars from a correct angle.</p>
<div class="pre"><pre class="qml prettyprint" translate="no"><span class="type"><a href="./qml-qt3d-render-camera.htm" translate="no">Camera</a></span> {
    <span class="name">id</span>: <span class="name">camera</span>
    <span class="name">projectionType</span>: <span class="name">CameraLens</span>.<span class="name">PerspectiveProjection</span>
    <span class="name">fieldOfView</span>: <span class="number">45</span>
    <span class="name">aspectRatio</span>: <span class="number">1820</span> <span class="operator">/</span> <span class="number">1080</span>
    <span class="name">nearPlane</span>: <span class="number">0.1</span>
    <span class="name">farPlane</span>: <span class="number">1000.0</span>
    <span class="name">position</span>: <span class="name">Qt</span>.<span class="name">vector3d</span>(<span class="number">0.014</span>, <span class="number">0.956</span>, <span class="number">2.178</span>)
    <span class="name">upVector</span>: <span class="name">Qt</span>.<span class="name">vector3d</span>(<span class="number">0.0</span>, <span class="number">1.0</span>, <span class="number">0.0</span>)
    <span class="name">viewCenter</span>: <span class="name">Qt</span>.<span class="name">vector3d</span>(<span class="number">0.0</span>, <span class="number">0.7</span>, <span class="number">0.0</span>)
}</pre></div>
<p>A <code translate="no">NodeInstantiator</code> is used to create the bars that visualize the magnitude of the music.</p>
<div class="pre"><pre class="qml prettyprint" translate="no"><span class="comment">// Bars</span>
<span class="type"><a href="./qml-qt3d-extras-cuboidmesh.htm" translate="no">CuboidMesh</a></span> {
    <span class="name">id</span>: <span class="name">barMesh</span>
    <span class="name">xExtent</span>: <span class="number">0.1</span>
    <span class="name">yExtent</span>: <span class="number">0.1</span>
    <span class="name">zExtent</span>: <span class="number">0.1</span>
}

<span class="type"><a href="./qml-qt3d-core-nodeinstantiator.htm" translate="no">NodeInstantiator</a></span> {
    <span class="name">id</span>: <span class="name">collection</span>
    property <span class="type"><a href="./qml-int.htm" translate="no">int</a></span> <span class="name">maxCount</span>: <span class="name">parent</span>.<span class="name">numberOfBars</span>
    <span class="name">model</span>: <span class="name">maxCount</span>

    <span class="name">delegate</span>: <span class="name">BarEntity</span> {
        <span class="name">id</span>: <span class="name">cubicEntity</span>
        <span class="name">entityMesh</span>: <span class="name">barMesh</span>
        <span class="name">rotationTimeMs</span>: <span class="name">sceneRoot</span>.<span class="name">barRotationTimeMs</span>
        <span class="name">entityIndex</span>: <span class="name">index</span>
        <span class="name">entityCount</span>: <span class="name">sceneRoot</span>.<span class="name">numberOfBars</span>
        <span class="name">entityAnimationsState</span>: <span class="name">animationState</span>
        <span class="name">magnitude</span>: <span class="number">0</span>
    }
}</pre></div>
<p>The <code translate="no">visualizer</code> also contains an <code translate="no">Entity</code> to show the progress. This element has a curve shaped mesh and it's rotated on a level to show the progress based on the duration of the played track.</p>
<div class="pre"><pre class="qml prettyprint" translate="no"><span class="comment">// Progress</span>
<span class="type"><a href="./qml-qt3d-render-mesh.htm" translate="no">Mesh</a></span> {
    <span class="name">id</span>: <span class="name">progressMesh</span>
    <span class="name">source</span>: <span class="string">"qrc:/meshes/progressbar.obj"</span>
}

<span class="type"><a href="./qml-qt3d-core-transform.htm" translate="no">Transform</a></span> {
    <span class="name">id</span>: <span class="name">progressTransform</span>
    property <span class="type"><a href="./qml-real.htm" translate="no">real</a></span> <span class="name">defaultStartAngle</span>: -<span class="number">90</span>
    property <span class="type"><a href="./qml-real.htm" translate="no">real</a></span> <span class="name">progressAngle</span>: <span class="name">defaultStartAngle</span>
    <span class="name">rotationY</span>: <span class="name">progressAngle</span>
}

<span class="type"><a href="./qml-qt3d-core-entity.htm" translate="no">Entity</a></span> {
    property <span class="type"><a href="./qml-qt3d-render-material.htm" translate="no">Material</a></span> <span class="name">progressMaterial</span>: <span class="name">PhongMaterial</span> {
        <span class="name">ambient</span>: <span class="string">"#80C342"</span>
        <span class="name">diffuse</span>: <span class="string">"black"</span>
    }

    <span class="name">components</span>: [<span class="name">progressMesh</span>, <span class="name">progressMaterial</span>, <span class="name">progressTransform</span>]
}</pre></div>
<p>In <code translate="no">audio-visualizer-qml/BarEntity.qml</code> there are animations for rotating the bars and changing the bar color. The bars are rotated on a level following a ring form. At the same time the color of the bars is animated.</p>
<div class="pre"><pre class="qml prettyprint" translate="no"><span class="type">QQ2</span>.NumberAnimation {
    <span class="name">id</span>: <span class="name">angleAnimation</span>
    <span class="name">target</span>: <span class="name">angleTransform</span>
    <span class="name">property</span>: <span class="string">"barAngle"</span>
    <span class="name">duration</span>: <span class="name">rotationTimeMs</span>
    <span class="name">loops</span>: <span class="name">QQ2</span>.<span class="name">Animation</span>.<span class="name">Infinite</span>
    <span class="name">running</span>: <span class="number">true</span>
    <span class="name">from</span>: <span class="name">startAngle</span>
    <span class="name">to</span>: <span class="number">360</span> <span class="operator">+</span> <span class="name">startAngle</span>
}
QQ2.SequentialAnimation on <span class="name">barColor</span> {
    <span class="name">id</span>: <span class="name">barColorAnimations</span>
    <span class="name">running</span>: <span class="number">false</span>

    <span class="type">QQ2</span>.ColorAnimation {
        <span class="name">from</span>: <span class="name">lowColor</span>
        <span class="name">to</span>: <span class="name">highColor</span>
        <span class="name">duration</span>: <span class="name">animationDuration</span>
    }

    <span class="type">QQ2</span>.PauseAnimation {
        <span class="name">duration</span>: <span class="name">animationDuration</span>
    }

    <span class="type">QQ2</span>.ColorAnimation {
        <span class="name">from</span>: <span class="name">highColor</span>
        <span class="name">to</span>: <span class="name">lowColor</span>
        <span class="name">duration</span>: <span class="name">animationDuration</span>
    }
}</pre></div>
<p>The magnitude of each bar is read from a separate .raw file that is based on the track being played. As the bars rotate around the ring the height is scaled to highlight currently played position. After a full round of rotation, a new value is fetched for the bar.</p>
<p><a href="https://code.qt.io/cgit/qt/qt3d.git/tree/examples/qt3d/audio-visualizer-qml?h=5.15" translate="no">Example project @ code.qt.io</a></p>
</div>
<!-- @@@audio-visualizer-qml -->
</div>
<p class="copy-notice">
<acronym title="Copyright">Â©</acronym> 2025 The Qt Company Ltd.
   Documentation contributions included herein are the copyrights of
   their respective owners.     The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the Free Software Foundation.     Qt and respective logos are <a href="https://doc.qt.io/qt/trademarks.html">    trademarks</a> of The Qt Company Ltd. in Finland and/or other countries
   worldwide. All other trademarks are property of their respective owners. </p>

                    </div>
                </article>
                
            </div>
        </div>
    </div>
</div>
</body></html>