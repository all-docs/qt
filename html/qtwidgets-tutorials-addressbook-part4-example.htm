<html lang="en"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Part 4 - Editing and Removing Addresses | Qt Widgets</title>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <!-- Google Tag Manager -->
    
  <!-- End Google Tag Manager -->
  
  
</head>
<body class="qt-design-system" style="background:var(--content-bg-color)" onload="prettyPrint()">

<div data-global-resource-path="qt-design-system/components/b-sidebar.html">
    <div class="b-sidebar b-sidebar--full-width">
        
        <div class="b-sidebar__content">
            <div class="b-sidebar__topbar" data-margin-bottom="sm">
                <div class="b-topbar">
                                        <div class="b-topbar__breadcrump" translate="no">
                        <ul class="c-breadcrump">
                            <li><a href="./index.htm" translate="no">Qt 5.15</a></li>
                            <li><a href="./qtwidgets-index.htm" translate="no">Qt Widgets</a></li>
                            <li><a>Part 4 - Editing and Removing Addresses</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="b-sidebar__content__wrapper">
                <article class="b-sidebar__content__left">
                    <div class="context mainContent" style="margin: 0;padding: 0; background: 0;">
                    

<div class="context">
<h1 class="title">Part 4 - Editing and Removing Addresses</h1>
<span class="subtitle"></span>
<!-- $$$tutorials/addressbook/part4-brief -->
<p>Explains how to add edit and remove functionality.</p>
<!-- @@@tutorials/addressbook/part4 -->
<!-- $$$tutorials/addressbook/part4-description -->
<div class="descr"> <a name="details"></a>
<p>Now we look at ways to modify the contents of contacts stored in the address book.</p>
<p class="centerAlign"><img alt="" src="./images/addressbook-tutorial-screenshot.png"></p><p>We now have an address book that not only holds contacts in an organized manner, but also allows navigation. It would be convenient to include edit and remove functions so that a contact's details can be changed when needed. However, this requires a little improvement, in the form of enums. We defined two modes: <code translate="no">AddingMode</code> and <code translate="no">NavigationMode</code>, but they were not defined as enum values. Instead, we enabled and disabled the corresponding buttons manually, resulting in multiple lines of repeated code.</p>
<p>Here we define the <code translate="no">Mode</code> enum with three different values:</p>
<ul>
<li><code translate="no">NavigationMode</code>,</li>
<li><code translate="no">AddingMode</code>, and</li>
<li><code translate="no">EditingMode</code>.</li>
</ul>
<a name="defining-the-addressbook-class"></a>
<h4 id="defining-the-addressbook-class">Defining the AddressBook Class<a class="plink" href="#defining-the-addressbook-class" title="Direct link to this headline"></a></h4>
<p>The <code translate="no">addressbook.h</code> file is updated to contain the <code translate="no">Mode</code> enum:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">    <span class="keyword">enum</span> Mode { NavigationMode<span class="operator">,</span> AddingMode<span class="operator">,</span> EditingMode };</pre></div>
<p>We also add two new slots, <code translate="no">editContact()</code> and <code translate="no">removeContact()</code>, to our current list of public slots.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">    <span class="type">void</span> editContact();
    <span class="type">void</span> removeContact();</pre></div>
<p>In order to switch between modes, we introduce the <code translate="no">updateInterface()</code> function to control the enabling and disabling of all <a href="./qpushbutton.htm" translate="no">QPushButton</a> objects. We also add two new push buttons, <code translate="no">editButton</code> and <code translate="no">removeButton</code>, for the edit and remove functions mentioned earlier.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">    <span class="type">void</span> updateInterface(Mode mode);
    ...
    <span class="type"><a href="./qpushbutton.htm" translate="no">QPushButton</a></span> <span class="operator">*</span>editButton;
    <span class="type"><a href="./qpushbutton.htm" translate="no">QPushButton</a></span> <span class="operator">*</span>removeButton;
    ...
    Mode currentMode;</pre></div>
<p>Lastly, we declare <code translate="no">currentMode</code> to keep track of the enum's current mode.</p>
<a name="implementing-the-addressbook-class"></a>
<h4 id="implementing-the-addressbook-class">Implementing the AddressBook Class<a class="plink" href="#implementing-the-addressbook-class" title="Direct link to this headline"></a></h4>
<p>We now implement the mode-changing features of the address book. The <code translate="no">editButton</code> and <code translate="no">removeButton</code> are instantiated and disabled by default. The address book starts with zero contacts in memory.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">    editButton <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qpushbutton.htm" translate="no">QPushButton</a></span>(tr(<span class="string">"&amp;Edit"</span>));
    editButton<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(<span class="keyword">false</span>);
    removeButton <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qpushbutton.htm" translate="no">QPushButton</a></span>(tr(<span class="string">"&amp;Remove"</span>));
    removeButton<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(<span class="keyword">false</span>);</pre></div>
<p>These buttons are then connected to their respective slots, <code translate="no">editContact()</code> and <code translate="no">removeContact()</code>, and we add them to <code translate="no">buttonLayout1</code>.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">    connect(editButton<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qpushbutton.htm" translate="no">QPushButton</a></span><span class="operator">::</span>clicked<span class="operator">,</span>
            <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>AddressBook<span class="operator">::</span>editContact);
    connect(removeButton<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qpushbutton.htm" translate="no">QPushButton</a></span><span class="operator">::</span>clicked<span class="operator">,</span>
            <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>AddressBook<span class="operator">::</span>removeContact);
    ...
    buttonLayout1<span class="operator">-</span><span class="operator">&gt;</span>addWidget(editButton);
    buttonLayout1<span class="operator">-</span><span class="operator">&gt;</span>addWidget(removeButton);</pre></div>
<p>The <code translate="no">editContact()</code> function stores the contact's old details in <code translate="no">oldName</code> and <code translate="no">oldAddress</code>, before switching the mode to <code translate="no">EditingMode</code>. In this mode, the <code translate="no">submitButton</code> and <code translate="no">cancelButton</code> are both enabled, hence, the user can change the contact's details and click either button.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> AddressBook<span class="operator">::</span>editContact()
{
    oldName <span class="operator">=</span> nameLine<span class="operator">-</span><span class="operator">&gt;</span>text();
    oldAddress <span class="operator">=</span> addressText<span class="operator">-</span><span class="operator">&gt;</span>toPlainText();

    updateInterface(EditingMode);
}</pre></div>
<p>The <code translate="no">submitContact()</code> function has been divided in two with an <code translate="no">if-else</code> statement. We check <code translate="no">currentMode</code> to see if it's in <code translate="no">AddingMode</code>. If it is, we proceed with our adding process.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> AddressBook<span class="operator">::</span>submitContact()
{
    ...
    <span class="keyword">if</span> (currentMode <span class="operator">=</span><span class="operator">=</span> AddingMode) {

        <span class="keyword">if</span> (<span class="operator">!</span>contacts<span class="operator">.</span>contains(name)) {
            contacts<span class="operator">.</span>insert(name<span class="operator">,</span> address);
            <span class="type"><a href="./qmessagebox.htm" translate="no">QMessageBox</a></span><span class="operator">::</span>information(<span class="keyword">this</span><span class="operator">,</span> tr(<span class="string">"Add Successful"</span>)<span class="operator">,</span>
                tr(<span class="string">"\"%1\" has been added to your address book."</span>)<span class="operator">.</span>arg(name));
        } <span class="keyword">else</span> {
            <span class="type"><a href="./qmessagebox.htm" translate="no">QMessageBox</a></span><span class="operator">::</span>information(<span class="keyword">this</span><span class="operator">,</span> tr(<span class="string">"Add Unsuccessful"</span>)<span class="operator">,</span>
                tr(<span class="string">"Sorry, \"%1\" is already in your address book."</span>)<span class="operator">.</span>arg(name));
        }</pre></div>
<p>Otherwise, we check to see if <code translate="no">currentMode</code> is in <code translate="no">EditingMode</code>. If it is, we compare <code translate="no">oldName</code> with <code translate="no">name</code>. If the name has changed, we remove the old contact from <code translate="no">contacts</code> and insert the newly updated contact.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">    } <span class="keyword">else</span> <span class="keyword">if</span> (currentMode <span class="operator">=</span><span class="operator">=</span> EditingMode) {

        <span class="keyword">if</span> (oldName <span class="operator">!</span><span class="operator">=</span> name) {
            <span class="keyword">if</span> (<span class="operator">!</span>contacts<span class="operator">.</span>contains(name)) {
                <span class="type"><a href="./qmessagebox.htm" translate="no">QMessageBox</a></span><span class="operator">::</span>information(<span class="keyword">this</span><span class="operator">,</span> tr(<span class="string">"Edit Successful"</span>)<span class="operator">,</span>
                    tr(<span class="string">"\"%1\" has been edited in your address book."</span>)<span class="operator">.</span>arg(oldName));
                contacts<span class="operator">.</span>remove(oldName);
                contacts<span class="operator">.</span>insert(name<span class="operator">,</span> address);
            } <span class="keyword">else</span> {
                <span class="type"><a href="./qmessagebox.htm" translate="no">QMessageBox</a></span><span class="operator">::</span>information(<span class="keyword">this</span><span class="operator">,</span> tr(<span class="string">"Edit Unsuccessful"</span>)<span class="operator">,</span>
                    tr(<span class="string">"Sorry, \"%1\" is already in your address book."</span>)<span class="operator">.</span>arg(name));
            }
        } <span class="keyword">else</span> <span class="keyword">if</span> (oldAddress <span class="operator">!</span><span class="operator">=</span> address) {
            <span class="type"><a href="./qmessagebox.htm" translate="no">QMessageBox</a></span><span class="operator">::</span>information(<span class="keyword">this</span><span class="operator">,</span> tr(<span class="string">"Edit Successful"</span>)<span class="operator">,</span>
                tr(<span class="string">"\"%1\" has been edited in your address book."</span>)<span class="operator">.</span>arg(name));
            contacts<span class="operator">[</span>name<span class="operator">]</span> <span class="operator">=</span> address;
        }
    }

    updateInterface(NavigationMode);
}</pre></div>
<p>If only the address has changed (i.e., <code translate="no">oldAddress</code> is not the same as <code translate="no">address</code>), we update the contact's address. Lastly, we set <code translate="no">currentMode</code> to <code translate="no">NavigationMode</code>. This is an important step as it re-enables all the disabled push buttons.</p>
<p>To remove a contact from the address book, we implement the <code translate="no">removeContact()</code> function. This function checks to see if the contact exists in <code translate="no">contacts</code>.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> AddressBook<span class="operator">::</span>removeContact()
{
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> name <span class="operator">=</span> nameLine<span class="operator">-</span><span class="operator">&gt;</span>text();
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> address <span class="operator">=</span> addressText<span class="operator">-</span><span class="operator">&gt;</span>toPlainText();

    <span class="keyword">if</span> (contacts<span class="operator">.</span>contains(name)) {

        <span class="type">int</span> button <span class="operator">=</span> <span class="type"><a href="./qmessagebox.htm" translate="no">QMessageBox</a></span><span class="operator">::</span>question(<span class="keyword">this</span><span class="operator">,</span>
            tr(<span class="string">"Confirm Remove"</span>)<span class="operator">,</span>
            tr(<span class="string">"Are you sure you want to remove \"%1\"?"</span>)<span class="operator">.</span>arg(name)<span class="operator">,</span>
            <span class="type"><a href="./qmessagebox.htm" translate="no">QMessageBox</a></span><span class="operator">::</span>Yes <span class="operator">|</span> <span class="type"><a href="./qmessagebox.htm" translate="no">QMessageBox</a></span><span class="operator">::</span>No);

        <span class="keyword">if</span> (button <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="./qmessagebox.htm" translate="no">QMessageBox</a></span><span class="operator">::</span>Yes) {

            previous();
            contacts<span class="operator">.</span>remove(name);

            <span class="type"><a href="./qmessagebox.htm" translate="no">QMessageBox</a></span><span class="operator">::</span>information(<span class="keyword">this</span><span class="operator">,</span> tr(<span class="string">"Remove Successful"</span>)<span class="operator">,</span>
                tr(<span class="string">"\"%1\" has been removed from your address book."</span>)<span class="operator">.</span>arg(name));
        }
    }

    updateInterface(NavigationMode);
}</pre></div>
<p>If it does, we display a <a href="./qmessagebox.htm" translate="no">QMessageBox</a>, to confirm the removal with the user. Once the user has confirmed, we call <code translate="no">previous()</code> to ensure that the user interface shows another contact, and we remove the contact using <a href="./qmap.htm" translate="no">QMap</a>'s <a href="./qmap.htm#remove" translate="no">remove()</a> function. As a courtesy, we display a <a href="./qmessagebox.htm" translate="no">QMessageBox</a> to inform the user. Both the message boxes used in this function are shown below:</p>
<p class="centerAlign"><img alt="" src="./images/addressbook-tutorial-part4-remove.png"></p><a name="updating-the-user-interface"></a>
<h5 id="updating-the-user-interface">Updating the User Interface<a class="plink" href="#updating-the-user-interface" title="Direct link to this headline"></a></h5>
<p>We mentioned the <code translate="no">updateInterface()</code> function earlier as a means to enable and disable the push buttons depending on the current mode. The function updates the current mode according to the <code translate="no">mode</code> argument passed to it, assigning it to <code translate="no">currentMode</code> before checking its value.</p>
<p>Each of the push buttons is then enabled or disabled, depending on the current mode. The code for <code translate="no">AddingMode</code> and <code translate="no">EditingMode</code> is shown below:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> AddressBook<span class="operator">::</span>updateInterface(Mode mode)
{
    currentMode <span class="operator">=</span> mode;

    <span class="keyword">switch</span> (currentMode) {

    <span class="keyword">case</span> AddingMode:
    <span class="keyword">case</span> EditingMode:

        nameLine<span class="operator">-</span><span class="operator">&gt;</span>setReadOnly(<span class="keyword">false</span>);
        nameLine<span class="operator">-</span><span class="operator">&gt;</span>setFocus(<span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>OtherFocusReason);
        addressText<span class="operator">-</span><span class="operator">&gt;</span>setReadOnly(<span class="keyword">false</span>);

        addButton<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(<span class="keyword">false</span>);
        editButton<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(<span class="keyword">false</span>);
        removeButton<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(<span class="keyword">false</span>);

        nextButton<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(<span class="keyword">false</span>);
        previousButton<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(<span class="keyword">false</span>);

        submitButton<span class="operator">-</span><span class="operator">&gt;</span>show();
        cancelButton<span class="operator">-</span><span class="operator">&gt;</span>show();
        <span class="keyword">break</span>;</pre></div>
<p>For <code translate="no">NavigationMode</code>, however, we include conditions within the parameters of the <a href="./qwidget.htm#enabled-prop" translate="no">QPushButton::setEnabled</a>() function. This is to ensure that <code translate="no">editButton</code> and <code translate="no">removeButton</code> are enabled when there is at least one contact in the address book; <code translate="no">nextButton</code> and <code translate="no">previousButton</code> are only enabled when there is more than one contact in the address book.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">    <span class="keyword">case</span> NavigationMode:

        <span class="keyword">if</span> (contacts<span class="operator">.</span>isEmpty()) {
            nameLine<span class="operator">-</span><span class="operator">&gt;</span>clear();
            addressText<span class="operator">-</span><span class="operator">&gt;</span>clear();
        }

        nameLine<span class="operator">-</span><span class="operator">&gt;</span>setReadOnly(<span class="keyword">true</span>);
        addressText<span class="operator">-</span><span class="operator">&gt;</span>setReadOnly(<span class="keyword">true</span>);
        addButton<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(<span class="keyword">true</span>);

        <span class="type">int</span> number <span class="operator">=</span> contacts<span class="operator">.</span>size();
        editButton<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(number <span class="operator">&gt;</span><span class="operator">=</span> <span class="number">1</span>);
        removeButton<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(number <span class="operator">&gt;</span><span class="operator">=</span> <span class="number">1</span>);
        nextButton<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(number <span class="operator">&gt;</span> <span class="number">1</span>);
        previousButton<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(number <span class="operator">&gt;</span><span class="number">1</span> );

        submitButton<span class="operator">-</span><span class="operator">&gt;</span>hide();
        cancelButton<span class="operator">-</span><span class="operator">&gt;</span>hide();
        <span class="keyword">break</span>;
    }
}</pre></div>
<p>By setting the mode and updating the user interface in the same function, we avoid the possibility of the user interface getting out of sync with the internal state of the application.</p>
<p><a href="https://code.qt.io/cgit/qt/qtbase.git/tree/examples/widgets/tutorials/addressbook/part4?h=5.15" translate="no">Example project @ code.qt.io</a></p>
</div>
<!-- @@@tutorials/addressbook/part4 -->
</div>
<p class="copy-notice">
<acronym title="Copyright">Â©</acronym> 2025 The Qt Company Ltd.
   Documentation contributions included herein are the copyrights of
   their respective owners.     The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the Free Software Foundation.     Qt and respective logos are <a href="https://doc.qt.io/qt/trademarks.html">    trademarks</a> of The Qt Company Ltd. in Finland and/or other countries
   worldwide. All other trademarks are property of their respective owners. </p>

                    </div>
                </article>
                
            </div>
        </div>
    </div>
</div>
</body></html>