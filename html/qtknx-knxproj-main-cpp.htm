<html lang="en"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>KNX Project Parser | Qt KNX</title>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <!-- Google Tag Manager -->
    
  <!-- End Google Tag Manager -->
  
  
</head>
<body class="qt-design-system" style="background:var(--content-bg-color)" onload="prettyPrint()">

<div data-global-resource-path="qt-design-system/components/b-sidebar.html">
    <div class="b-sidebar b-sidebar--full-width">
        
        <div class="b-sidebar__content">
            <div class="b-sidebar__topbar" data-margin-bottom="sm">
                <div class="b-topbar">
                                        <div class="b-topbar__breadcrump" translate="no">
                        <ul class="c-breadcrump">
                            <li><a href="http://doc.qt.io/QtForAutomation/index.html" translate="no">Qt 5.15</a></li>
                            <li><a href="./qtknx-index.htm" translate="no">Qt KNX</a></li>
                            <li><a href="./qtknx-examples.htm" translate="no">Qt KNX Examples</a></li>
                            <li><a>KNX Project Parser</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="b-sidebar__content__wrapper">
                <article class="b-sidebar__content__left nosidebar">
                    <div class="context mainContent" style="margin: 0;padding: 0; background: 0;">
                    
<div class="context">
<h1 class="title">KNX Project Parser</h1>
<span class="subtitle"></span>
<div class="pre"><pre class="cpp prettyprint" translate="no"><input id="ec_toggle" type="checkbox"><label for="ec_toggle"></label><div id="ec_expand"><span class="comment">/******************************************************************************
**
** Copyright (C) 2017 The Qt Company Ltd.
** Contact: https://www.qt.io/licensing/
**
** This file is part of the QtKnx module.
**
** $QT_BEGIN_LICENSE:GPL$
** Commercial License Usage
** Licensees holding valid commercial Qt licenses may use this file in
** accordance with the commercial license agreement provided with the
** Software or, alternatively, in accordance with the terms contained in
** a written agreement between you and The Qt Company. For licensing terms
** and conditions see https://www.qt.io/terms-conditions. For further
** information use the contact form at https://www.qt.io/contact-us.
**
** GNU General Public License Usage
** Alternatively, this file may be used under the terms of the GNU
** General Public License version 3 or (at your option) any later version
** approved by the KDE Free Qt Foundation. The licenses are as published by
** the Free Software Foundation and appearing in the file LICENSE.GPL3
** included in the packaging of this file. Please review the following
** information to ensure the GNU General Public License requirements will
** be met: https://www.gnu.org/licenses/gpl-3.0.html.
**
** $QT_END_LICENSE$
**
******************************************************************************/</span></div>

<span class="preprocessor">#include &lt;QtCore/QCommandLineParser&gt;</span>
<span class="preprocessor">#include &lt;QtCore/qdebug.h&gt;</span>
<span class="preprocessor">#include &lt;QtCore/qvector.h&gt;</span>
<span class="preprocessor">#include &lt;QtCore/qversionnumber.h&gt;</span>
<span class="preprocessor">#include &lt;QtCore/qxmlstream.h&gt;</span>
<span class="preprocessor">#include &lt;QtKnx/qknxgroupaddressinfos.h&gt;</span>

<span class="type">int</span> main(<span class="type">int</span> argc<span class="operator">,</span> <span class="type">char</span> <span class="operator">*</span>argv<span class="operator">[</span><span class="operator">]</span>)
{
    <span class="type"><a href="./qcoreapplication.htm" translate="no">QCoreApplication</a></span> app(argc<span class="operator">,</span> argv);
    <span class="type"><a href="./qcoreapplication.htm" translate="no">QCoreApplication</a></span><span class="operator">::</span>setApplicationName(<span class="string">"knxproj"</span>);

    <span class="type"><a href="./qcommandlineparser.htm" translate="no">QCommandLineParser</a></span> cliParser;
    cliParser<span class="operator">.</span>setApplicationDescription(<span class="string">"KNX Project file parser"</span>);
    cliParser<span class="operator">.</span>addHelpOption();
    <span class="type"><a href="./qcommandlineoption.htm" translate="no">QCommandLineOption</a></span> verboseOption({<span class="string">"v"</span><span class="operator">,</span><span class="string">"verbose"</span>}<span class="operator">,</span>
                                     <span class="type"><a href="./qcoreapplication.htm" translate="no">QCoreApplication</a></span><span class="operator">::</span>translate(
                                         <span class="string">"main"</span><span class="operator">,</span> <span class="string">"Show more details of the project file."</span>));
    cliParser<span class="operator">.</span>addOption(verboseOption);
    <span class="type"><a href="./qcommandlineoption.htm" translate="no">QCommandLineOption</a></span> projFilePathOption(<span class="type"><a href="./qstringlist.htm" translate="no">QStringList</a></span>() <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="string">"p"</span> <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="string">"project"</span><span class="operator">,</span>
              <span class="type"><a href="./qcoreapplication.htm" translate="no">QCoreApplication</a></span><span class="operator">::</span>translate(<span class="string">"main"</span><span class="operator">,</span> <span class="string">"Path to the project file to parse."</span>)<span class="operator">,</span>
              <span class="type"><a href="./qcoreapplication.htm" translate="no">QCoreApplication</a></span><span class="operator">::</span>translate(<span class="string">"main"</span><span class="operator">,</span> <span class="string">"path"</span>));
    cliParser<span class="operator">.</span>addOption(projFilePathOption);
    cliParser<span class="operator">.</span>process(app);

    bool verbose <span class="operator">=</span> cliParser<span class="operator">.</span>isSet(verboseOption);

    <span class="keyword">if</span> (<span class="operator">!</span>cliParser<span class="operator">.</span>isSet(projFilePathOption)) {
        <a href="./qtglobal.htm#qInfo" translate="no">qInfo</a>() <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="string">"Error: Missing project file name"</span> <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>endl;
        cliParser<span class="operator">.</span>showHelp(EXIT_FAILURE);
    }

    <span class="type"><a href="./qknxgroupaddressinfos.htm" translate="no">QKnxGroupAddressInfos</a></span> infos(cliParser<span class="operator">.</span>value(projFilePathOption));
    infos<span class="operator">.</span>parse();

    <a href="./qtglobal.htm#qInfo" translate="no">qInfo</a>()<span class="operator">.</span>noquote() <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span><span class="operator">::</span>fromLatin1(<span class="string">"Opening project file: %1"</span>)
                         <span class="operator">.</span>arg(infos<span class="operator">.</span>projectFile());
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> status <span class="operator">=</span> infos<span class="operator">.</span>errorString()<span class="operator">.</span>isEmpty() <span class="operator">?</span> <span class="string">"No errors"</span> : infos<span class="operator">.</span>errorString();
    <a href="./qtglobal.htm#qInfo" translate="no">qInfo</a>()<span class="operator">.</span>noquote() <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span><span class="operator">::</span>fromLatin1(<span class="string">"Status parsing project: %1"</span>)
                         <span class="operator">.</span>arg(status);
    <a href="./qtglobal.htm#qInfo" translate="no">qInfo</a>()<span class="operator">.</span>noquote() <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span><span class="operator">::</span>fromLatin1(<span class="string">"Project ids found: %1"</span>)
                         <span class="operator">.</span>arg(infos<span class="operator">.</span>projectIds()<span class="operator">.</span>size());

    <span class="keyword">if</span> (infos<span class="operator">.</span>status() <span class="operator">!</span><span class="operator">=</span> <span class="type"><a href="./qknxgroupaddressinfos.htm" translate="no">QKnxGroupAddressInfos</a></span><span class="operator">::</span>Status<span class="operator">::</span>NoError) {
        <a href="./qtglobal.htm#qInfo" translate="no">qInfo</a>() <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="string">"ERROR:"</span> <span class="operator">&lt;</span><span class="operator">&lt;</span>  infos;
        <span class="keyword">return</span> EXIT_FAILURE;
    }

    <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> <span class="operator">&amp;</span>projId: infos<span class="operator">.</span>projectIds()) {
        <span class="keyword">auto</span> installations <span class="operator">=</span> infos<span class="operator">.</span>installations(projId);
        <a href="./qtglobal.htm#qInfo" translate="no">qInfo</a>()<span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="string">" # project"</span><span class="operator">&lt;</span><span class="operator">&lt;</span>infos<span class="operator">.</span>projectName(projId);
        <a href="./qtglobal.htm#qInfo" translate="no">qInfo</a>()<span class="operator">.</span>noquote() <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span><span class="operator">::</span>fromLatin1(<span class="string">"     found %1 installation(s)"</span>)
                             <span class="operator">.</span>arg(installations<span class="operator">.</span>size());
        <span class="keyword">for</span> (<span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> <span class="operator">&amp;</span>installation: installations) {
            <span class="keyword">auto</span> groupAddresses <span class="operator">=</span> infos<span class="operator">.</span>addressInfos(projId<span class="operator">,</span> installation);
            <a href="./qtglobal.htm#qInfo" translate="no">qInfo</a>()<span class="operator">.</span>noquote() <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span><span class="operator">::</span>fromLatin1(<span class="string">"  - Installation \"%1\""</span>)
                                 <span class="operator">.</span>arg(installation);
            <a href="./qtglobal.htm#qInfo" translate="no">qInfo</a>()<span class="operator">.</span>noquote() <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span><span class="operator">::</span>fromLatin1(<span class="string">"     found %1 Group address(es)"</span>)
                       <span class="operator">.</span>arg(groupAddresses<span class="operator">.</span>size());
            <span class="keyword">for</span> (<span class="keyword">const</span> <span class="type"><a href="./qknxgroupaddressinfo.htm" translate="no">QKnxGroupAddressInfo</a></span> <span class="operator">&amp;</span>addInfo: groupAddresses) {
                <span class="keyword">if</span> (<span class="operator">!</span>addInfo<span class="operator">.</span>isValid())
                    <span class="keyword">return</span> EXIT_FAILURE;
                <span class="keyword">if</span> (verbose)
                    <a href="./qtglobal.htm#qInfo" translate="no">qInfo</a>()<span class="operator">.</span>noquote() <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span><span class="operator">::</span>fromLatin1(<span class="string">"      %1: %2"</span>)
                                         <span class="operator">.</span>arg(addInfo<span class="operator">.</span>name())<span class="operator">.</span>arg(addInfo<span class="operator">.</span>address()<span class="operator">.</span>toString());
            }
            <a href="./qtglobal.htm#qInfo" translate="no">qInfo</a>() <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>endl;
        }
    }

    <span class="keyword">return</span> EXIT_SUCCESS;
};</pre></div>
</div>
                    </div>
                </article>
                
            </div>
        </div>
    </div>
</div>
</body></html>