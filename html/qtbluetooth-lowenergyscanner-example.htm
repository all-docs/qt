<html lang="en"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Bluetooth Low Energy Scanner Example | Qt Bluetooth</title>
<link rel="canonical" href="https://doc.qt.io/qt-6/qtbluetooth-lowenergyscanner-example.html">
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <!-- Google Tag Manager -->
    
  <!-- End Google Tag Manager -->
  
  
</head>
<body class="qt-design-system" style="background:var(--content-bg-color)" onload="prettyPrint()">

<div data-global-resource-path="qt-design-system/components/b-sidebar.html">
    <div class="b-sidebar b-sidebar--full-width">
        
        <div class="b-sidebar__content">
            <div class="b-sidebar__topbar" data-margin-bottom="sm">
                <div class="b-topbar">
                                        <div class="b-topbar__breadcrump" translate="no">
                        <ul class="c-breadcrump">
                            <li><a href="./index.htm" translate="no">Qt 5.15</a></li>
                            <li><a href="./qtbluetooth-index.htm" translate="no">Qt Bluetooth</a></li>
                            <li><a>Bluetooth Low Energy Scanner Example</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="b-sidebar__content__wrapper">
                <article class="b-sidebar__content__left">
                    <div class="context mainContent" style="margin: 0;padding: 0; background: 0;">
                    

<div class="context">
<h1 class="title">Bluetooth Low Energy Scanner Example</h1>
<span class="subtitle"></span>
<!-- $$$lowenergyscanner-brief -->
<p>An application designed to browse the content of Bluetooth Low Energy peripheral devices. The example demonstrates the use of all Qt Bluetooth Low Energy classes.</p>
<!-- @@@lowenergyscanner -->
<!-- $$$lowenergyscanner-description -->
<div class="descr"> <a name="details"></a>
<p>The Bluetooth Low Energy Scanner Example shows how to develop Bluetooth Low Energy applications using the Qt Bluetooth API. The application covers scanning for Low Energy devices, scanning their services and reading the service characteristics and descriptors.</p>
<p class="centerAlign"><img alt="" src="./images/lowenergyscanner-services.png"></p><p>The example introduces the following Qt classes:</p>
<ul>
<li><a href="./qlowenergycontroller.htm" translate="no">QLowEnergyController</a></li>
<li><a href="./qlowenergyservice.htm" translate="no">QLowEnergyService</a></li>
<li><a href="./qlowenergycharacteristic.htm" translate="no">QLowEnergyCharacteristic</a></li>
<li><a href="./qlowenergydescriptor.htm" translate="no">QLowEnergyDescriptor</a></li>
</ul>
<p>The example can be used with any arbitrary Bluetooth Low Energy peripheral device. It creates a snapshot of all services, characteristics and descriptors and presents them to the user. Therefore the application provides an easy way of browsing the content offered by a peripheral device.</p>
<a name="running-the-example"></a>
<h4 id="running-the-example">Running the Example<a class="plink" href="#running-the-example" title="Direct link to this headline"></a></h4>
<p>To run the example from <a href="https://doc.qt.io/qtcreator/index.html" translate="no">Qt Creator</a>, open the <b>Welcome</b> mode and select the example from <b>Examples</b>. For more information, visit <a href="https://doc.qt.io/qtcreator/creator-build-example-application.html" translate="no">Building and Running an Example</a>.</p>
<a name="scanning-for-devices"></a>
<h4 id="scanning-for-devices">Scanning for Devices<a class="plink" href="#scanning-for-devices" title="Direct link to this headline"></a></h4>
<p>The first step is to find all peripheral devices. The devices can be found using the <a href="./qbluetoothdevicediscoveryagent.htm" translate="no">QBluetoothDeviceDiscoveryAgent</a> class. The discovery process is started using <a href="./qbluetoothdevicediscoveryagent.htm#start" translate="no">start()</a>. Each new device is advertised via the <a href="./qbluetoothdevicediscoveryagent.htm#deviceDiscovered" translate="no">deviceDiscovered()</a> signal:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">discoveryAgent <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qbluetoothdevicediscoveryagent.htm" translate="no">QBluetoothDeviceDiscoveryAgent</a></span>();
discoveryAgent<span class="operator">-</span><span class="operator">&gt;</span>setLowEnergyDiscoveryTimeout(<span class="number">5000</span>);
connect(discoveryAgent<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qbluetoothdevicediscoveryagent.htm" translate="no">QBluetoothDeviceDiscoveryAgent</a></span><span class="operator">::</span>deviceDiscovered<span class="operator">,</span>
        <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>Device<span class="operator">::</span>addDevice);
connect(discoveryAgent<span class="operator">,</span> <span class="type">QOverload</span><span class="operator">&lt;</span><span class="type"><a href="./qbluetoothdevicediscoveryagent.htm" translate="no">QBluetoothDeviceDiscoveryAgent</a></span><span class="operator">::</span>Error<span class="operator">&gt;</span><span class="operator">::</span>of(<span class="operator">&amp;</span><span class="type"><a href="./qbluetoothdevicediscoveryagent.htm" translate="no">QBluetoothDeviceDiscoveryAgent</a></span><span class="operator">::</span>error)<span class="operator">,</span>
        <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>Device<span class="operator">::</span>deviceScanError);
connect(discoveryAgent<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qbluetoothdevicediscoveryagent.htm" translate="no">QBluetoothDeviceDiscoveryAgent</a></span><span class="operator">::</span>finished<span class="operator">,</span> <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>Device<span class="operator">::</span>deviceScanFinished);
discoveryAgent<span class="operator">-</span><span class="operator">&gt;</span>start(<span class="type"><a href="./qbluetoothdevicediscoveryagent.htm" translate="no">QBluetoothDeviceDiscoveryAgent</a></span><span class="operator">::</span>LowEnergyMethod);</pre></div>
<p>The below <code translate="no">addDevice()</code> slot is triggered as a reaction to the discovery of a new device. It filters all found devices which have the <a href="./qbluetoothdeviceinfo.htm#CoreConfiguration-enum" translate="no">QBluetoothDeviceInfo::LowEnergyCoreConfiguration</a> flag and adds them to a list which is shown to the user.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> Device<span class="operator">::</span>addDevice(<span class="keyword">const</span> <span class="type"><a href="./qbluetoothdeviceinfo.htm" translate="no">QBluetoothDeviceInfo</a></span> <span class="operator">&amp;</span>info)
{
    <span class="keyword">if</span> (info<span class="operator">.</span>coreConfigurations() <span class="operator">&amp;</span> <span class="type"><a href="./qbluetoothdeviceinfo.htm" translate="no">QBluetoothDeviceInfo</a></span><span class="operator">::</span>LowEnergyCoreConfiguration)
        setUpdate(<span class="string">"Last device added: "</span> <span class="operator">+</span> info<span class="operator">.</span>name());
}</pre></div>
<p>The list of devices may look like in the image below.</p>
<div class="admonition note">
<p><b>Note: </b>It is a prerequisite that the remote devices actively advertise their presence.</p>
</div>
<p class="centerAlign"><img alt="" src="./images/lowenergyscanner-devices.png"></p><a name="connecting-to-services"></a>
<h4 id="connecting-to-services">Connecting to Services<a class="plink" href="#connecting-to-services" title="Direct link to this headline"></a></h4>
<p>After the user has selected a device from the list the application connects to the device and scans all services. The <a href="./qlowenergycontroller.htm" translate="no">QLowEnergyController</a> class is used to connect to the device. The <a href="./qlowenergycontroller.htm#connectToDevice" translate="no">QLowEnergyController::connectToDevice</a>() function triggers the connection process which lasts until the <a href="./qlowenergycontroller.htm#connected" translate="no">QLowEnergyController::connected</a>() signal is received or an error has occurred:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="keyword">if</span> (<span class="operator">!</span>controller) {
    <span class="comment">// Connecting signals and slots for connecting to LE services.</span>
    controller <span class="operator">=</span> <span class="type"><a href="./qlowenergycontroller.htm" translate="no">QLowEnergyController</a></span><span class="operator">::</span>createCentral(currentDevice<span class="operator">.</span>getDevice());
    connect(controller<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qlowenergycontroller.htm" translate="no">QLowEnergyController</a></span><span class="operator">::</span>connected<span class="operator">,</span>
            <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>Device<span class="operator">::</span>deviceConnected);
    connect(controller<span class="operator">,</span> <span class="type">QOverload</span><span class="operator">&lt;</span><span class="type"><a href="./qlowenergycontroller.htm" translate="no">QLowEnergyController</a></span><span class="operator">::</span>Error<span class="operator">&gt;</span><span class="operator">::</span>of(<span class="operator">&amp;</span><span class="type"><a href="./qlowenergycontroller.htm" translate="no">QLowEnergyController</a></span><span class="operator">::</span>error)<span class="operator">,</span>
            <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>Device<span class="operator">::</span>errorReceived);
    connect(controller<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qlowenergycontroller.htm" translate="no">QLowEnergyController</a></span><span class="operator">::</span>disconnected<span class="operator">,</span>
            <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>Device<span class="operator">::</span>deviceDisconnected);
    connect(controller<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qlowenergycontroller.htm" translate="no">QLowEnergyController</a></span><span class="operator">::</span>serviceDiscovered<span class="operator">,</span>
            <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>Device<span class="operator">::</span>addLowEnergyService);
    connect(controller<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qlowenergycontroller.htm" translate="no">QLowEnergyController</a></span><span class="operator">::</span>discoveryFinished<span class="operator">,</span>
            <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>Device<span class="operator">::</span>serviceScanDone);
}

<span class="keyword">if</span> (isRandomAddress())
    controller<span class="operator">-</span><span class="operator">&gt;</span>setRemoteAddressType(<span class="type"><a href="./qlowenergycontroller.htm" translate="no">QLowEnergyController</a></span><span class="operator">::</span>RandomAddress);
<span class="keyword">else</span>
    controller<span class="operator">-</span><span class="operator">&gt;</span>setRemoteAddressType(<span class="type"><a href="./qlowenergycontroller.htm" translate="no">QLowEnergyController</a></span><span class="operator">::</span>PublicAddress);
controller<span class="operator">-</span><span class="operator">&gt;</span>connectToDevice();</pre></div>
<p>The slot triggered by the <a href="./qlowenergycontroller.htm#connected" translate="no">connected()</a> signal immediately calls <a href="./qlowenergycontroller.htm#discoverServices" translate="no">QLowEnergyController::discoverServices</a>() to start the service discovery on the connected peripheral device.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">controller<span class="operator">-</span><span class="operator">&gt;</span>discoverServices();</pre></div>
<p>The resulting list is presented to the user.The image below displays the results when the SensorTag device is selected. The view lists the names of the services, whether they are primary or secondary services and the UUID which determines the service type.</p>
<p class="centerAlign"><img alt="" src="./images/lowenergyscanner-services.png"></p><p>As soon as the service is chosen the related <a href="./qlowenergyservice.htm" translate="no">QLowEnergyService</a> instance is created to permit interaction with it:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type"><a href="./qlowenergyservice.htm" translate="no">QLowEnergyService</a></span> <span class="operator">*</span>service <span class="operator">=</span> controller<span class="operator">-</span><span class="operator">&gt;</span>createServiceObject(serviceUuid);
<span class="keyword">if</span> (<span class="operator">!</span>service) {
    <a href="./qtglobal.htm#qWarning" translate="no">qWarning</a>() <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="string">"Cannot create service for uuid"</span>;
    <span class="keyword">return</span>;
}</pre></div>
<p>The service object provides the required signals and functions to discover the service details, read and write characteristics and descriptors, as well as receive data change notifications. Change notifications can be triggered as a result of writing a value or due to an on-device update potentially triggered by the internal logic. During the initial detail search the service's <a href="./qlowenergyservice.htm#state" translate="no">state()</a> transitions from <a href="./qlowenergyservice.htm#ServiceState-enum" translate="no">DiscoveryRequired</a> to <a href="./qlowenergyservice.htm#ServiceState-enum" translate="no">DiscoveringServices</a> and eventually ends with <a href="./qlowenergyservice.htm#ServiceState-enum" translate="no">ServiceDiscovered</a>:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">connect(service<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qlowenergyservice.htm" translate="no">QLowEnergyService</a></span><span class="operator">::</span>stateChanged<span class="operator">,</span>
        <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>Device<span class="operator">::</span>serviceDetailsDiscovered);
service<span class="operator">-</span><span class="operator">&gt;</span>discoverDetails();
setUpdate(<span class="string">"Back\n(Discovering details...)"</span>);</pre></div>
<a name="reading-service-data"></a>
<h4 id="reading-service-data">Reading Service Data<a class="plink" href="#reading-service-data" title="Direct link to this headline"></a></h4>
<p>Upon selection of a service the service details are shown. Each characteristic is listed together with its name, UUID, value, handle and properties.</p>
<p class="centerAlign"><img alt="" src="./images/lowenergyscanner-chars.png"></p><p>It is possible to retrieve the service's characteristics via <a href="./qlowenergyservice.htm#characteristics" translate="no">QLowEnergyService::characteristics</a>() and in turn, each descriptor can be obtained via <a href="./qlowenergycharacteristic.htm#descriptors" translate="no">QLowEnergyCharacteristic::descriptors</a>().</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="keyword">const</span> <span class="type"><a href="./qlist.htm" translate="no">QList</a></span><span class="operator">&lt;</span><span class="type"><a href="./qlowenergycharacteristic.htm" translate="no">QLowEnergyCharacteristic</a></span><span class="operator">&gt;</span> chars <span class="operator">=</span> service<span class="operator">-</span><span class="operator">&gt;</span>characteristics();
<span class="keyword">for</span> (<span class="keyword">const</span> <span class="type"><a href="./qlowenergycharacteristic.htm" translate="no">QLowEnergyCharacteristic</a></span> <span class="operator">&amp;</span>ch : chars) {
    <span class="keyword">auto</span> cInfo <span class="operator">=</span> <span class="keyword">new</span> CharacteristicInfo(ch);
    m_characteristics<span class="operator">.</span>append(cInfo);
}</pre></div>
<p>Although the example application does not display descriptors it uses descriptors to get the name of an individual characteristic if its name cannot be discerned based on its UUID. The second way to obtain the name is the existence of a descriptor of the type <a href="./qbluetoothuuid.htm#DescriptorType-enum" translate="no">QBluetoothUuid::CharacteristicUserDescription</a>. The code below demonstrates how this may be achieved:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type"><a href="./qstring.htm" translate="no">QString</a></span> name <span class="operator">=</span> m_characteristic<span class="operator">.</span>name();
<span class="keyword">if</span> (<span class="operator">!</span>name<span class="operator">.</span>isEmpty())
    <span class="keyword">return</span> name;

<span class="comment">// find descriptor with CharacteristicUserDescription</span>
<span class="keyword">const</span> <span class="type"><a href="./qlist.htm" translate="no">QList</a></span><span class="operator">&lt;</span><span class="type"><a href="./qlowenergydescriptor.htm" translate="no">QLowEnergyDescriptor</a></span><span class="operator">&gt;</span> descriptors <span class="operator">=</span> m_characteristic<span class="operator">.</span>descriptors();
<span class="keyword">for</span> (<span class="keyword">const</span> <span class="type"><a href="./qlowenergydescriptor.htm" translate="no">QLowEnergyDescriptor</a></span> <span class="operator">&amp;</span>descriptor : descriptors) {
    <span class="keyword">if</span> (descriptor<span class="operator">.</span>type() <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="./qbluetoothuuid.htm" translate="no">QBluetoothUuid</a></span><span class="operator">::</span>CharacteristicUserDescription) {
        name <span class="operator">=</span> descriptor<span class="operator">.</span>value();
        <span class="keyword">break</span>;
    }
}</pre></div>
<p><a href="https://code.qt.io/cgit/qt/qtconnectivity.git/tree/examples/bluetooth/lowenergyscanner?h=5.15" translate="no">Example project @ code.qt.io</a></p>
</div>
<!-- @@@lowenergyscanner -->
</div>
<p class="copy-notice">
<acronym title="Copyright">Â©</acronym> 2025 The Qt Company Ltd.
   Documentation contributions included herein are the copyrights of
   their respective owners.     The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the Free Software Foundation.     Qt and respective logos are <a href="https://doc.qt.io/qt/trademarks.html">    trademarks</a> of The Qt Company Ltd. in Finland and/or other countries
   worldwide. All other trademarks are property of their respective owners. </p>

                    </div>
                </article>
                
            </div>
        </div>
    </div>
</div>
</body></html>