<html lang="en"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>QAxBase | Active Qt</title>
<link rel="canonical" href="https://doc.qt.io/qt-6/qaxbase.html">
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <!-- Google Tag Manager -->
    
  <!-- End Google Tag Manager -->
  
  
</head>
<body class="qt-design-system" style="background:var(--content-bg-color)" onload="prettyPrint()">

<div data-global-resource-path="qt-design-system/components/b-sidebar.html">
    <div class="b-sidebar b-sidebar--full-width">
        
        <div class="b-sidebar__content">
            <div class="b-sidebar__topbar" data-margin-bottom="sm">
                <div class="b-topbar">
                                        <div class="b-topbar__breadcrump" translate="no">
                        <ul class="c-breadcrump">
                            <li><a href="./index.htm" translate="no">Qt 5.15</a></li>
                            <li><a href="./activeqt-index.htm" translate="no">Active Qt</a></li>
                            <li><a>QAxBase</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="b-sidebar__content__wrapper">
                <article class="b-sidebar__content__left">
                    <div class="context mainContent" style="margin: 0;padding: 0; background: 0;">
                    

<div class="context">
<h1 class="title" translate="no">QAxBase Class</h1>
<!-- $$$QAxBase-brief -->
<p>The QAxBase class is an abstract class that provides an API to initialize and access a COM object. <a href="#details">More...</a></p>
<!-- @@@QAxBase -->
<div class="table"><table class="alignedsummary" translate="no">
<tbody><tr><td class="memItemLeft rightAlign topAlign"> Header:</td><td class="memItemRight bottomAlign"> <span class="preprocessor">#include &lt;QAxBase&gt;</span>
</td></tr><tr><td class="memItemLeft rightAlign topAlign"> qmake:</td><td class="memItemRight bottomAlign"> QT += axcontainer</td></tr><tr><td class="memItemLeft rightAlign topAlign"> Inherited By:</td><td class="memItemRight bottomAlign"> <p><a href="./qaxobject.htm" translate="no">QAxObject</a> and <a href="./qaxwidget.htm" translate="no">QAxWidget</a></p>
</td></tr></tbody></table></div><ul>
<li><a href="./qaxbase-members.htm">List of all members, including inherited members</a></li>
</ul>
<a name="public-types"></a>
<h2 id="public-types">Public Types<a class="plink" href="#public-types" title="Direct link to this headline"></a></h2>
<div class="table"><table class="alignedsummary" translate="no">
<tbody><tr><td class="memItemLeft rightAlign topAlign"> (alias) </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#PropertyBag-alias" translate="no">PropertyBag</a></b></td></tr>
</tbody></table></div>
<a name="properties"></a>
<h2 id="properties">Properties<a class="plink" href="#properties" title="Direct link to this headline"></a></h2>
<ul>
<li class="fn" translate="no"><b><a href="./qaxbase.htm#control-prop" translate="no">control</a></b> : QString</li>
</ul>
<a name="public-functions"></a>
<h2 id="public-functions">Public Functions<a class="plink" href="#public-functions" title="Direct link to this headline"></a></h2>
<div class="table"><table class="alignedsummary" translate="no">
<tbody><tr><td class="memItemLeft rightAlign topAlign"> </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#QAxBase" translate="no">QAxBase</a></b>(IUnknown *<i>iface</i> = nullptr)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> virtual </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#dtor.QAxBase" translate="no">~QAxBase</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> QVariant </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#asVariant" translate="no">asVariant</a></b>() const</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> unsigned long </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#classContext" translate="no">classContext</a></b>() const</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> virtual void </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#clear" translate="no">clear</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> QString </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#control-prop" translate="no">control</a></b>() const</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> void </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#disableClassInfo" translate="no">disableClassInfo</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> void </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#disableEventSink" translate="no">disableEventSink</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> void </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#disableMetaObject" translate="no">disableMetaObject</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> QVariant </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#dynamicCall" translate="no">dynamicCall</a></b>(const char *<i>function</i>, const QVariant &amp;<i>var1</i> = QVariant(), const QVariant &amp;<i>var2</i> = QVariant(), const QVariant &amp;<i>var3</i> = QVariant(), const QVariant &amp;<i>var4</i> = QVariant(), const QVariant &amp;<i>var5</i> = QVariant(), const QVariant &amp;<i>var6</i> = QVariant(), const QVariant &amp;<i>var7</i> = QVariant(), const QVariant &amp;<i>var8</i> = QVariant())</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> QVariant </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#dynamicCall-1" translate="no">dynamicCall</a></b>(const char *<i>function</i>, QList&lt;QVariant&gt; &amp;<i>vars</i>)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> QString </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#generateDocumentation" translate="no">generateDocumentation</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> bool </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#isNull" translate="no">isNull</a></b>() const</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> QAxBase::PropertyBag </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#propertyBag" translate="no">propertyBag</a></b>() const</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> virtual bool </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#propertyWritable" translate="no">propertyWritable</a></b>(const char *<i>prop</i>) const</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> long </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#queryInterface" translate="no">queryInterface</a></b>(const QUuid &amp;<i>uuid</i>, void **<i>iface</i>) const</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> QAxObject *</td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#querySubObject" translate="no">querySubObject</a></b>(const char *<i>name</i>, const QVariant &amp;<i>var1</i> = QVariant(), const QVariant &amp;<i>var2</i> = QVariant(), const QVariant &amp;<i>var3</i> = QVariant(), const QVariant &amp;<i>var4</i> = QVariant(), const QVariant &amp;<i>var5</i> = QVariant(), const QVariant &amp;<i>var6</i> = QVariant(), const QVariant &amp;<i>var7</i> = QVariant(), const QVariant &amp;<i>var8</i> = QVariant())</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> QAxObject *</td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#querySubObject-1" translate="no">querySubObject</a></b>(const char *<i>name</i>, QList&lt;QVariant&gt; &amp;<i>vars</i>)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> void </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#setClassContext" translate="no">setClassContext</a></b>(unsigned long <i>classContext</i>)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> bool </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#control-prop" translate="no">setControl</a></b>(<i>const QString &amp;</i>)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> void </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#setPropertyBag" translate="no">setPropertyBag</a></b>(const QAxBase::PropertyBag &amp;<i>bag</i>)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> virtual void </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#setPropertyWritable" translate="no">setPropertyWritable</a></b>(const char *<i>prop</i>, bool <i>ok</i>)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> QStringList </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#verbs" translate="no">verbs</a></b>() const</td></tr>
</tbody></table></div>
<a name="signals"></a>
<h2 id="signals">Signals<a class="plink" href="#signals" title="Direct link to this headline"></a></h2>
<div class="table"><table class="alignedsummary" translate="no">
<tbody><tr><td class="memItemLeft rightAlign topAlign"> void </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#exception" translate="no">exception</a></b>(int <i>code</i>, const QString &amp;<i>source</i>, const QString &amp;<i>desc</i>, const QString &amp;<i>help</i>)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> void </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#propertyChanged" translate="no">propertyChanged</a></b>(const QString &amp;<i>name</i>)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> void </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#signal" translate="no">signal</a></b>(const QString &amp;<i>name</i>, int <i>argc</i>, void *<i>argv</i>)</td></tr>
</tbody></table></div>
<a name="protected-functions"></a>
<h2 id="protected-functions">Protected Functions<a class="plink" href="#protected-functions" title="Direct link to this headline"></a></h2>
<div class="table"><table class="alignedsummary" translate="no">
<tbody><tr><td class="memItemLeft rightAlign topAlign"> virtual bool </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#initialize" translate="no">initialize</a></b>(IUnknown **<i>ptr</i>)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> bool </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#initializeActive" translate="no">initializeActive</a></b>(IUnknown **<i>ptr</i>)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> bool </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#initializeFromFile" translate="no">initializeFromFile</a></b>(IUnknown **<i>ptr</i>)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> bool </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#initializeLicensed" translate="no">initializeLicensed</a></b>(IUnknown **<i>ptr</i>)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> bool </td><td class="memItemRight bottomAlign"><b><a href="./qaxbase.htm#initializeRemote" translate="no">initializeRemote</a></b>(IUnknown **<i>ptr</i>)</td></tr>
</tbody></table></div>
<a name="details"></a>
<!-- $$$QAxBase-description -->
<div class="descr">
<h2 id="details">Detailed Description<a class="plink" href="#details" title="Direct link to this headline"></a></h2>
<p>QAxBase is an abstract class that cannot be used directly, and is instantiated through the subclasses <a href="./qaxobject.htm" translate="no">QAxObject</a> and <a href="./qaxwidget.htm" translate="no">QAxWidget</a>. This class provides the API to access the COM object directly through its IUnknown implementation. If the COM object implements the IDispatch interface, the properties and methods of that object become available as Qt properties and slots.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">connect(buttonBack<span class="operator">,</span> SIGNAL(clicked())<span class="operator">,</span> webBrowser<span class="operator">,</span> SLOT(GoBack()));</pre></div>
<p>Properties exposed by the object's IDispatch implementation can be read and written through the property system provided by the Qt Object Model (both subclasses are <a href="./qobject.htm" translate="no">QObject</a>s, so you can use <a href="./qobject.htm#setProperty" translate="no">QObject::setProperty</a>() and <a href="./qobject.htm#property" translate="no">QObject::property</a>()). Properties with multiple parameters are not supported.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">activeX<span class="operator">-</span><span class="operator">&gt;</span>setProperty(<span class="string">"text"</span><span class="operator">,</span> <span class="string">"some text"</span>);
<span class="type">int</span> value <span class="operator">=</span> activeX<span class="operator">-</span><span class="operator">&gt;</span>property(<span class="string">"value"</span>);</pre></div>
<p>Write-functions for properties and other methods exposed by the object's IDispatch implementation can be called directly using <a href="./qaxbase.htm#dynamicCall" translate="no">dynamicCall</a>(), or indirectly as slots connected to a signal.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">webBrowser<span class="operator">-</span><span class="operator">&gt;</span>dynamicCall(<span class="string">"GoHome()"</span>);</pre></div>
<p>Outgoing events supported by the COM object are emitted as standard Qt signals.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">connect(webBrowser<span class="operator">,</span> SIGNAL(TitleChanged(<span class="type"><a href="./qstring.htm" translate="no">QString</a></span>))<span class="operator">,</span>
        <span class="keyword">this</span><span class="operator">,</span> SLOT(setCaption(<span class="type"><a href="./qstring.htm" translate="no">QString</a></span>)));</pre></div>
<p>QAxBase transparently converts between COM data types and the equivalent Qt data types. Some COM types have no equivalent Qt data structure.</p>
<p>Supported COM datatypes are listed in the first column of following table. The second column is the Qt type that can be used with the <a href="./qobject.htm" translate="no">QObject</a> property functions. The third column is the Qt type that is used in the prototype of generated signals and slots for in-parameters, and the last column is the Qt type that is used in the prototype of signals and slots for out-parameters.</p>
<div class="table"><table class="generic">
<thead><tr class="qt-style"><th>COM type</th><th>Qt property</th><th>in-parameter</th><th>out-parameter</th></tr></thead>
<tbody><tr class="odd" valign="top"><td>VARIANT_BOOL</td><td>bool</td><td>bool</td><td>bool&amp;</td></tr>
<tr class="even" valign="top"><td>BSTR</td><td><a href="./qstring.htm" translate="no">QString</a></td><td>const <a href="./qstring.htm" translate="no">QString</a>&amp;</td><td><a href="./qstring.htm" translate="no">QString</a>&amp;</td></tr>
<tr class="odd" valign="top"><td>char, short, int, long</td><td>int</td><td>int</td><td>int&amp;</td></tr>
<tr class="even" valign="top"><td>uchar, ushort, uint, ulong</td><td>uint</td><td>uint</td><td>uint&amp;</td></tr>
<tr class="odd" valign="top"><td>float, double</td><td>double</td><td>double</td><td>double&amp;</td></tr>
<tr class="even" valign="top"><td>DATE</td><td><a href="./qdatetime.htm" translate="no">QDateTime</a></td><td>const <a href="./qdatetime.htm" translate="no">QDateTime</a>&amp;</td><td><a href="./qdatetime.htm" translate="no">QDateTime</a>&amp;</td></tr>
<tr class="odd" valign="top"><td>CY</td><td>qlonglong</td><td>qlonglong</td><td>qlonglong&amp;</td></tr>
<tr class="even" valign="top"><td>OLE_COLOR</td><td><a href="./qcolor.htm" translate="no">QColor</a></td><td>const <a href="./qcolor.htm" translate="no">QColor</a>&amp;</td><td><a href="./qcolor.htm" translate="no">QColor</a>&amp;</td></tr>
<tr class="odd" valign="top"><td>SAFEARRAY(VARIANT)</td><td><a href="./qlist.htm" translate="no">QList</a>&lt;<a href="./qvariant.htm" translate="no">QVariant</a>&gt;</td><td>const <a href="./qlist.htm" translate="no">QList</a>&lt;<a href="./qvariant.htm" translate="no">QVariant</a>&gt;&amp;</td><td><a href="./qlist.htm" translate="no">QList</a>&lt;<a href="./qvariant.htm" translate="no">QVariant</a>&gt;&amp;</td></tr>
<tr class="even" valign="top"><td>SAFEARRAY(int), SAFEARRAY(double), SAFEARRAY(Date)</td><td><a href="./qlist.htm" translate="no">QList</a>&lt;<a href="./qvariant.htm" translate="no">QVariant</a>&gt;</td><td>const <a href="./qlist.htm" translate="no">QList</a>&lt;<a href="./qvariant.htm" translate="no">QVariant</a>&gt;&amp;</td><td><a href="./qlist.htm" translate="no">QList</a>&lt;<a href="./qvariant.htm" translate="no">QVariant</a>&gt;&amp;</td></tr>
<tr class="odd" valign="top"><td>SAFEARRAY(BYTE)</td><td><a href="./qbytearray.htm" translate="no">QByteArray</a></td><td>const <a href="./qbytearray.htm" translate="no">QByteArray</a>&amp;</td><td><a href="./qbytearray.htm" translate="no">QByteArray</a>&amp;</td></tr>
<tr class="even" valign="top"><td>SAFEARRAY(BSTR)</td><td><a href="./qstringlist.htm" translate="no">QStringList</a></td><td>const <a href="./qstringlist.htm" translate="no">QStringList</a>&amp;</td><td><a href="./qstringlist.htm" translate="no">QStringList</a>&amp;</td></tr>
<tr class="odd" valign="top"><td>VARIANT</td><td>type-dependent</td><td>const <a href="./qvariant.htm" translate="no">QVariant</a>&amp;</td><td><a href="./qvariant.htm" translate="no">QVariant</a>&amp;</td></tr>
<tr class="even" valign="top"><td>IFontDisp*</td><td><a href="./qfont.htm" translate="no">QFont</a></td><td>const <a href="./qfont.htm" translate="no">QFont</a>&amp;</td><td><a href="./qfont.htm" translate="no">QFont</a>&amp;</td></tr>
<tr class="odd" valign="top"><td>IPictureDisp*</td><td><a href="./qpixmap.htm" translate="no">QPixmap</a></td><td>const <a href="./qpixmap.htm" translate="no">QPixmap</a>&amp;</td><td><a href="./qpixmap.htm" translate="no">QPixmap</a>&amp;</td></tr>
<tr class="even" valign="top"><td>IDispatch*</td><td><a href="./qaxobject.htm" translate="no">QAxObject</a>*</td><td><code translate="no">QAxBase::asVariant()</code></td><td><a href="./qaxobject.htm" translate="no">QAxObject</a>* (return value)</td></tr>
<tr class="odd" valign="top"><td>IUnknown*</td><td><a href="./qaxobject.htm" translate="no">QAxObject</a>*</td><td><code translate="no">QAxBase::asVariant()</code></td><td><a href="./qaxobject.htm" translate="no">QAxObject</a>* (return value)</td></tr>
<tr class="even" valign="top"><td>SCODE, DECIMAL</td><td><i>unsupported</i></td><td><i>unsupported</i></td><td><i>unsupported</i></td></tr>
<tr class="odd" valign="top"><td>VARIANT* (Since Qt 4.5)</td><td><i>unsupported</i></td><td><i>QVariant&amp;</i></td><td><i>QVariant&amp;</i></td></tr>
</tbody></table></div>
<p>Supported are also enumerations, and typedefs to supported types.</p>
<p>To call the methods of a COM interface described by the following IDL</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">dispinterface IControl
{
properties:
    <span class="operator">[</span>id(<span class="number">1</span>)<span class="operator">]</span> BSTR text;
    <span class="operator">[</span>id(<span class="number">2</span>)<span class="operator">]</span> IFontDisp <span class="operator">*</span>font;

methods:
    <span class="operator">[</span>id(<span class="number">6</span>)<span class="operator">]</span> <span class="type">void</span> showColumn(<span class="operator">[</span>in<span class="operator">]</span> <span class="type">int</span> i);
    <span class="operator">[</span>id(<span class="number">3</span>)<span class="operator">]</span> bool addColumn(<span class="operator">[</span>in<span class="operator">]</span> BSTR t);
    <span class="operator">[</span>id(<span class="number">4</span>)<span class="operator">]</span> <span class="type">int</span> fillList(<span class="operator">[</span>in<span class="operator">,</span> out<span class="operator">]</span> SAFEARRAY(VARIANT) <span class="operator">*</span>list);
    <span class="operator">[</span>id(<span class="number">5</span>)<span class="operator">]</span> IDispatch <span class="operator">*</span>item(<span class="operator">[</span>in<span class="operator">]</span> <span class="type">int</span> i);
};</pre></div>
<p>use the QAxBase API like this:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type"><a href="./qaxobject.htm" translate="no">QAxObject</a></span> object(<span class="string">"&lt;CLSID&gt;"</span>);

<span class="type"><a href="./qstring.htm" translate="no">QString</a></span> text <span class="operator">=</span> object<span class="operator">.</span>property(<span class="string">"text"</span>)<span class="operator">.</span>toString();
object<span class="operator">.</span>setProperty(<span class="string">"font"</span><span class="operator">,</span> <span class="type"><a href="./qfont.htm" translate="no">QFont</a></span>(<span class="string">"Times New Roman"</span><span class="operator">,</span> <span class="number">12</span>));

connect(<span class="keyword">this</span><span class="operator">,</span> SIGNAL(clicked(<span class="type">int</span>))<span class="operator">,</span> <span class="operator">&amp;</span>object<span class="operator">,</span> SLOT(showColumn(<span class="type">int</span>)));
bool ok <span class="operator">=</span> object<span class="operator">.</span>dynamicCall(<span class="string">"addColumn(const QString&amp;)"</span><span class="operator">,</span> <span class="string">"Column 1"</span>)<span class="operator">.</span>toBool();

<span class="type"><a href="./qlist.htm" translate="no">QList</a></span><span class="operator">&lt;</span><span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span><span class="operator">&gt;</span> varlist;
<span class="type"><a href="./qlist.htm" translate="no">QList</a></span><span class="operator">&lt;</span><span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span><span class="operator">&gt;</span> parameters;
parameters <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span>(varlist);
<span class="type">int</span> n <span class="operator">=</span> object<span class="operator">.</span>dynamicCall(<span class="string">"fillList(QList&lt;QVariant&gt;&amp;)"</span><span class="operator">,</span> parameters)<span class="operator">.</span>toInt();

<span class="type"><a href="./qaxobject.htm" translate="no">QAxObject</a></span> <span class="operator">*</span>item <span class="operator">=</span> object<span class="operator">.</span>querySubItem(<span class="string">"item(int)"</span><span class="operator">,</span> <span class="number">5</span>);</pre></div>
<p>Note that the <a href="./qlist.htm" translate="no">QList</a> the object should fill has to be provided as an element in the parameter list of <a href="./qvariant.htm" translate="no">QVariant</a>s.</p>
<p>If you need to access properties or pass parameters of unsupported datatypes you must access the COM object directly through its <code translate="no">IDispatch</code> implementation or other interfaces. Those interfaces can be retrieved through <a href="./qaxbase.htm#queryInterface" translate="no">queryInterface</a>().</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">IUnknown <span class="operator">*</span>iface <span class="operator">=</span> <span class="number">0</span>;
activeX<span class="operator">-</span><span class="operator">&gt;</span>queryInterface(IID_IUnknown<span class="operator">,</span> (<span class="type">void</span><span class="operator">*</span><span class="operator">*</span>)<span class="operator">&amp;</span>iface);
<span class="keyword">if</span> (iface) {
    <span class="comment">// use the interface</span>
    iface<span class="operator">-</span><span class="operator">&gt;</span>Release();
}</pre></div>
<p>To get the definition of the COM interfaces you will have to use the header files provided with the component you want to use. Some compilers can also import type libraries using the #import compiler directive. See the component documentation to find out which type libraries you have to import, and how to use them.</p>
<p>If you need to react to events that pass parameters of unsupported datatypes you can use the generic signal that delivers the event data as provided by the COM event.</p>
</div>
<p><b>See also </b><a href="./qaxobject.htm" translate="no">QAxObject</a>, <a href="./qaxwidget.htm" translate="no">QAxWidget</a>, <a href="./qaxscript.htm" translate="no">QAxScript</a>, and <a href="./activeqt-index.htm" translate="no">ActiveQt Framework</a>.</p>
<!-- @@@QAxBase -->
<div class="types">
<h2>Member Type Documentation</h2>
<!-- $$$PropertyBag -->
<h3 class="fn" id="PropertyBag-alias" translate="no"><a name="PropertyBag-alias"></a><code translate="no">[alias] </code>QAxBase::<span class="name">PropertyBag</span><a class="plink" href="#PropertyBag-alias" title="Direct link to this headline"></a></h3>
<p>This is a type alias for QMap&lt;QString, QVariant&gt;.</p>
<p>A <a href="./qmap.htm" translate="no">QMap</a>&lt;<a href="./qstring.htm" translate="no">QString</a>,<a href="./qvariant.htm" translate="no">QVariant</a>&gt; that can store properties as name:value pairs.</p>
<!-- @@@PropertyBag -->
</div>
<div class="prop">
<h2>Property Documentation</h2>
<!-- $$$control-prop$$$control$$$setControlconstQString& -->
<h3 class="fn" id="control-prop" translate="no"><a name="control-prop"></a><span class="name">control</span> : <span class="type"><a href="./qstring.htm" translate="no">QString</a></span><a class="plink" href="#control-prop" title="Direct link to this headline"></a></h3>
<p>This property holds the name of the COM object wrapped by this <a href="./qaxbase.htm" translate="no">QAxBase</a> object.</p>
<p>Setting this property initializes the COM object. Any COM object previously set is shut down.</p>
<p>The most efficient way to set this property is by using the registered component's UUID, e.g.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">ctrl<span class="operator">-</span><span class="operator">&gt;</span>setControl(<span class="string">"{8E27C92B-1264-101C-8A2F-040224009C02}"</span>);</pre></div>
<p>The second fastest way is to use the registered control's class name (with or without version number), e.g.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">ctrl<span class="operator">-</span><span class="operator">&gt;</span>setControl(<span class="string">"MSCal.Calendar"</span>);</pre></div>
<p>The slowest, but easiest way to use is to use the control's full name, e.g.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">ctrl<span class="operator">-</span><span class="operator">&gt;</span>setControl(<span class="string">"Calendar Control 9.0"</span>);</pre></div>
<p>It is also possible to initialize the object from a file, e.g.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">ctrl<span class="operator">-</span><span class="operator">&gt;</span>setControl(<span class="string">"c:/files/file.doc"</span>);</pre></div>
<p>If the component's UUID is used the following patterns can be used to initialize the control on a remote machine, to initialize a licensed control or to connect to a running object:</p>
<ul>
<li>To initialize the control on a different machine use the following pattern:<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="operator">&lt;</span>domain<span class="operator">/</span>username<span class="operator">&gt;</span>:<span class="operator">&lt;</span>password<span class="operator">&gt;</span>@server<span class="operator">/</span>{<span class="number">8E27C92B</span><span class="operator">-</span><span class="number">1264</span><span class="operator">-</span><span class="number">101C</span><span class="operator">-</span><span class="number">8A2F</span><span class="operator">-</span><span class="number">040224009C02</span>}</pre></div>
</li>
<li>To initialize a licensed control use the following pattern:<div class="pre"><pre class="cpp prettyprint" translate="no">{<span class="number">8E27C92B</span><span class="operator">-</span><span class="number">1264</span><span class="operator">-</span><span class="number">101C</span><span class="operator">-</span><span class="number">8A2F</span><span class="operator">-</span><span class="number">040224009C02</span>}:<span class="operator">&lt;</span>LicenseKey<span class="operator">&gt;</span></pre></div>
</li>
<li>To connect to an already running object use the following pattern:<div class="pre"><pre class="cpp prettyprint" translate="no">{<span class="number">8E27C92B</span><span class="operator">-</span><span class="number">1264</span><span class="operator">-</span><span class="number">101C</span><span class="operator">-</span><span class="number">8A2F</span><span class="operator">-</span><span class="number">040224009C02</span>}<span class="operator">&amp;</span></pre></div>
</li>
</ul>
<p>The first two patterns can be combined, e.g. to initialize a licensed control on a remote machine:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">ctrl<span class="operator">-</span><span class="operator">&gt;</span>setControl(<span class="string">"DOMAIN/user:password@server/{8E27C92B-1264-101C-8A2F-040224009C02}:LicenseKey"</span>);</pre></div>
<p>The control's read function always returns the control's UUID, if provided including the license key, and the name of the server, but not including the username, the domain or the password.</p>
<p><b>Access functions:</b></p>
<div class="table"><table class="alignedsummary" translate="no">
<tbody><tr><td class="memItemLeft topAlign rightAlign"> QString </td><td class="memItemRight bottomAlign"><span class="name"><b>control</b></span>() const</td></tr>
<tr><td class="memItemLeft topAlign rightAlign"> bool </td><td class="memItemRight bottomAlign"><span class="name"><b>setControl</b></span>(<i>const QString &amp;</i>)</td></tr>
</tbody></table></div>
<p><b>See also </b><a href="./qaxbase.htm#setClassContext" translate="no">setClassContext</a>().</p>
<!-- @@@control -->
</div>
<div class="func">
<h2>Member Function Documentation</h2>
<!-- $$$QAxBase[overload1]$$$QAxBaseIUnknown* -->
<h3 class="fn" id="QAxBase" translate="no"><a name="QAxBase"></a>QAxBase::<span class="name">QAxBase</span>(<span class="type">IUnknown</span> *<i>iface</i> = nullptr)<a class="plink" href="#QAxBase" title="Direct link to this headline"></a></h3>
<p>Creates a QAxBase object that wraps the COM object <i translate="no">iface</i>. If <i translate="no">iface</i> is 0 (the default), use <a href="./qaxbase.htm#control-prop" translate="no">setControl</a>() to instantiate a COM object.</p>
<!-- @@@QAxBase -->
<!-- $$$exception[overload1]$$$exceptionintconstQString&constQString&constQString& -->
<h3 class="fn" id="exception" translate="no"><a name="exception"></a><code translate="no">[signal] </code><span class="type">void</span> QAxBase::<span class="name">exception</span>(<span class="type">int</span> <i>code</i>, const <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> &amp;<i>source</i>, const <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> &amp;<i>desc</i>, const <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> &amp;<i>help</i>)<a class="plink" href="#exception" title="Direct link to this headline"></a></h3>
<p>This signal is emitted when the COM object throws an exception while called using the OLE automation interface IDispatch. <i translate="no">code</i>, <i translate="no">source</i>, <i translate="no">desc</i> and <i translate="no">help</i> provide information about the exception as provided by the COM server and can be used to provide useful feedback to the end user. <i translate="no">help</i> includes the help file, and the help context ID in brackets, e.g. "filename [id]".</p>
<!-- @@@exception -->
<!-- $$$propertyChanged[overload1]$$$propertyChangedconstQString& -->
<h3 class="fn" id="propertyChanged" translate="no"><a name="propertyChanged"></a><code translate="no">[signal] </code><span class="type">void</span> QAxBase::<span class="name">propertyChanged</span>(const <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> &amp;<i>name</i>)<a class="plink" href="#propertyChanged" title="Direct link to this headline"></a></h3>
<p>If the COM object supports property notification, this signal gets emitted when the property called <i translate="no">name</i> is changed.</p>
<!-- @@@propertyChanged -->
<!-- $$$signal[overload1]$$$signalconstQString&intvoid* -->
<h3 class="fn" id="signal" translate="no"><a name="signal"></a><code translate="no">[signal] </code><span class="type">void</span> QAxBase::<span class="name">signal</span>(const <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> &amp;<i>name</i>, <span class="type">int</span> <i>argc</i>, <span class="type">void</span> *<i>argv</i>)<a class="plink" href="#signal" title="Direct link to this headline"></a></h3>
<p>This generic signal gets emitted when the COM object issues the event <i translate="no">name</i>. <i translate="no">argc</i> is the number of parameters provided by the event (DISPPARAMS.cArgs), and <i translate="no">argv</i> is the pointer to the parameter values (DISPPARAMS.rgvarg). Note that the order of parameter values is turned around, ie. the last element of the array is the first parameter in the function.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> Receiver<span class="operator">::</span>slot(<span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> <span class="operator">&amp;</span>name<span class="operator">,</span> <span class="type">int</span> argc<span class="operator">,</span> <span class="type">void</span> <span class="operator">*</span>argv)
{
    VARIANTARG <span class="operator">*</span>params <span class="operator">=</span> (VARIANTARG<span class="operator">*</span>)argv;
    <span class="keyword">if</span> (name<span class="operator">.</span>startsWith(<span class="string">"BeforeNavigate2("</span>)) {
        IDispatch <span class="operator">*</span>pDisp <span class="operator">=</span> params<span class="operator">[</span>argc<span class="operator">-</span><span class="number">1</span><span class="operator">]</span><span class="operator">.</span>pdispVal;
        VARIANTARG URL <span class="operator">=</span> <span class="operator">*</span>params<span class="operator">[</span>argc<span class="operator">-</span><span class="number">2</span><span class="operator">]</span><span class="operator">.</span>pvarVal;
        VARIANTARG Flags <span class="operator">=</span> <span class="operator">*</span>params<span class="operator">[</span>argc<span class="operator">-</span><span class="number">3</span><span class="operator">]</span><span class="operator">.</span>pvarVal;
        VARIANTARG TargetFrameName <span class="operator">=</span> <span class="operator">*</span>params<span class="operator">[</span>argc<span class="operator">-</span><span class="number">4</span><span class="operator">]</span><span class="operator">.</span>pvarVal;
        VARIANTARG PostData <span class="operator">=</span> <span class="operator">*</span>params<span class="operator">[</span>argc<span class="operator">-</span><span class="number">5</span><span class="operator">]</span><span class="operator">.</span>pvarVal;
        VARIANTARG Headers <span class="operator">=</span> <span class="operator">*</span>params<span class="operator">[</span>argc<span class="operator">-</span><span class="number">6</span><span class="operator">]</span><span class="operator">.</span>pvarVal;
        bool <span class="operator">*</span>Cancel <span class="operator">=</span> params<span class="operator">[</span>argc<span class="operator">-</span><span class="number">7</span><span class="operator">]</span><span class="operator">.</span>pboolVal;
    }
}</pre></div>
<p>Use this signal if the event has parameters of unsupported data types. Otherwise, connect directly to the signal <i translate="no">name</i>.</p>
<!-- @@@signal -->
<!-- $$$~QAxBase[overload1]$$$~QAxBase -->
<h3 class="fn" id="dtor.QAxBase" translate="no"><a name="dtor.QAxBase"></a><code translate="no">[virtual] </code>QAxBase::<span class="name">~QAxBase</span>()<a class="plink" href="#dtor.QAxBase" title="Direct link to this headline"></a></h3>
<p>Shuts down the COM object and destroys the <a href="./qaxbase.htm" translate="no">QAxBase</a> object.</p>
<p><b>See also </b><a href="./qaxbase.htm#clear" translate="no">clear</a>().</p>
<!-- @@@~QAxBase -->
<!-- $$$asVariant[overload1]$$$asVariant -->
<h3 class="fn" id="asVariant" translate="no"><a name="asVariant"></a><span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> QAxBase::<span class="name">asVariant</span>() const<a class="plink" href="#asVariant" title="Direct link to this headline"></a></h3>
<p>Returns a <a href="./qvariant.htm" translate="no">QVariant</a> that wraps the COM object. The variant can then be used as a parameter in e.g. <a href="./qaxbase.htm#dynamicCall" translate="no">dynamicCall</a>().</p>
<!-- @@@asVariant -->
<!-- $$$classContext[overload1]$$$classContext -->
<h3 class="fn" id="classContext" translate="no"><a name="classContext"></a><span class="type">unsigned</span> <span class="type">long</span> QAxBase::<span class="name">classContext</span>() const<a class="plink" href="#classContext" title="Direct link to this headline"></a></h3>
<p>Returns the context the ActiveX control will run in (default CLSCTX_SERVER).</p>
<p>This function was introduced in Qt 5.13.</p>
<p><b>See also </b><a href="./qaxbase.htm#setClassContext" translate="no">setClassContext</a>().</p>
<!-- @@@classContext -->
<!-- $$$clear[overload1]$$$clear -->
<h3 class="fn" id="clear" translate="no"><a name="clear"></a><code translate="no">[virtual] </code><span class="type">void</span> QAxBase::<span class="name">clear</span>()<a class="plink" href="#clear" title="Direct link to this headline"></a></h3>
<p>Disconnects and destroys the COM object.</p>
<p>If you reimplement this function you must also reimplement the destructor to call clear(), and call this implementation at the end of your clear() function.</p>
<!-- @@@clear -->
<!-- $$$disableClassInfo[overload1]$$$disableClassInfo -->
<h3 class="fn" id="disableClassInfo" translate="no"><a name="disableClassInfo"></a><span class="type">void</span> QAxBase::<span class="name">disableClassInfo</span>()<a class="plink" href="#disableClassInfo" title="Direct link to this headline"></a></h3>
<p>Disables the class info generation for this ActiveX container. If you don't require any class information about the ActiveX control use this function to speed up the meta object generation.</p>
<p>Note that this function must be called immediately after construction of the object</p>
<!-- @@@disableClassInfo -->
<!-- $$$disableEventSink[overload1]$$$disableEventSink -->
<h3 class="fn" id="disableEventSink" translate="no"><a name="disableEventSink"></a><span class="type">void</span> QAxBase::<span class="name">disableEventSink</span>()<a class="plink" href="#disableEventSink" title="Direct link to this headline"></a></h3>
<p>Disables the event sink implementation for this ActiveX container. If you don't intend to listen to the ActiveX control's events use this function to speed up the meta object generation.</p>
<p>Some ActiveX controls might be unstable when connected to an event sink. To get OLE events you must use standard COM methods to register your own event sink. Use <a href="./qaxbase.htm#queryInterface" translate="no">queryInterface</a>() to get access to the raw COM object.</p>
<p>Note that this function should be called immediately after construction of the object.</p>
<!-- @@@disableEventSink -->
<!-- $$$disableMetaObject[overload1]$$$disableMetaObject -->
<h3 class="fn" id="disableMetaObject" translate="no"><a name="disableMetaObject"></a><span class="type">void</span> QAxBase::<span class="name">disableMetaObject</span>()<a class="plink" href="#disableMetaObject" title="Direct link to this headline"></a></h3>
<p>Disables the meta object generation for this ActiveX container. This also disables the event sink and class info generation. If you don't intend to use the Qt meta object implementation call this function to speed up instantiation of the control. You will still be able to call the object through <a href="./qaxbase.htm#dynamicCall" translate="no">dynamicCall</a>(), but signals, slots and properties will not be available with <a href="./qobject.htm" translate="no">QObject</a> APIs.</p>
<p>Some ActiveX controls might be unstable when used with OLE automation. Use standard COM methods to use those controls through the COM interfaces provided by <a href="./qaxbase.htm#queryInterface" translate="no">queryInterface</a>().</p>
<p>Note that this function must be called immediately after construction of the object.</p>
<!-- @@@disableMetaObject -->
<!-- $$$dynamicCall[overload1]$$$dynamicCallconstchar*constQVariant&constQVariant&constQVariant&constQVariant&constQVariant&constQVariant&constQVariant&constQVariant& -->
<h3 class="fn" id="dynamicCall" translate="no"><a name="dynamicCall"></a><span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> QAxBase::<span class="name">dynamicCall</span>(const <span class="type">char</span> *<i>function</i>, const <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> &amp;<i>var1</i> = QVariant(), const <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> &amp;<i>var2</i> = QVariant(), const <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> &amp;<i>var3</i> = QVariant(), const <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> &amp;<i>var4</i> = QVariant(), const <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> &amp;<i>var5</i> = QVariant(), const <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> &amp;<i>var6</i> = QVariant(), const <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> &amp;<i>var7</i> = QVariant(), const <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> &amp;<i>var8</i> = QVariant())<a class="plink" href="#dynamicCall" title="Direct link to this headline"></a></h3>
<p>Calls the COM object's method <i translate="no">function</i>, passing the parameters <i translate="no">var1</i>, <i translate="no">var1</i>, <i translate="no">var2</i>, <i translate="no">var3</i>, <i translate="no">var4</i>, <i translate="no">var5</i>, <i translate="no">var6</i>, <i translate="no">var7</i> and <i translate="no">var8</i>, and returns the value returned by the method, or an invalid <a href="./qvariant.htm" translate="no">QVariant</a> if the method does not return a value or when the function call failed.</p>
<p>If <i translate="no">function</i> is a method of the object the string must be provided as the full prototype, for example as it would be written in a <a href="./qobject.htm#connect" translate="no">QObject::connect</a>() call.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">activeX<span class="operator">-</span><span class="operator">&gt;</span>dynamicCall(<span class="string">"Navigate(const QString&amp;)"</span><span class="operator">,</span> <span class="string">"www.qt-project.org"</span>);</pre></div>
<p>Alternatively a function can be called passing the parameters embedded in the string, e.g. above function can also be invoked using</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">activeX<span class="operator">-</span><span class="operator">&gt;</span>dynamicCall(<span class="string">"Navigate(\"www.qt-project.org\")"</span>);</pre></div>
<p>All parameters are passed as strings; it depends on the control whether they are interpreted correctly, and is slower than using the prototype with correctly typed parameters.</p>
<p>If <i translate="no">function</i> is a property the string has to be the name of the property. The property setter is called when <i translate="no">var1</i> is a valid <a href="./qvariant.htm" translate="no">QVariant</a>, otherwise the getter is called.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">activeX<span class="operator">-</span><span class="operator">&gt;</span>dynamicCall(<span class="string">"Value"</span><span class="operator">,</span> <span class="number">5</span>);
<span class="type"><a href="./qstring.htm" translate="no">QString</a></span> text <span class="operator">=</span> activeX<span class="operator">-</span><span class="operator">&gt;</span>dynamicCall(<span class="string">"Text"</span>)<span class="operator">.</span>toString();</pre></div>
<p>Note that it is faster to get and set properties using <a href="./qobject.htm#property" translate="no">QObject::property</a>() and <a href="./qobject.htm#setProperty" translate="no">QObject::setProperty</a>().</p>
<p>dynamicCall() can also be used to call objects with a <a href="./qaxbase.htm#disableMetaObject" translate="no">disabled metaobject</a> wrapper, which can improve performance significantely, esp. when calling many different objects of different types during an automation process. <a href="./activeqt-index.htm" translate="no">ActiveQt</a> will then however not validate parameters.</p>
<p>It is only possible to call functions through dynamicCall() that have parameters or return values of datatypes supported by <a href="./qvariant.htm" translate="no">QVariant</a>. See the <a href="./qaxbase.htm" translate="no">QAxBase</a> class documentation for a list of supported and unsupported datatypes. If you want to call functions that have unsupported datatypes in the parameter list, use <a href="./qaxbase.htm#queryInterface" translate="no">queryInterface</a>() to retrieve the appropriate COM interface, and use the function directly.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">IWebBrowser2 <span class="operator">*</span>webBrowser <span class="operator">=</span> <span class="number">0</span>;
activeX<span class="operator">-</span><span class="operator">&gt;</span>queryInterface(IID_IWebBrowser2<span class="operator">,</span> (<span class="type">void</span> <span class="operator">*</span><span class="operator">*</span>)<span class="operator">&amp;</span>webBrowser);
<span class="keyword">if</span> (webBrowser) {
    webBrowser<span class="operator">-</span><span class="operator">&gt;</span>Navigate2(pvarURL);
    webBrowser<span class="operator">-</span><span class="operator">&gt;</span>Release();
}</pre></div>
<p>This is also more efficient.</p>
<!-- @@@dynamicCall -->
<!-- $$$dynamicCall$$$dynamicCallconstchar*QList<QVariant>& -->
<h3 class="fn" id="dynamicCall-1" translate="no"><a name="dynamicCall-1"></a><span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> QAxBase::<span class="name">dynamicCall</span>(const <span class="type">char</span> *<i>function</i>, <span class="type"><a href="./qlist.htm" translate="no">QList</a></span>&lt;<span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span>&gt; &amp;<i>vars</i>)<a class="plink" href="#dynamicCall-1" title="Direct link to this headline"></a></h3>
<p>This is an overloaded function.</p>
<p>Calls the COM object's method <i translate="no">function</i>, passing the parameters in <i translate="no">vars</i>, and returns the value returned by the method. If the method does not return a value or when the function call failed this function returns an invalid <a href="./qvariant.htm" translate="no">QVariant</a> object.</p>
<p>The <a href="./qvariant.htm" translate="no">QVariant</a> objects in <i translate="no">vars</i> are updated when the method has out-parameters.</p>
<!-- @@@dynamicCall -->
<!-- $$$generateDocumentation[overload1]$$$generateDocumentation -->
<h3 class="fn" id="generateDocumentation" translate="no"><a name="generateDocumentation"></a><span class="type"><a href="./qstring.htm" translate="no">QString</a></span> QAxBase::<span class="name">generateDocumentation</span>()<a class="plink" href="#generateDocumentation" title="Direct link to this headline"></a></h3>
<p>Returns a rich text string with documentation for the wrapped COM object. Dump the string to an HTML-file, or use it in e.g. a <a href="./qtextbrowser.htm" translate="no">QTextBrowser</a> widget.</p>
<!-- @@@generateDocumentation -->
<!-- $$$initialize[overload1]$$$initializeIUnknown** -->
<h3 class="fn" id="initialize" translate="no"><a name="initialize"></a><code translate="no">[virtual protected] </code><span class="type">bool</span> QAxBase::<span class="name">initialize</span>(<span class="type">IUnknown</span> **<i>ptr</i>)<a class="plink" href="#initialize" title="Direct link to this headline"></a></h3>
<p>This virtual function is called by <a href="./qaxbase.htm#control-prop" translate="no">setControl</a>() and creates the requested COM object. <i translate="no">ptr</i> is set to the object's IUnknown implementation. The function returns true if the object initialization succeeded; otherwise the function returns false.</p>
<p>The default implementation interprets the string returned by <a href="./qaxbase.htm#control-prop" translate="no">control</a>(), and calls <a href="./qaxbase.htm#initializeRemote" translate="no">initializeRemote</a>(), <a href="./qaxbase.htm#initializeLicensed" translate="no">initializeLicensed</a>() or <a href="./qaxbase.htm#initializeActive" translate="no">initializeActive</a>() if the string matches the respective patterns. If <a href="./qaxbase.htm#control-prop" translate="no">control</a>() is the name of an existing file, <a href="./qaxbase.htm#initializeFromFile" translate="no">initializeFromFile</a>() is called. If no pattern is matched, or if remote or licensed initialization fails, CoCreateInstance is used directly to create the object.</p>
<p>See the <a href="./qaxbase.htm#control-prop" translate="no">control</a> property documentation for details about supported patterns.</p>
<p>The interface returned in <i translate="no">ptr</i> must be referenced exactly once when this function returns. The interface provided by e.g. CoCreateInstance is already referenced, and there is no need to reference it again.</p>
<!-- @@@initialize -->
<!-- $$$initializeActive[overload1]$$$initializeActiveIUnknown** -->
<h3 class="fn" id="initializeActive" translate="no"><a name="initializeActive"></a><code translate="no">[protected] </code><span class="type">bool</span> QAxBase::<span class="name">initializeActive</span>(<span class="type">IUnknown</span> **<i>ptr</i>)<a class="plink" href="#initializeActive" title="Direct link to this headline"></a></h3>
<p>Connects to an active instance running on the current machine, and returns the IUnknown interface to the running object in <i translate="no">ptr</i>. This function returns true if successful, otherwise returns false.</p>
<p>This function is called by <a href="./qaxbase.htm#initialize" translate="no">initialize</a>() if the control string contains the substring "}&amp;".</p>
<p><b>See also </b><a href="./qaxbase.htm#initialize" translate="no">initialize</a>().</p>
<!-- @@@initializeActive -->
<!-- $$$initializeFromFile[overload1]$$$initializeFromFileIUnknown** -->
<h3 class="fn" id="initializeFromFile" translate="no"><a name="initializeFromFile"></a><code translate="no">[protected] </code><span class="type">bool</span> QAxBase::<span class="name">initializeFromFile</span>(<span class="type">IUnknown</span> **<i>ptr</i>)<a class="plink" href="#initializeFromFile" title="Direct link to this headline"></a></h3>
<p>Creates the COM object handling the filename in the control property, and returns the IUnknown interface to the object in <i translate="no">ptr</i>. This function returns true if successful, otherwise returns false.</p>
<p>This function is called by <a href="./qaxbase.htm#initialize" translate="no">initialize</a>() if the control string is the name of an existing file.</p>
<p><b>See also </b><a href="./qaxbase.htm#initialize" translate="no">initialize</a>().</p>
<!-- @@@initializeFromFile -->
<!-- $$$initializeLicensed[overload1]$$$initializeLicensedIUnknown** -->
<h3 class="fn" id="initializeLicensed" translate="no"><a name="initializeLicensed"></a><code translate="no">[protected] </code><span class="type">bool</span> QAxBase::<span class="name">initializeLicensed</span>(<span class="type">IUnknown</span> **<i>ptr</i>)<a class="plink" href="#initializeLicensed" title="Direct link to this headline"></a></h3>
<p>Creates an instance of a licensed control, and returns the IUnknown interface to the object in <i translate="no">ptr</i>. This functions returns true if successful, otherwise returns false.</p>
<p>This function is called by <a href="./qaxbase.htm#initialize" translate="no">initialize</a>() if the control string contains the substring "}:". The license key needs to follow this substring.</p>
<p><b>See also </b><a href="./qaxbase.htm#initialize" translate="no">initialize</a>().</p>
<!-- @@@initializeLicensed -->
<!-- $$$initializeRemote[overload1]$$$initializeRemoteIUnknown** -->
<h3 class="fn" id="initializeRemote" translate="no"><a name="initializeRemote"></a><code translate="no">[protected] </code><span class="type">bool</span> QAxBase::<span class="name">initializeRemote</span>(<span class="type">IUnknown</span> **<i>ptr</i>)<a class="plink" href="#initializeRemote" title="Direct link to this headline"></a></h3>
<p>Creates the instance on a remote server, and returns the IUnknown interface to the object in <i translate="no">ptr</i>. This function returns true if successful, otherwise returns false.</p>
<p>This function is called by <a href="./qaxbase.htm#initialize" translate="no">initialize</a>() if the control string contains the substring "/{". The information about the remote machine needs to be provided in front of the substring.</p>
<p><b>See also </b><a href="./qaxbase.htm#initialize" translate="no">initialize</a>().</p>
<!-- @@@initializeRemote -->
<!-- $$$isNull[overload1]$$$isNull -->
<h3 class="fn" id="isNull" translate="no"><a name="isNull"></a><span class="type">bool</span> QAxBase::<span class="name">isNull</span>() const<a class="plink" href="#isNull" title="Direct link to this headline"></a></h3>
<p>Returns true if there is no COM object loaded by this wrapper; otherwise return false.</p>
<p><b>See also </b><a href="./qaxbase.htm#control-prop" translate="no">control</a>.</p>
<!-- @@@isNull -->
<!-- $$$propertyBag[overload1]$$$propertyBag -->
<h3 class="fn" id="propertyBag" translate="no"><a name="propertyBag"></a><span class="type">QAxBase::PropertyBag</span> QAxBase::<span class="name">propertyBag</span>() const<a class="plink" href="#propertyBag" title="Direct link to this headline"></a></h3>
<p>Returns a name:value map of all the properties exposed by the COM object.</p>
<p>This is more efficient than getting multiple properties individually if the COM object supports property bags.</p>
<div class="admonition warning">
<p><b>Warning: </b>It is not guaranteed that the property bag implementation of the COM object returns all properties, or that the properties returned are the same as those available through the IDispatch interface.</p>
</div>
<p><b>See also </b><a href="./qaxbase.htm#setPropertyBag" translate="no">setPropertyBag</a>().</p>
<!-- @@@propertyBag -->
<!-- $$$propertyWritable[overload1]$$$propertyWritableconstchar* -->
<h3 class="fn" id="propertyWritable" translate="no"><a name="propertyWritable"></a><code translate="no">[virtual] </code><span class="type">bool</span> QAxBase::<span class="name">propertyWritable</span>(const <span class="type">char</span> *<i>prop</i>) const<a class="plink" href="#propertyWritable" title="Direct link to this headline"></a></h3>
<p>Returns true if the property <i translate="no">prop</i> is writable; otherwise returns false. By default, all properties are writable.</p>
<div class="admonition warning">
<p><b>Warning: </b>Depending on the control implementation this setting might be ignored for some properties.</p>
</div>
<p><b>See also </b><a href="./qaxbase.htm#setPropertyWritable" translate="no">setPropertyWritable</a>() and <a href="./qaxbase.htm#propertyChanged" translate="no">propertyChanged</a>().</p>
<!-- @@@propertyWritable -->
<!-- $$$queryInterface[overload1]$$$queryInterfaceconstQUuid&void** -->
<h3 class="fn" id="queryInterface" translate="no"><a name="queryInterface"></a><span class="type">long</span> QAxBase::<span class="name">queryInterface</span>(const <span class="type"><a href="./quuid.htm" translate="no">QUuid</a></span> &amp;<i>uuid</i>, <span class="type">void</span> **<i>iface</i>) const<a class="plink" href="#queryInterface" title="Direct link to this headline"></a></h3>
<p>Requests the interface <i translate="no">uuid</i> from the COM object and sets the value of <i translate="no">iface</i> to the provided interface, or to 0 if the requested interface could not be provided.</p>
<p>Returns the result of the QueryInterface implementation of the COM object.</p>
<p><b>See also </b><a href="./qaxbase.htm#control-prop" translate="no">control</a>.</p>
<!-- @@@queryInterface -->
<!-- $$$querySubObject[overload1]$$$querySubObjectconstchar*constQVariant&constQVariant&constQVariant&constQVariant&constQVariant&constQVariant&constQVariant&constQVariant& -->
<h3 class="fn" id="querySubObject" translate="no"><a name="querySubObject"></a><span class="type"><a href="./qaxobject.htm" translate="no">QAxObject</a></span> *QAxBase::<span class="name">querySubObject</span>(const <span class="type">char</span> *<i>name</i>, const <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> &amp;<i>var1</i> = QVariant(), const <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> &amp;<i>var2</i> = QVariant(), const <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> &amp;<i>var3</i> = QVariant(), const <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> &amp;<i>var4</i> = QVariant(), const <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> &amp;<i>var5</i> = QVariant(), const <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> &amp;<i>var6</i> = QVariant(), const <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> &amp;<i>var7</i> = QVariant(), const <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> &amp;<i>var8</i> = QVariant())<a class="plink" href="#querySubObject" title="Direct link to this headline"></a></h3>
<p>Returns a pointer to a <a href="./qaxobject.htm" translate="no">QAxObject</a> wrapping the COM object provided by the method or property <i translate="no">name</i>, passing passing the parameters <i translate="no">var1</i>, <i translate="no">var1</i>, <i translate="no">var2</i>, <i translate="no">var3</i>, <i translate="no">var4</i>, <i translate="no">var5</i>, <i translate="no">var6</i>, <i translate="no">var7</i> and <i translate="no">var8</i>.</p>
<p>If <i translate="no">name</i> is provided by a method the string must include the full function prototype.</p>
<p>If <i translate="no">name</i> is a property the string must be the name of the property, and <i translate="no">var1</i>, ... <i translate="no">var8</i> are ignored.</p>
<p>The returned <a href="./qaxobject.htm" translate="no">QAxObject</a> is a child of this object (which is either of type <a href="./qaxobject.htm" translate="no">QAxObject</a> or <a href="./qaxwidget.htm" translate="no">QAxWidget</a>), and is deleted when this object is deleted. It is however safe to delete the returned object yourself, and you should do so when you iterate over lists of subobjects.</p>
<p>COM enabled applications usually have an object model publishing certain elements of the application as dispatch interfaces. Use this method to navigate the hierarchy of the object model, e.g.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type"><a href="./qaxwidget.htm" translate="no">QAxWidget</a></span> outlook(<span class="string">"Outlook.Application"</span>);
<span class="type"><a href="./qaxobject.htm" translate="no">QAxObject</a></span> <span class="operator">*</span>session <span class="operator">=</span> outlook<span class="operator">.</span>querySubObject(<span class="string">"Session"</span>);
<span class="keyword">if</span> (session) {
    <span class="type"><a href="./qaxobject.htm" translate="no">QAxObject</a></span> <span class="operator">*</span>defFolder <span class="operator">=</span> session<span class="operator">-</span><span class="operator">&gt;</span>querySubObject(
                            <span class="string">"GetDefaultFolder(OlDefaultFolders)"</span><span class="operator">,</span>
                            <span class="string">"olFolderContacts"</span>);
    <span class="comment">//...</span>
}</pre></div>
<!-- @@@querySubObject -->
<!-- $$$querySubObject$$$querySubObjectconstchar*QList<QVariant>& -->
<h3 class="fn" id="querySubObject-1" translate="no"><a name="querySubObject-1"></a><span class="type"><a href="./qaxobject.htm" translate="no">QAxObject</a></span> *QAxBase::<span class="name">querySubObject</span>(const <span class="type">char</span> *<i>name</i>, <span class="type"><a href="./qlist.htm" translate="no">QList</a></span>&lt;<span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span>&gt; &amp;<i>vars</i>)<a class="plink" href="#querySubObject-1" title="Direct link to this headline"></a></h3>
<p>This is an overloaded function.</p>
<p>The <a href="./qvariant.htm" translate="no">QVariant</a> objects in <i translate="no">vars</i> are updated when the method has out-parameters.</p>
<!-- @@@querySubObject -->
<!-- $$$setClassContext[overload1]$$$setClassContextunsignedlong -->
<h3 class="fn" id="setClassContext" translate="no"><a name="setClassContext"></a><span class="type">void</span> QAxBase::<span class="name">setClassContext</span>(<span class="type">unsigned</span> <span class="type">long</span> <i>classContext</i>)<a class="plink" href="#setClassContext" title="Direct link to this headline"></a></h3>
<p>Sets the context the ActiveX control will run in to <i translate="no">classContext</i></p>
<p>Affects the "dwClsContext" argument when calling CoCreateInstance. This can be used to control in-proc vs. out-of-proc startup for controls supporting both alternatives. Also, it can be used to modify/reduce control permissions when used with CLSCTX_ENABLE_CLOAKING and an impersonation token.</p>
<p>Note that this function must be called before <a href="./qaxbase.htm#control-prop" translate="no">setControl</a>() to have any effect.</p>
<p>This function was introduced in Qt 5.13.</p>
<p><b>See also </b><a href="./qaxbase.htm#classContext" translate="no">classContext</a>().</p>
<!-- @@@setClassContext -->
<!-- $$$setPropertyBag[overload1]$$$setPropertyBagconstQAxBase::PropertyBag& -->
<h3 class="fn" id="setPropertyBag" translate="no"><a name="setPropertyBag"></a><span class="type">void</span> QAxBase::<span class="name">setPropertyBag</span>(const <span class="type">QAxBase::PropertyBag</span> &amp;<i>bag</i>)<a class="plink" href="#setPropertyBag" title="Direct link to this headline"></a></h3>
<p>Sets the properties of the COM object to the corresponding values in <i translate="no">bag</i>.</p>
<div class="admonition warning">
<p><b>Warning: </b>You should only set property bags that have been returned by the <a href="./qaxbase.htm#propertyBag" translate="no">propertyBag</a> function, as it cannot be guaranteed that the property bag implementation of the COM object supports the same properties that are available through the IDispatch interface.</p>
</div>
<p><b>See also </b><a href="./qaxbase.htm#propertyBag" translate="no">propertyBag</a>().</p>
<!-- @@@setPropertyBag -->
<!-- $$$setPropertyWritable[overload1]$$$setPropertyWritableconstchar*bool -->
<h3 class="fn" id="setPropertyWritable" translate="no"><a name="setPropertyWritable"></a><code translate="no">[virtual] </code><span class="type">void</span> QAxBase::<span class="name">setPropertyWritable</span>(const <span class="type">char</span> *<i>prop</i>, <span class="type">bool</span> <i>ok</i>)<a class="plink" href="#setPropertyWritable" title="Direct link to this headline"></a></h3>
<p>Sets the property <i translate="no">prop</i> to writable if <i translate="no">ok</i> is true, otherwise sets <i translate="no">prop</i> to be read-only. By default, all properties are writable.</p>
<div class="admonition warning">
<p><b>Warning: </b>Depending on the control implementation this setting might be ignored for some properties.</p>
</div>
<p><b>See also </b><a href="./qaxbase.htm#propertyWritable" translate="no">propertyWritable</a>() and <a href="./qaxbase.htm#propertyChanged" translate="no">propertyChanged</a>().</p>
<!-- @@@setPropertyWritable -->
<!-- $$$verbs[overload1]$$$verbs -->
<h3 class="fn" id="verbs" translate="no"><a name="verbs"></a><span class="type"><a href="./qstringlist.htm" translate="no">QStringList</a></span> QAxBase::<span class="name">verbs</span>() const<a class="plink" href="#verbs" title="Direct link to this headline"></a></h3>
<p>Returns the list of verbs that the COM object can execute. If the object does not implement IOleObject, or does not support any verbs, then this function returns an empty stringlist.</p>
<p>Note that the OLE default verbs (OLEIVERB_SHOW etc) are not included in the list.</p>
<p>This function was introduced in Qt 4.1.</p>
<!-- @@@verbs -->
</div>
</div>
<p class="copy-notice">
<acronym title="Copyright"></acronym> 2025 The Qt Company Ltd.
   Documentation contributions included herein are the copyrights of
   their respective owners.     The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the Free Software Foundation.     Qt and respective logos are <a href="https://doc.qt.io/qt/trademarks.html">    trademarks</a> of The Qt Company Ltd. in Finland and/or other countries
   worldwide. All other trademarks are property of their respective owners. </p>

                    </div>
                </article>
                
            </div>
        </div>
    </div>
</div>
</body></html>