<html lang="en"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Address Book Example | Qt Widgets</title>
<link rel="canonical" href="https://doc.qt.io/qt-6/qtwidgets-itemviews-addressbook-example.html">
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <!-- Google Tag Manager -->
    
  <!-- End Google Tag Manager -->
  
  
</head>
<body class="qt-design-system" style="background:var(--content-bg-color)" onload="prettyPrint()">

<div data-global-resource-path="qt-design-system/components/b-sidebar.html">
    <div class="b-sidebar b-sidebar--full-width">
        
        <div class="b-sidebar__content">
            <div class="b-sidebar__topbar" data-margin-bottom="sm">
                <div class="b-topbar">
                                        <div class="b-topbar__breadcrump" translate="no">
                        <ul class="c-breadcrump">
                            <li><a href="./index.htm" translate="no">Qt 5.15</a></li>
                            <li><a href="./qtwidgets-index.htm" translate="no">Qt Widgets</a></li>
                            <li><a href="./examples-itemviews.htm" translate="no">Item Views Examples</a></li>
                            <li><a>Address Book Example</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="b-sidebar__content__wrapper">
                <article class="b-sidebar__content__left">
                    <div class="context mainContent" style="margin: 0;padding: 0; background: 0;">
                    

<div class="context">
<h1 class="title">Address Book Example</h1>
<span class="subtitle"></span>
<!-- $$$itemviews/addressbook-brief -->
<p>The address book example shows how to use proxy models to display different views onto data from a single model.</p>
<!-- @@@itemviews/addressbook -->
<!-- $$$itemviews/addressbook-description -->
<div class="descr"> <a name="details"></a>
<p class="centerAlign"><img alt="Screenshot of the Address Book example" src="./images/addressbook-example.png"></p><p>This example provides an address book that allows contacts to be grouped alphabetically into 9 groups: ABC, DEF, GHI, ... , VW, ..., XYZ. This is achieved by using multiple views on the same model, each of which is filtered using an instance of the <a href="./qsortfilterproxymodel.htm" translate="no">QSortFilterProxyModel</a> class.</p>
<a name="overview"></a>
<h4 id="overview">Overview<a class="plink" href="#overview" title="Direct link to this headline"></a></h4>
<p>The address book contains 5 classes: <code translate="no">MainWindow</code>, <code translate="no">AddressWidget</code>, <code translate="no">TableModel</code>, <code translate="no">NewAddressTab</code> and <code translate="no">AddDialog</code>. The <code translate="no">MainWindow</code> class uses <code translate="no">AddressWidget</code> as its central widget and provides <b translate="no">File</b> and <b translate="no">Tools</b> menus.</p>
<p class="centerAlign"><img alt="Diagram for Address Book Example" src="./images/addressbook-classes.png"></p><p>The <code translate="no">AddressWidget</code> class is a <a href="./qtabwidget.htm" translate="no">QTabWidget</a> subclass that is used to manipulate the 10 tabs displayed in the example: the 9 alphabet group tabs and an instance of <code translate="no">NewAddressTab</code>. The <code translate="no">NewAddressTab</code> class is a subclass of <a href="./qwidget.htm" translate="no">QWidget</a> that is only used whenever the address book is empty, prompting the user to add some contacts. <code translate="no">AddressWidget</code> also interacts with an instance of <code translate="no">TableModel</code> to add, edit and remove entries to the address book.</p>
<p><code translate="no">TableModel</code> is a subclass of <a href="./qabstracttablemodel.htm" translate="no">QAbstractTableModel</a> that provides the standard model/view API to access data. It holds a list of added contacts. However, this data is not all visible in a single tab. Instead, <a href="./qtableview.htm" translate="no">QTableView</a> is used to provide 9 different views of the same data, according to the alphabet groups.</p>
<p><a href="./qsortfilterproxymodel.htm" translate="no">QSortFilterProxyModel</a> is the class responsible for filtering the contacts for each group of contacts. Each proxy model uses a <a href="./qregexp.htm" translate="no">QRegExp</a> to filter out contacts that do not belong in the corresponding alphabetical group. The <code translate="no">AddDialog</code> class is used to obtain information from the user for the address book. This <a href="./qdialog.htm" translate="no">QDialog</a> subclass is instantiated by <code translate="no">NewAddressTab</code> to add contacts, and by <code translate="no">AddressWidget</code> to add and edit contacts.</p>
<p>We begin by looking at the <code translate="no">TableModel</code> implementation.</p>
<a name="tablemodel-class-definition"></a>
<h4 id="tablemodel-class-definition">TableModel Class Definition<a class="plink" href="#tablemodel-class-definition" title="Direct link to this headline"></a></h4>
<p>The <code translate="no">TableModel</code> class provides standard API to access data in its list of contacts by subclassing <a href="./qabstracttablemodel.htm" translate="no">QAbstractTableModel</a>. The basic functions that must be implemented in order to do so are: <code translate="no">rowCount()</code>, <code translate="no">columnCount()</code>, <code translate="no">data()</code>, <code translate="no">headerData()</code>. For TableModel to be editable, it has to provide implementations <code translate="no">insertRows()</code>, <code translate="no">removeRows()</code>, <code translate="no">setData()</code> and <code translate="no">flags()</code> functions.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="keyword">struct</span> Contact
{
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> name;
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> address;

    bool <span class="keyword">operator</span><span class="operator">=</span><span class="operator">=</span>(<span class="keyword">const</span> Contact <span class="operator">&amp;</span>other) <span class="keyword">const</span>
    {
        <span class="keyword">return</span> name <span class="operator">=</span><span class="operator">=</span> other<span class="operator">.</span>name <span class="operator">&amp;</span><span class="operator">&amp;</span> address <span class="operator">=</span><span class="operator">=</span> other<span class="operator">.</span>address;
    }
};

<span class="keyword">inline</span> <span class="type"><a href="./qdatastream.htm" translate="no">QDataStream</a></span> <span class="operator">&amp;</span><span class="keyword">operator</span><span class="operator">&lt;</span><span class="operator">&lt;</span>(<span class="type"><a href="./qdatastream.htm" translate="no">QDataStream</a></span> <span class="operator">&amp;</span>stream<span class="operator">,</span> <span class="keyword">const</span> Contact <span class="operator">&amp;</span>contact)
{
    <span class="keyword">return</span> stream <span class="operator">&lt;</span><span class="operator">&lt;</span> contact<span class="operator">.</span>name <span class="operator">&lt;</span><span class="operator">&lt;</span> contact<span class="operator">.</span>address;
}

<span class="keyword">inline</span> <span class="type"><a href="./qdatastream.htm" translate="no">QDataStream</a></span> <span class="operator">&amp;</span><span class="keyword">operator</span><span class="operator">&gt;</span><span class="operator">&gt;</span>(<span class="type"><a href="./qdatastream.htm" translate="no">QDataStream</a></span> <span class="operator">&amp;</span>stream<span class="operator">,</span> Contact <span class="operator">&amp;</span>contact)
{
    <span class="keyword">return</span> stream <span class="operator">&gt;</span><span class="operator">&gt;</span> contact<span class="operator">.</span>name <span class="operator">&gt;</span><span class="operator">&gt;</span> contact<span class="operator">.</span>address;
}

<span class="keyword">class</span> TableModel : <span class="keyword">public</span> <span class="type"><a href="./qabstracttablemodel.htm" translate="no">QAbstractTableModel</a></span>
{
    Q_OBJECT

<span class="keyword">public</span>:
    TableModel(<span class="type"><a href="./qobject.htm" translate="no">QObject</a></span> <span class="operator">*</span>parent <span class="operator">=</span> nullptr);
    TableModel(<span class="keyword">const</span> <span class="type"><a href="./qvector.htm" translate="no">QVector</a></span><span class="operator">&lt;</span>Contact<span class="operator">&gt;</span> <span class="operator">&amp;</span>contacts<span class="operator">,</span> <span class="type"><a href="./qobject.htm" translate="no">QObject</a></span> <span class="operator">*</span>parent <span class="operator">=</span> nullptr);

    <span class="type">int</span> rowCount(<span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>parent) <span class="keyword">const</span> override;
    <span class="type">int</span> columnCount(<span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>parent) <span class="keyword">const</span> override;
    <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> data(<span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>index<span class="operator">,</span> <span class="type">int</span> role) <span class="keyword">const</span> override;
    <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> headerData(<span class="type">int</span> section<span class="operator">,</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>Orientation orientation<span class="operator">,</span> <span class="type">int</span> role) <span class="keyword">const</span> override;
    <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>ItemFlags flags(<span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>index) <span class="keyword">const</span> override;
    bool setData(<span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>index<span class="operator">,</span> <span class="keyword">const</span> <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> <span class="operator">&amp;</span>value<span class="operator">,</span> <span class="type">int</span> role <span class="operator">=</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>EditRole) override;
    bool insertRows(<span class="type">int</span> position<span class="operator">,</span> <span class="type">int</span> rows<span class="operator">,</span> <span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>index <span class="operator">=</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span>()) override;
    bool removeRows(<span class="type">int</span> position<span class="operator">,</span> <span class="type">int</span> rows<span class="operator">,</span> <span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>index <span class="operator">=</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span>()) override;
    <span class="keyword">const</span> <span class="type"><a href="./qvector.htm" translate="no">QVector</a></span><span class="operator">&lt;</span>Contact<span class="operator">&gt;</span> <span class="operator">&amp;</span>getContacts() <span class="keyword">const</span>;

<span class="keyword">private</span>:
    <span class="type"><a href="./qvector.htm" translate="no">QVector</a></span><span class="operator">&lt;</span>Contact<span class="operator">&gt;</span> contacts;
};</pre></div>
<p>Two constructors are used, a default constructor which uses <code translate="no">TableModel</code>'s own <code translate="no">QVector&lt;Contact&gt;</code> and one that takes <code translate="no">QVector&lt;Contact&gt;</code> as an argument, for convenience.</p>
<a name="tablemodel-class-implementation"></a>
<h4 id="tablemodel-class-implementation">TableModel Class Implementation<a class="plink" href="#tablemodel-class-implementation" title="Direct link to this headline"></a></h4>
<p>We implement the two constructors as defined in the header file. The second constructor initializes the list of contacts in the model, with the parameter value.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">TableModel<span class="operator">::</span>TableModel(<span class="type"><a href="./qobject.htm" translate="no">QObject</a></span> <span class="operator">*</span>parent)
    : <span class="type"><a href="./qabstracttablemodel.htm" translate="no">QAbstractTableModel</a></span>(parent)
{
}

TableModel<span class="operator">::</span>TableModel(<span class="keyword">const</span> <span class="type"><a href="./qvector.htm" translate="no">QVector</a></span><span class="operator">&lt;</span>Contact<span class="operator">&gt;</span> <span class="operator">&amp;</span>contacts<span class="operator">,</span> <span class="type"><a href="./qobject.htm" translate="no">QObject</a></span> <span class="operator">*</span>parent)
    : <span class="type"><a href="./qabstracttablemodel.htm" translate="no">QAbstractTableModel</a></span>(parent)<span class="operator">,</span>
      contacts(contacts)
{
}</pre></div>
<p>The <code translate="no">rowCount()</code> and <code translate="no">columnCount()</code> functions return the dimensions of the model. Whereas, <code translate="no">rowCount()</code>'s value will vary depending on the number of contacts added to the address book, <code translate="no">columnCount()</code>'s value is always 2 because we only need space for the <b>Name</b> and <b>Address</b> columns.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">int</span> TableModel<span class="operator">::</span>rowCount(<span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>parent) <span class="keyword">const</span>
{
    <span class="keyword">return</span> parent<span class="operator">.</span>isValid() <span class="operator">?</span> <span class="number">0</span> : contacts<span class="operator">.</span>size();
}

<span class="type">int</span> TableModel<span class="operator">::</span>columnCount(<span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>parent) <span class="keyword">const</span>
{
    <span class="keyword">return</span> parent<span class="operator">.</span>isValid() <span class="operator">?</span> <span class="number">0</span> : <span class="number">2</span>;
}</pre></div>
<p>The <code translate="no">data()</code> function returns either a <b>Name</b> or <b>Address</b>, based on the contents of the model index supplied. The row number stored in the model index is used to reference an item in the list of contacts. Selection is handled by the <a href="./qitemselectionmodel.htm" translate="no">QItemSelectionModel</a>, which will be explained with <code translate="no">AddressWidget</code>.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> TableModel<span class="operator">::</span>data(<span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>index<span class="operator">,</span> <span class="type">int</span> role) <span class="keyword">const</span>
{
    <span class="keyword">if</span> (<span class="operator">!</span>index<span class="operator">.</span>isValid())
        <span class="keyword">return</span> <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span>();

    <span class="keyword">if</span> (index<span class="operator">.</span>row() <span class="operator">&gt;</span><span class="operator">=</span> contacts<span class="operator">.</span>size() <span class="operator">|</span><span class="operator">|</span> index<span class="operator">.</span>row() <span class="operator">&lt;</span> <span class="number">0</span>)
        <span class="keyword">return</span> <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span>();

    <span class="keyword">if</span> (role <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>DisplayRole) {
        <span class="keyword">const</span> <span class="keyword">auto</span> <span class="operator">&amp;</span>contact <span class="operator">=</span> contacts<span class="operator">.</span>at(index<span class="operator">.</span>row());

        <span class="keyword">switch</span> (index<span class="operator">.</span>column()) {
            <span class="keyword">case</span> <span class="number">0</span>:
                <span class="keyword">return</span> contact<span class="operator">.</span>name;
            <span class="keyword">case</span> <span class="number">1</span>:
                <span class="keyword">return</span> contact<span class="operator">.</span>address;
            <span class="keyword">default</span>:
                <span class="keyword">break</span>;
        }
    }
    <span class="keyword">return</span> <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span>();
}</pre></div>
<p>The <code translate="no">headerData()</code> function displays the table's header, <b>Name</b> and <b>Address</b>. If you require numbered entries for your address book, you can use a vertical header which we have hidden in this example (see the <code translate="no">AddressWidget</code> implementation).</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> TableModel<span class="operator">::</span>headerData(<span class="type">int</span> section<span class="operator">,</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>Orientation orientation<span class="operator">,</span> <span class="type">int</span> role) <span class="keyword">const</span>
{
    <span class="keyword">if</span> (role <span class="operator">!</span><span class="operator">=</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>DisplayRole)
        <span class="keyword">return</span> <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span>();

    <span class="keyword">if</span> (orientation <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>Horizontal) {
        <span class="keyword">switch</span> (section) {
            <span class="keyword">case</span> <span class="number">0</span>:
                <span class="keyword">return</span> tr(<span class="string">"Name"</span>);
            <span class="keyword">case</span> <span class="number">1</span>:
                <span class="keyword">return</span> tr(<span class="string">"Address"</span>);
            <span class="keyword">default</span>:
                <span class="keyword">break</span>;
        }
    }
    <span class="keyword">return</span> <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span>();
}</pre></div>
<p>The <code translate="no">insertRows()</code> function is called before new data is added, otherwise the data will not be displayed. The <code translate="no">beginInsertRows()</code> and <code translate="no">endInsertRows()</code> functions are called to ensure all connected views are aware of the changes.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">bool TableModel<span class="operator">::</span>insertRows(<span class="type">int</span> position<span class="operator">,</span> <span class="type">int</span> rows<span class="operator">,</span> <span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>index)
{
    Q_UNUSED(index);
    beginInsertRows(<span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span>()<span class="operator">,</span> position<span class="operator">,</span> position <span class="operator">+</span> rows <span class="operator">-</span> <span class="number">1</span>);

    <span class="keyword">for</span> (<span class="type">int</span> row <span class="operator">=</span> <span class="number">0</span>; row <span class="operator">&lt;</span> rows; <span class="operator">+</span><span class="operator">+</span>row)
        contacts<span class="operator">.</span>insert(position<span class="operator">,</span> { <span class="type"><a href="./qstring.htm" translate="no">QString</a></span>()<span class="operator">,</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span>() });

    endInsertRows();
    <span class="keyword">return</span> <span class="keyword">true</span>;
}</pre></div>
<p>The <code translate="no">removeRows()</code> function is called to remove data. Again, <a href="./qabstractitemmodel.htm#beginRemoveRows" translate="no">beginRemoveRows()</a> and <a href="./qabstractitemmodel.htm#endRemoveRows" translate="no">endRemoveRows()</a> are called to ensure all connected views are aware of the changes.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">bool TableModel<span class="operator">::</span>removeRows(<span class="type">int</span> position<span class="operator">,</span> <span class="type">int</span> rows<span class="operator">,</span> <span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>index)
{
    Q_UNUSED(index);
    beginRemoveRows(<span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span>()<span class="operator">,</span> position<span class="operator">,</span> position <span class="operator">+</span> rows <span class="operator">-</span> <span class="number">1</span>);

    <span class="keyword">for</span> (<span class="type">int</span> row <span class="operator">=</span> <span class="number">0</span>; row <span class="operator">&lt;</span> rows; <span class="operator">+</span><span class="operator">+</span>row)
        contacts<span class="operator">.</span>removeAt(position);

    endRemoveRows();
    <span class="keyword">return</span> <span class="keyword">true</span>;
}</pre></div>
<p>The <code translate="no">setData()</code> function is the function that inserts data into the table, item by item and not row by row. This means that to fill a row in the address book, <code translate="no">setData()</code> must be called twice, as each row has 2 columns. It is important to emit the <a href="./qabstractitemmodel.htm#dataChanged" translate="no">dataChanged()</a> signal as it tells all connected views to update their displays.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">bool TableModel<span class="operator">::</span>setData(<span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>index<span class="operator">,</span> <span class="keyword">const</span> <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> <span class="operator">&amp;</span>value<span class="operator">,</span> <span class="type">int</span> role)
{
    <span class="keyword">if</span> (index<span class="operator">.</span>isValid() <span class="operator">&amp;</span><span class="operator">&amp;</span> role <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>EditRole) {
        <span class="keyword">const</span> <span class="type">int</span> row <span class="operator">=</span> index<span class="operator">.</span>row();
        <span class="keyword">auto</span> contact <span class="operator">=</span> contacts<span class="operator">.</span>value(row);

        <span class="keyword">switch</span> (index<span class="operator">.</span>column()) {
            <span class="keyword">case</span> <span class="number">0</span>:
                contact<span class="operator">.</span>name <span class="operator">=</span> value<span class="operator">.</span>toString();
                <span class="keyword">break</span>;
            <span class="keyword">case</span> <span class="number">1</span>:
                contact<span class="operator">.</span>address <span class="operator">=</span> value<span class="operator">.</span>toString();
                <span class="keyword">break</span>;
            <span class="keyword">default</span>:
                <span class="keyword">return</span> <span class="keyword">false</span>;
        }
        contacts<span class="operator">.</span>replace(row<span class="operator">,</span> contact);
        <span class="keyword">emit</span> dataChanged(index<span class="operator">,</span> index<span class="operator">,</span> {<span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>DisplayRole<span class="operator">,</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>EditRole});

        <span class="keyword">return</span> <span class="keyword">true</span>;
    }

    <span class="keyword">return</span> <span class="keyword">false</span>;
}</pre></div>
<p>The <code translate="no">flags()</code> function returns the item flags for the given index.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>ItemFlags TableModel<span class="operator">::</span>flags(<span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>index) <span class="keyword">const</span>
{
    <span class="keyword">if</span> (<span class="operator">!</span>index<span class="operator">.</span>isValid())
        <span class="keyword">return</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>ItemIsEnabled;

    <span class="keyword">return</span> <span class="type"><a href="./qabstracttablemodel.htm" translate="no">QAbstractTableModel</a></span><span class="operator">::</span>flags(index) <span class="operator">|</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>ItemIsEditable;
}</pre></div>
<p>We set the <a href="./qt.htm#ItemFlag-enum" translate="no">Qt::ItemIsEditable</a> flag because we want to allow the <code translate="no">TableModel</code> to be edited. Although for this example we don't use the editing features of the <a href="./qtableview.htm" translate="no">QTableView</a> object, we enable them here so that we can reuse the model in other programs.</p>
<p>The last function in <code translate="no">TableModel</code>, <code translate="no">getContacts()</code> returns the <a href="./qvector.htm" translate="no">QVector</a>&lt;Contact&gt; object that holds all the contacts in the address book. We use this function later to obtain the list of contacts to check for existing entries, write the contacts to a file and read them back. Further explanation is given with <code translate="no">AddressWidget</code>.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="keyword">const</span> <span class="type"><a href="./qvector.htm" translate="no">QVector</a></span><span class="operator">&lt;</span>Contact<span class="operator">&gt;</span> <span class="operator">&amp;</span>TableModel<span class="operator">::</span>getContacts() <span class="keyword">const</span>
{
    <span class="keyword">return</span> contacts;
}</pre></div>
<a name="addresswidget-class-definition"></a>
<h4 id="addresswidget-class-definition">AddressWidget Class Definition<a class="plink" href="#addresswidget-class-definition" title="Direct link to this headline"></a></h4>
<p>The <code translate="no">AddressWidget</code> class is technically the main class involved in this example as it provides functions to add, edit and remove contacts, to save the contacts to a file and to load them from a file.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="keyword">class</span> AddressWidget : <span class="keyword">public</span> <span class="type"><a href="./qtabwidget.htm" translate="no">QTabWidget</a></span>
{
    Q_OBJECT

<span class="keyword">public</span>:
    AddressWidget(<span class="type"><a href="./qwidget.htm" translate="no">QWidget</a></span> <span class="operator">*</span>parent <span class="operator">=</span> nullptr);
    <span class="type">void</span> readFromFile(<span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> <span class="operator">&amp;</span>fileName);
    <span class="type">void</span> writeToFile(<span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> <span class="operator">&amp;</span>fileName);

<span class="keyword">public</span> <span class="keyword">slots</span>:
    <span class="type">void</span> showAddEntryDialog();
    <span class="type">void</span> addEntry(<span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> <span class="operator">&amp;</span>name<span class="operator">,</span> <span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> <span class="operator">&amp;</span>address);
    <span class="type">void</span> editEntry();
    <span class="type">void</span> removeEntry();

<span class="keyword">signals</span>:
    <span class="type">void</span> selectionChanged (<span class="keyword">const</span> <span class="type"><a href="./qitemselection.htm" translate="no">QItemSelection</a></span> <span class="operator">&amp;</span>selected);

<span class="keyword">private</span>:
    <span class="type">void</span> setupTabs();

    TableModel <span class="operator">*</span>table;
    NewAddressTab <span class="operator">*</span>newAddressTab;
};</pre></div>
<p><code translate="no">AddressWidget</code> extends <a href="./qtabwidget.htm" translate="no">QTabWidget</a> in order to hold 10 tabs (<code translate="no">NewAddressTab</code> and the 9 alphabet group tabs) and also manipulates <code translate="no">table</code>, the <code translate="no">TableModel</code> object, <code translate="no">proxyModel</code>, the <a href="./qsortfilterproxymodel.htm" translate="no">QSortFilterProxyModel</a> object that we use to filter the entries, and <code translate="no">tableView</code>, the <a href="./qtableview.htm" translate="no">QTableView</a> object.</p>
<a name="addresswidget-class-implementation"></a>
<h4 id="addresswidget-class-implementation">AddressWidget Class Implementation<a class="plink" href="#addresswidget-class-implementation" title="Direct link to this headline"></a></h4>
<p>The <code translate="no">AddressWidget</code> constructor accepts a parent widget and instantiates <code translate="no">NewAddressTab</code>, <code translate="no">TableModel</code> and <a href="./qsortfilterproxymodel.htm" translate="no">QSortFilterProxyModel</a>. The <code translate="no">NewAddressTab</code> object, which is used to indicate that the address book is empty, is added and the rest of the 9 tabs are set up with <code translate="no">setupTabs()</code>.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">AddressWidget<span class="operator">::</span>AddressWidget(<span class="type"><a href="./qwidget.htm" translate="no">QWidget</a></span> <span class="operator">*</span>parent)
    : <span class="type"><a href="./qtabwidget.htm" translate="no">QTabWidget</a></span>(parent)<span class="operator">,</span>
      table(<span class="keyword">new</span> TableModel(<span class="keyword">this</span>))<span class="operator">,</span>
      newAddressTab(<span class="keyword">new</span> NewAddressTab(<span class="keyword">this</span>))
{
    connect(newAddressTab<span class="operator">,</span> <span class="operator">&amp;</span>NewAddressTab<span class="operator">::</span>sendDetails<span class="operator">,</span>
        <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>AddressWidget<span class="operator">::</span>addEntry);

    addTab(newAddressTab<span class="operator">,</span> tr(<span class="string">"Address Book"</span>));

    setupTabs();
}</pre></div>
<p>The <code translate="no">setupTabs()</code> function is used to set up the 9 alphabet group tabs, table views and proxy models in <code translate="no">AddressWidget</code>. Each proxy model in turn is set to filter contact names according to the relevant alphabet group using a <a href="./qt.htm#CaseSensitivity-enum" translate="no">case-insensitive</a> <a href="./qregexp.htm" translate="no">QRegExp</a> object. The table views are also sorted in ascending order using the corresponding proxy model's <a href="./qsortfilterproxymodel.htm#sort" translate="no">sort()</a> function.</p>
<p>Each table view's <a href="./qabstractitemview.htm#selectionMode-prop" translate="no">selectionMode</a> is set to <a href="./qabstractitemview.htm#SelectionMode-enum" translate="no">QAbstractItemView::SingleSelection</a> and <a href="./qabstractitemview.htm#selectionBehavior-prop" translate="no">selectionBehavior</a> is set to <a href="./qabstractitemview.htm#SelectionBehavior-enum" translate="no">QAbstractItemView::SelectRows</a>, allowing the user to select all the items in one row at the same time. Each <a href="./qtableview.htm" translate="no">QTableView</a> object is automatically given a <a href="./qitemselectionmodel.htm" translate="no">QItemSelectionModel</a> that keeps track of the selected indexes.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> AddressWidget<span class="operator">::</span>setupTabs()
{
    <span class="keyword">const</span> <span class="keyword">auto</span> groups <span class="operator">=</span> { <span class="string">"ABC"</span><span class="operator">,</span> <span class="string">"DEF"</span><span class="operator">,</span> <span class="string">"GHI"</span><span class="operator">,</span> <span class="string">"JKL"</span><span class="operator">,</span> <span class="string">"MNO"</span><span class="operator">,</span> <span class="string">"PQR"</span><span class="operator">,</span> <span class="string">"STU"</span><span class="operator">,</span> <span class="string">"VW"</span><span class="operator">,</span> <span class="string">"XYZ"</span> };

    <span class="keyword">for</span> (<span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> <span class="operator">&amp;</span>str : groups) {
        <span class="keyword">const</span> <span class="keyword">auto</span> regExp <span class="operator">=</span> <span class="type"><a href="./qregularexpression.htm" translate="no">QRegularExpression</a></span>(<span class="type"><a href="./qstring.htm" translate="no">QString</a></span>(<span class="string">"^[%1].*"</span>)<span class="operator">.</span>arg(str)<span class="operator">,</span>
                                               <span class="type"><a href="./qregularexpression.htm" translate="no">QRegularExpression</a></span><span class="operator">::</span>CaseInsensitiveOption);

        <span class="keyword">auto</span> proxyModel <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qsortfilterproxymodel.htm" translate="no">QSortFilterProxyModel</a></span>(<span class="keyword">this</span>);
        proxyModel<span class="operator">-</span><span class="operator">&gt;</span>setSourceModel(table);
        proxyModel<span class="operator">-</span><span class="operator">&gt;</span>setFilterRegularExpression(regExp);
        proxyModel<span class="operator">-</span><span class="operator">&gt;</span>setFilterKeyColumn(<span class="number">0</span>);

        <span class="type"><a href="./qtableview.htm" translate="no">QTableView</a></span> <span class="operator">*</span>tableView <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qtableview.htm" translate="no">QTableView</a></span>;
        tableView<span class="operator">-</span><span class="operator">&gt;</span>setModel(proxyModel);
        tableView<span class="operator">-</span><span class="operator">&gt;</span>setSelectionBehavior(<span class="type"><a href="./qabstractitemview.htm" translate="no">QAbstractItemView</a></span><span class="operator">::</span>SelectRows);
        tableView<span class="operator">-</span><span class="operator">&gt;</span>horizontalHeader()<span class="operator">-</span><span class="operator">&gt;</span>setStretchLastSection(<span class="keyword">true</span>);
        tableView<span class="operator">-</span><span class="operator">&gt;</span>verticalHeader()<span class="operator">-</span><span class="operator">&gt;</span>hide();
        tableView<span class="operator">-</span><span class="operator">&gt;</span>setEditTriggers(<span class="type"><a href="./qabstractitemview.htm" translate="no">QAbstractItemView</a></span><span class="operator">::</span>NoEditTriggers);
        tableView<span class="operator">-</span><span class="operator">&gt;</span>setSelectionMode(<span class="type"><a href="./qabstractitemview.htm" translate="no">QAbstractItemView</a></span><span class="operator">::</span>SingleSelection);
        tableView<span class="operator">-</span><span class="operator">&gt;</span>setSortingEnabled(<span class="keyword">true</span>);

        connect(tableView<span class="operator">-</span><span class="operator">&gt;</span>selectionModel()<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qitemselectionmodel.htm" translate="no">QItemSelectionModel</a></span><span class="operator">::</span>selectionChanged<span class="operator">,</span>
                <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>AddressWidget<span class="operator">::</span>selectionChanged);

        connect(<span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qtabwidget.htm" translate="no">QTabWidget</a></span><span class="operator">::</span>currentChanged<span class="operator">,</span> <span class="keyword">this</span><span class="operator">,</span> <span class="operator">[</span><span class="keyword">this</span><span class="operator">,</span> tableView<span class="operator">]</span>(<span class="type">int</span> tabIndex) {
            <span class="keyword">if</span> (widget(tabIndex) <span class="operator">=</span><span class="operator">=</span> tableView)
                <span class="keyword">emit</span> selectionChanged(tableView<span class="operator">-</span><span class="operator">&gt;</span>selectionModel()<span class="operator">-</span><span class="operator">&gt;</span>selection());
        });

        addTab(tableView<span class="operator">,</span> str);
    }
}</pre></div>
<p>The <a href="./qitemselectionmodel.htm" translate="no">QItemSelectionModel</a> class provides a <a href="./qitemselectionmodel.htm#selectionChanged" translate="no">selectionChanged</a> signal that is connected to <code translate="no">AddressWidget</code>'s <code translate="no">selectionChanged()</code> signal. We also connect <a href="./qtabwidget.htm#currentChanged" translate="no">QTabWidget::currentChanged</a>() signal to the lambda expression which emits <code translate="no">AddressWidget</code>'s <code translate="no">selectionChanged()</code> as well. These connections are necessary to enable the <b translate="no">Edit Entry...</b> and <b translate="no">Remove Entry</b> actions in <code translate="no">MainWindow</code>'s Tools menu. It is further explained in <code translate="no">MainWindow</code>'s implementation.</p>
<p>Each table view in the address book is added as a tab to the <a href="./qtabwidget.htm" translate="no">QTabWidget</a> with the relevant label, obtained from the <a href="./qstringlist.htm" translate="no">QStringList</a> of groups.</p>
<p class="centerAlign"><img alt="Signals and Slots Connections" src="./images/addressbook-signals.png"></p><p>We provide two <code translate="no">addEntry()</code> functions: One which is intended to be used to accept user input, and the other which performs the actual task of adding new entries to the address book. We divide the responsibility of adding entries into two parts to allow <code translate="no">newAddressTab</code> to insert data without having to popup a dialog.</p>
<p>The first <code translate="no">addEntry()</code> function is a slot connected to the <code translate="no">MainWindow</code>'s <b translate="no">Add Entry...</b> action. This function creates an <code translate="no">AddDialog</code> object and then calls the second <code translate="no">addEntry()</code> function to actually add the contact to <code translate="no">table</code>.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> AddressWidget<span class="operator">::</span>showAddEntryDialog()
{
    AddDialog aDialog;

    <span class="keyword">if</span> (aDialog<span class="operator">.</span>exec())
        addEntry(aDialog<span class="operator">.</span>name()<span class="operator">,</span> aDialog<span class="operator">.</span>address());
}</pre></div>
<p>Basic validation is done in the second <code translate="no">addEntry()</code> function to prevent duplicate entries in the address book. As mentioned with <code translate="no">TableModel</code>, this is part of the reason why we require the getter method <code translate="no">getContacts()</code>.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> AddressWidget<span class="operator">::</span>addEntry(<span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> <span class="operator">&amp;</span>name<span class="operator">,</span> <span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> <span class="operator">&amp;</span>address)
{
    <span class="keyword">if</span> (<span class="operator">!</span>table<span class="operator">-</span><span class="operator">&gt;</span>getContacts()<span class="operator">.</span>contains({ name<span class="operator">,</span> address })) {
        table<span class="operator">-</span><span class="operator">&gt;</span>insertRows(<span class="number">0</span><span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span>());

        <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> index <span class="operator">=</span> table<span class="operator">-</span><span class="operator">&gt;</span>index(<span class="number">0</span><span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span>());
        table<span class="operator">-</span><span class="operator">&gt;</span>setData(index<span class="operator">,</span> name<span class="operator">,</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>EditRole);
        index <span class="operator">=</span> table<span class="operator">-</span><span class="operator">&gt;</span>index(<span class="number">0</span><span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span>());
        table<span class="operator">-</span><span class="operator">&gt;</span>setData(index<span class="operator">,</span> address<span class="operator">,</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>EditRole);
        removeTab(indexOf(newAddressTab));
    } <span class="keyword">else</span> {
        <span class="type"><a href="./qmessagebox.htm" translate="no">QMessageBox</a></span><span class="operator">::</span>information(<span class="keyword">this</span><span class="operator">,</span> tr(<span class="string">"Duplicate Name"</span>)<span class="operator">,</span>
            tr(<span class="string">"The name \"%1\" already exists."</span>)<span class="operator">.</span>arg(name));
    }
}</pre></div>
<p>If the model does not already contain an entry with the same name, we call <code translate="no">setData()</code> to insert the name and address into the first and second columns. Otherwise, we display a <a href="./qmessagebox.htm" translate="no">QMessageBox</a> to inform the user.</p>
<div class="admonition note">
<p><b>Note: </b>The <code translate="no">newAddressTab</code> is removed once a contact is added as the address book is no longer empty.</p>
</div>
<p>Editing an entry is a way to update the contact's address only, as the example does not allow the user to change the name of an existing contact.</p>
<p>Firstly, we obtain the active tab's <a href="./qtableview.htm" translate="no">QTableView</a> object using <a href="./qtabwidget.htm#currentWidget" translate="no">QTabWidget::currentWidget</a>(). Then we extract the <code translate="no">selectionModel</code> from the <code translate="no">tableView</code> to obtain the selected indexes.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> AddressWidget<span class="operator">::</span>editEntry()
{
    <span class="type"><a href="./qtableview.htm" translate="no">QTableView</a></span> <span class="operator">*</span>temp <span class="operator">=</span> <span class="keyword">static_cast</span><span class="operator">&lt;</span><span class="type"><a href="./qtableview.htm" translate="no">QTableView</a></span><span class="operator">*</span><span class="operator">&gt;</span>(currentWidget());
    <span class="type"><a href="./qsortfilterproxymodel.htm" translate="no">QSortFilterProxyModel</a></span> <span class="operator">*</span>proxy <span class="operator">=</span> <span class="keyword">static_cast</span><span class="operator">&lt;</span><span class="type"><a href="./qsortfilterproxymodel.htm" translate="no">QSortFilterProxyModel</a></span><span class="operator">*</span><span class="operator">&gt;</span>(temp<span class="operator">-</span><span class="operator">&gt;</span>model());
    <span class="type"><a href="./qitemselectionmodel.htm" translate="no">QItemSelectionModel</a></span> <span class="operator">*</span>selectionModel <span class="operator">=</span> temp<span class="operator">-</span><span class="operator">&gt;</span>selectionModel();

    <span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm#QModelIndexList-typedef" translate="no">QModelIndexList</a></span> indexes <span class="operator">=</span> selectionModel<span class="operator">-</span><span class="operator">&gt;</span>selectedRows();
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> name;
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> address;
    <span class="type">int</span> row <span class="operator">=</span> <span class="operator">-</span><span class="number">1</span>;

    <span class="keyword">for</span> (<span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>index : indexes) {
        row <span class="operator">=</span> proxy<span class="operator">-</span><span class="operator">&gt;</span>mapToSource(index)<span class="operator">.</span>row();
        <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> nameIndex <span class="operator">=</span> table<span class="operator">-</span><span class="operator">&gt;</span>index(row<span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span>());
        <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> varName <span class="operator">=</span> table<span class="operator">-</span><span class="operator">&gt;</span>data(nameIndex<span class="operator">,</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>DisplayRole);
        name <span class="operator">=</span> varName<span class="operator">.</span>toString();

        <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> addressIndex <span class="operator">=</span> table<span class="operator">-</span><span class="operator">&gt;</span>index(row<span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span>());
        <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> varAddr <span class="operator">=</span> table<span class="operator">-</span><span class="operator">&gt;</span>data(addressIndex<span class="operator">,</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>DisplayRole);
        address <span class="operator">=</span> varAddr<span class="operator">.</span>toString();
    }</pre></div>
<p>Next we extract data from the row the user intends to edit. This data is displayed in an instance of <code translate="no">AddDialog</code> with a different window title. The <code translate="no">table</code> is only updated if changes have been made to data in <code translate="no">aDialog</code>.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">    AddDialog aDialog;
    aDialog<span class="operator">.</span>setWindowTitle(tr(<span class="string">"Edit a Contact"</span>));
    aDialog<span class="operator">.</span>editAddress(name<span class="operator">,</span> address);

    <span class="keyword">if</span> (aDialog<span class="operator">.</span>exec()) {
        <span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> newAddress <span class="operator">=</span> aDialog<span class="operator">.</span>address();
        <span class="keyword">if</span> (newAddress <span class="operator">!</span><span class="operator">=</span> address) {
            <span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> index <span class="operator">=</span> table<span class="operator">-</span><span class="operator">&gt;</span>index(row<span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span>());
            table<span class="operator">-</span><span class="operator">&gt;</span>setData(index<span class="operator">,</span> newAddress<span class="operator">,</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>EditRole);
        }
    }
}</pre></div>
<p class="centerAlign"><img alt="Screenshot of Dialog to Edit a Contact" src="./images/addressbook-editdialog.png"></p><p>Entries are removed using the <code translate="no">removeEntry()</code> function. The selected row is removed by accessing it through the <a href="./qitemselectionmodel.htm" translate="no">QItemSelectionModel</a> object, <code translate="no">selectionModel</code>. The <code translate="no">newAddressTab</code> is re-added to the <code translate="no">AddressWidget</code> only if the user removes all the contacts in the address book.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> AddressWidget<span class="operator">::</span>removeEntry()
{
    <span class="type"><a href="./qtableview.htm" translate="no">QTableView</a></span> <span class="operator">*</span>temp <span class="operator">=</span> <span class="keyword">static_cast</span><span class="operator">&lt;</span><span class="type"><a href="./qtableview.htm" translate="no">QTableView</a></span><span class="operator">*</span><span class="operator">&gt;</span>(currentWidget());
    <span class="type"><a href="./qsortfilterproxymodel.htm" translate="no">QSortFilterProxyModel</a></span> <span class="operator">*</span>proxy <span class="operator">=</span> <span class="keyword">static_cast</span><span class="operator">&lt;</span><span class="type"><a href="./qsortfilterproxymodel.htm" translate="no">QSortFilterProxyModel</a></span><span class="operator">*</span><span class="operator">&gt;</span>(temp<span class="operator">-</span><span class="operator">&gt;</span>model());
    <span class="type"><a href="./qitemselectionmodel.htm" translate="no">QItemSelectionModel</a></span> <span class="operator">*</span>selectionModel <span class="operator">=</span> temp<span class="operator">-</span><span class="operator">&gt;</span>selectionModel();

    <span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm#QModelIndexList-typedef" translate="no">QModelIndexList</a></span> indexes <span class="operator">=</span> selectionModel<span class="operator">-</span><span class="operator">&gt;</span>selectedRows();

    <span class="keyword">for</span> (<span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> index : indexes) {
        <span class="type">int</span> row <span class="operator">=</span> proxy<span class="operator">-</span><span class="operator">&gt;</span>mapToSource(index)<span class="operator">.</span>row();
        table<span class="operator">-</span><span class="operator">&gt;</span>removeRows(row<span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span>());
    }

    <span class="keyword">if</span> (table<span class="operator">-</span><span class="operator">&gt;</span>rowCount(<span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span>()) <span class="operator">=</span><span class="operator">=</span> <span class="number">0</span>)
        insertTab(<span class="number">0</span><span class="operator">,</span> newAddressTab<span class="operator">,</span> tr(<span class="string">"Address Book"</span>));
}</pre></div>
<p>The <code translate="no">writeToFile()</code> function is used to save a file containing all the contacts in the address book. The file is saved in a custom <code translate="no">.dat</code> format. The contents of the list of contacts are written to <code translate="no">file</code> using <a href="./qdatastream.htm" translate="no">QDataStream</a>. If the file cannot be opened, a <a href="./qmessagebox.htm" translate="no">QMessageBox</a> is displayed with the related error message.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> AddressWidget<span class="operator">::</span>writeToFile(<span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> <span class="operator">&amp;</span>fileName)
{
    <span class="type"><a href="./qfile.htm" translate="no">QFile</a></span> file(fileName);

    <span class="keyword">if</span> (<span class="operator">!</span>file<span class="operator">.</span>open(<span class="type"><a href="./qiodevice.htm" translate="no">QIODevice</a></span><span class="operator">::</span>WriteOnly)) {
        <span class="type"><a href="./qmessagebox.htm" translate="no">QMessageBox</a></span><span class="operator">::</span>information(<span class="keyword">this</span><span class="operator">,</span> tr(<span class="string">"Unable to open file"</span>)<span class="operator">,</span> file<span class="operator">.</span>errorString());
        <span class="keyword">return</span>;
    }

    <span class="type"><a href="./qdatastream.htm" translate="no">QDataStream</a></span> out(<span class="operator">&amp;</span>file);
    out <span class="operator">&lt;</span><span class="operator">&lt;</span> table<span class="operator">-</span><span class="operator">&gt;</span>getContacts();
}</pre></div>
<p>The <code translate="no">readFromFile()</code> function loads a file containing all the contacts in the address book, previously saved using <code translate="no">writeToFile()</code>. <a href="./qdatastream.htm" translate="no">QDataStream</a> is used to read the contents of a <code translate="no">.dat</code> file into a list of contacts and each of these is added using <code translate="no">addEntry()</code>.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> AddressWidget<span class="operator">::</span>readFromFile(<span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> <span class="operator">&amp;</span>fileName)
{
    <span class="type"><a href="./qfile.htm" translate="no">QFile</a></span> file(fileName);

    <span class="keyword">if</span> (<span class="operator">!</span>file<span class="operator">.</span>open(<span class="type"><a href="./qiodevice.htm" translate="no">QIODevice</a></span><span class="operator">::</span>ReadOnly)) {
        <span class="type"><a href="./qmessagebox.htm" translate="no">QMessageBox</a></span><span class="operator">::</span>information(<span class="keyword">this</span><span class="operator">,</span> tr(<span class="string">"Unable to open file"</span>)<span class="operator">,</span>
            file<span class="operator">.</span>errorString());
        <span class="keyword">return</span>;
    }

    <span class="type"><a href="./qvector.htm" translate="no">QVector</a></span><span class="operator">&lt;</span>Contact<span class="operator">&gt;</span> contacts;
    <span class="type"><a href="./qdatastream.htm" translate="no">QDataStream</a></span> in(<span class="operator">&amp;</span>file);
    in <span class="operator">&gt;</span><span class="operator">&gt;</span> contacts;

    <span class="keyword">if</span> (contacts<span class="operator">.</span>isEmpty()) {
        <span class="type"><a href="./qmessagebox.htm" translate="no">QMessageBox</a></span><span class="operator">::</span>information(<span class="keyword">this</span><span class="operator">,</span> tr(<span class="string">"No contacts in file"</span>)<span class="operator">,</span>
                                 tr(<span class="string">"The file you are attempting to open contains no contacts."</span>));
    } <span class="keyword">else</span> {
        <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> <span class="operator">&amp;</span>contact: qAsConst(contacts))
            addEntry(contact<span class="operator">.</span>name<span class="operator">,</span> contact<span class="operator">.</span>address);
    }
}</pre></div>
<a name="newaddresstab-class-definition"></a>
<h4 id="newaddresstab-class-definition">NewAddressTab Class Definition<a class="plink" href="#newaddresstab-class-definition" title="Direct link to this headline"></a></h4>
<p>The <code translate="no">NewAddressTab</code> class provides an informative tab telling the user that the address book is empty. It appears and disappears according to the contents of the address book, as mentioned in <code translate="no">AddressWidget</code>'s implementation.</p>
<p class="centerAlign"><img alt="Screenshot of NewAddressTab" src="./images/addressbook-newaddresstab.png"></p><p>The <code translate="no">NewAddressTab</code> class extends <a href="./qwidget.htm" translate="no">QWidget</a> and contains a <a href="./qlabel.htm" translate="no">QLabel</a> and <a href="./qpushbutton.htm" translate="no">QPushButton</a>.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="keyword">class</span> NewAddressTab : <span class="keyword">public</span> <span class="type"><a href="./qwidget.htm" translate="no">QWidget</a></span>
{
    Q_OBJECT

<span class="keyword">public</span>:
    NewAddressTab(<span class="type"><a href="./qwidget.htm" translate="no">QWidget</a></span> <span class="operator">*</span>parent <span class="operator">=</span> nullptr);

<span class="keyword">public</span> <span class="keyword">slots</span>:
    <span class="type">void</span> addEntry();

<span class="keyword">signals</span>:
    <span class="type">void</span> sendDetails(<span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> <span class="operator">&amp;</span>name<span class="operator">,</span> <span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> <span class="operator">&amp;</span>address);
};</pre></div>
<a name="newaddresstab-class-implementation"></a>
<h4 id="newaddresstab-class-implementation">NewAddressTab Class Implementation<a class="plink" href="#newaddresstab-class-implementation" title="Direct link to this headline"></a></h4>
<p>The constructor instantiates the <code translate="no">addButton</code>, <code translate="no">descriptionLabel</code> and connects the <code translate="no">addButton</code>'s signal to the <code translate="no">addEntry()</code> slot.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">NewAddressTab<span class="operator">::</span>NewAddressTab(<span class="type"><a href="./qwidget.htm" translate="no">QWidget</a></span> <span class="operator">*</span>parent)
    : <span class="type"><a href="./qwidget.htm" translate="no">QWidget</a></span>(parent)
{
    <span class="keyword">auto</span> descriptionLabel <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qlabel.htm" translate="no">QLabel</a></span>(tr(<span class="string">"There are currently no contacts in your address book. "</span>
                                          <span class="string">"\nClick Add to add new contacts."</span>));

    <span class="keyword">auto</span> addButton <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qpushbutton.htm" translate="no">QPushButton</a></span>(tr(<span class="string">"Add"</span>));

    connect(addButton<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qabstractbutton.htm" translate="no">QAbstractButton</a></span><span class="operator">::</span>clicked<span class="operator">,</span> <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>NewAddressTab<span class="operator">::</span>addEntry);

    <span class="keyword">auto</span> mainLayout <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qvboxlayout.htm" translate="no">QVBoxLayout</a></span>;
    mainLayout<span class="operator">-</span><span class="operator">&gt;</span>addWidget(descriptionLabel);
    mainLayout<span class="operator">-</span><span class="operator">&gt;</span>addWidget(addButton<span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>AlignCenter);

    setLayout(mainLayout);
}</pre></div>
<p>The <code translate="no">addEntry()</code> function is similar to <code translate="no">AddressWidget</code>'s <code translate="no">addEntry()</code> in the sense that both functions instantiate an <code translate="no">AddDialog</code> object. Data from the dialog is extracted and sent to <code translate="no">AddressWidget</code>'s <code translate="no">addEntry()</code> slot by emitting the <code translate="no">sendDetails()</code> signal.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> NewAddressTab<span class="operator">::</span>addEntry()
{
    AddDialog aDialog;

    <span class="keyword">if</span> (aDialog<span class="operator">.</span>exec())
        <span class="keyword">emit</span> sendDetails(aDialog<span class="operator">.</span>name()<span class="operator">,</span> aDialog<span class="operator">.</span>address());
}</pre></div>
<p class="centerAlign"><img alt="" src="./images/signals-n-slots-aw-nat.png"></p><a name="adddialog-class-definition"></a>
<h4 id="adddialog-class-definition">AddDialog Class Definition<a class="plink" href="#adddialog-class-definition" title="Direct link to this headline"></a></h4>
<p>The <code translate="no">AddDialog</code> class extends <a href="./qdialog.htm" translate="no">QDialog</a> and provides the user with a <a href="./qlineedit.htm" translate="no">QLineEdit</a> and a <a href="./qtextedit.htm" translate="no">QTextEdit</a> to input data into the address book.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="keyword">class</span> AddDialog : <span class="keyword">public</span> <span class="type"><a href="./qdialog.htm" translate="no">QDialog</a></span>
{
    Q_OBJECT

<span class="keyword">public</span>:
    AddDialog(<span class="type"><a href="./qwidget.htm" translate="no">QWidget</a></span> <span class="operator">*</span>parent <span class="operator">=</span> nullptr);

    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> name() <span class="keyword">const</span>;
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> address() <span class="keyword">const</span>;
    <span class="type">void</span> editAddress(<span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> <span class="operator">&amp;</span>name<span class="operator">,</span> <span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> <span class="operator">&amp;</span>address);

<span class="keyword">private</span>:
    <span class="type"><a href="./qlineedit.htm" translate="no">QLineEdit</a></span> <span class="operator">*</span>nameText;
    <span class="type"><a href="./qtextedit.htm" translate="no">QTextEdit</a></span> <span class="operator">*</span>addressText;
};</pre></div>
<p class="centerAlign"><img alt="" src="./images/addressbook-adddialog.png"></p><a name="adddialog-class-implementation"></a>
<h4 id="adddialog-class-implementation">AddDialog Class Implementation<a class="plink" href="#adddialog-class-implementation" title="Direct link to this headline"></a></h4>
<p>The <code translate="no">AddDialog</code>'s constructor sets up the user interface, creating the necessary widgets and placing them into layouts.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">AddDialog<span class="operator">::</span>AddDialog(<span class="type"><a href="./qwidget.htm" translate="no">QWidget</a></span> <span class="operator">*</span>parent)
    : <span class="type"><a href="./qdialog.htm" translate="no">QDialog</a></span>(parent)<span class="operator">,</span>
      nameText(<span class="keyword">new</span> <span class="type"><a href="./qlineedit.htm" translate="no">QLineEdit</a></span>)<span class="operator">,</span>
      addressText(<span class="keyword">new</span> <span class="type"><a href="./qtextedit.htm" translate="no">QTextEdit</a></span>)
{
    <span class="keyword">auto</span> nameLabel <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qlabel.htm" translate="no">QLabel</a></span>(tr(<span class="string">"Name"</span>));
    <span class="keyword">auto</span> addressLabel <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qlabel.htm" translate="no">QLabel</a></span>(tr(<span class="string">"Address"</span>));
    <span class="keyword">auto</span> okButton <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qpushbutton.htm" translate="no">QPushButton</a></span>(tr(<span class="string">"OK"</span>));
    <span class="keyword">auto</span> cancelButton <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qpushbutton.htm" translate="no">QPushButton</a></span>(tr(<span class="string">"Cancel"</span>));

    <span class="keyword">auto</span> gLayout <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qgridlayout.htm" translate="no">QGridLayout</a></span>;
    gLayout<span class="operator">-</span><span class="operator">&gt;</span>setColumnStretch(<span class="number">1</span><span class="operator">,</span> <span class="number">2</span>);
    gLayout<span class="operator">-</span><span class="operator">&gt;</span>addWidget(nameLabel<span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="number">0</span>);
    gLayout<span class="operator">-</span><span class="operator">&gt;</span>addWidget(nameText<span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="number">1</span>);

    gLayout<span class="operator">-</span><span class="operator">&gt;</span>addWidget(addressLabel<span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>AlignLeft<span class="operator">|</span><span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>AlignTop);
    gLayout<span class="operator">-</span><span class="operator">&gt;</span>addWidget(addressText<span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>AlignLeft);

    <span class="keyword">auto</span> buttonLayout <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qhboxlayout.htm" translate="no">QHBoxLayout</a></span>;
    buttonLayout<span class="operator">-</span><span class="operator">&gt;</span>addWidget(okButton);
    buttonLayout<span class="operator">-</span><span class="operator">&gt;</span>addWidget(cancelButton);

    gLayout<span class="operator">-</span><span class="operator">&gt;</span>addLayout(buttonLayout<span class="operator">,</span> <span class="number">2</span><span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>AlignRight);

    <span class="keyword">auto</span> mainLayout <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qvboxlayout.htm" translate="no">QVBoxLayout</a></span>;
    mainLayout<span class="operator">-</span><span class="operator">&gt;</span>addLayout(gLayout);
    setLayout(mainLayout);

    connect(okButton<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qabstractbutton.htm" translate="no">QAbstractButton</a></span><span class="operator">::</span>clicked<span class="operator">,</span> <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qdialog.htm" translate="no">QDialog</a></span><span class="operator">::</span>accept);
    connect(cancelButton<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qabstractbutton.htm" translate="no">QAbstractButton</a></span><span class="operator">::</span>clicked<span class="operator">,</span> <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qdialog.htm" translate="no">QDialog</a></span><span class="operator">::</span>reject);

    setWindowTitle(tr(<span class="string">"Add a Contact"</span>));
}

<span class="type"><a href="./qstring.htm" translate="no">QString</a></span> AddDialog<span class="operator">::</span>name() <span class="keyword">const</span>
{
    <span class="keyword">return</span> nameText<span class="operator">-</span><span class="operator">&gt;</span>text();
}

<span class="type"><a href="./qstring.htm" translate="no">QString</a></span> AddDialog<span class="operator">::</span>address() <span class="keyword">const</span>
{
    <span class="keyword">return</span> addressText<span class="operator">-</span><span class="operator">&gt;</span>toPlainText();
}

<span class="type">void</span> AddDialog<span class="operator">::</span>editAddress(<span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> <span class="operator">&amp;</span>name<span class="operator">,</span> <span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> <span class="operator">&amp;</span>address)
{
    nameText<span class="operator">-</span><span class="operator">&gt;</span>setReadOnly(<span class="keyword">true</span>);
    nameText<span class="operator">-</span><span class="operator">&gt;</span>setText(name);
    addressText<span class="operator">-</span><span class="operator">&gt;</span>setPlainText(address);
}</pre></div>
<p>To give the dialog the desired behavior, we connect the <b translate="no">OK</b> and <b translate="no">Cancel</b> buttons to the dialog's <a href="./qdialog.htm#accept" translate="no">accept()</a> and <a href="./qdialog.htm#reject" translate="no">reject()</a> slots. Since the dialog only acts as a container for name and address information, we do not need to implement any other functions for it.</p>
<a name="mainwindow-class-definition"></a>
<h4 id="mainwindow-class-definition">MainWindow Class Definition<a class="plink" href="#mainwindow-class-definition" title="Direct link to this headline"></a></h4>
<p>The <code translate="no">MainWindow</code> class extends <a href="./qmainwindow.htm" translate="no">QMainWindow</a> and implements the menus and actions necessary to manipulate the address book.</p>
<div class="table"><table class="generic">
<tbody><tr class="odd" valign="top"><td><img alt="" src="./images/addressbook-filemenu.png"></td><td><img alt="" src="./images/addressbook-toolsmenu.png"></td></tr>
</tbody></table></div>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="keyword">class</span> MainWindow : <span class="keyword">public</span> <span class="type"><a href="./qmainwindow.htm" translate="no">QMainWindow</a></span>
{
    Q_OBJECT

<span class="keyword">public</span>:
    MainWindow();

<span class="keyword">private</span> <span class="keyword">slots</span>:
    <span class="type">void</span> updateActions(<span class="keyword">const</span> <span class="type"><a href="./qitemselection.htm" translate="no">QItemSelection</a></span> <span class="operator">&amp;</span>selection);
    <span class="type">void</span> openFile();
    <span class="type">void</span> saveFile();

<span class="keyword">private</span>:
    <span class="type">void</span> createMenus();

    AddressWidget <span class="operator">*</span>addressWidget;
    <span class="type"><a href="./qaction.htm" translate="no">QAction</a></span> <span class="operator">*</span>editAct;
    <span class="type"><a href="./qaction.htm" translate="no">QAction</a></span> <span class="operator">*</span>removeAct;
};</pre></div>
<p>The <code translate="no">MainWindow</code> class uses an <code translate="no">AddressWidget</code> as its central widget and provides the File menu with <b translate="no">Open</b>, <b translate="no">Close</b> and <b translate="no">Exit</b> actions, as well as the <b translate="no">Tools</b> menu with <b translate="no">Add Entry...</b>, <b translate="no">Edit Entry...</b> and <b translate="no">Remove Entry</b> actions.</p>
<a name="mainwindow-class-implementation"></a>
<h4 id="mainwindow-class-implementation">MainWindow Class Implementation<a class="plink" href="#mainwindow-class-implementation" title="Direct link to this headline"></a></h4>
<p>The constructor for <code translate="no">MainWindow</code> instantiates AddressWidget, sets it as its central widget and calls the <code translate="no">createMenus()</code> function.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">MainWindow<span class="operator">::</span>MainWindow()
    : <span class="type"><a href="./qmainwindow.htm" translate="no">QMainWindow</a></span>()<span class="operator">,</span>
      addressWidget(<span class="keyword">new</span> AddressWidget)
{
    setCentralWidget(addressWidget);
    createMenus();
    setWindowTitle(tr(<span class="string">"Address Book"</span>));
}</pre></div>
<p>The <code translate="no">createMenus()</code> function sets up the <b translate="no">File</b> and <b translate="no">Tools</b> menus, connecting the actions to their respective slots. Both the <b translate="no">Edit Entry...</b> and <b translate="no">Remove Entry</b> actions are disabled by default as such actions cannot be carried out on an empty address book. They are only enabled when one or more contacts are added.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> MainWindow<span class="operator">::</span>createMenus()
{
    <span class="type"><a href="./qmenu.htm" translate="no">QMenu</a></span> <span class="operator">*</span>fileMenu <span class="operator">=</span> menuBar()<span class="operator">-</span><span class="operator">&gt;</span>addMenu(tr(<span class="string">"&amp;File"</span>));

    <span class="type"><a href="./qaction.htm" translate="no">QAction</a></span> <span class="operator">*</span>openAct <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qaction.htm" translate="no">QAction</a></span>(tr(<span class="string">"&amp;Open..."</span>)<span class="operator">,</span> <span class="keyword">this</span>);
    fileMenu<span class="operator">-</span><span class="operator">&gt;</span>addAction(openAct);
    connect(openAct<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qaction.htm" translate="no">QAction</a></span><span class="operator">::</span>triggered<span class="operator">,</span> <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>MainWindow<span class="operator">::</span>openFile);
    ...

    editAct <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qaction.htm" translate="no">QAction</a></span>(tr(<span class="string">"&amp;Edit Entry..."</span>)<span class="operator">,</span> <span class="keyword">this</span>);
    editAct<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(<span class="keyword">false</span>);
    toolMenu<span class="operator">-</span><span class="operator">&gt;</span>addAction(editAct);
    connect(editAct<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qaction.htm" translate="no">QAction</a></span><span class="operator">::</span>triggered<span class="operator">,</span> addressWidget<span class="operator">,</span> <span class="operator">&amp;</span>AddressWidget<span class="operator">::</span>editEntry);

    toolMenu<span class="operator">-</span><span class="operator">&gt;</span>addSeparator();

    removeAct <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qaction.htm" translate="no">QAction</a></span>(tr(<span class="string">"&amp;Remove Entry"</span>)<span class="operator">,</span> <span class="keyword">this</span>);
    removeAct<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(<span class="keyword">false</span>);
    toolMenu<span class="operator">-</span><span class="operator">&gt;</span>addAction(removeAct);
    connect(removeAct<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qaction.htm" translate="no">QAction</a></span><span class="operator">::</span>triggered<span class="operator">,</span> addressWidget<span class="operator">,</span> <span class="operator">&amp;</span>AddressWidget<span class="operator">::</span>removeEntry);

    connect(addressWidget<span class="operator">,</span> <span class="operator">&amp;</span>AddressWidget<span class="operator">::</span>selectionChanged<span class="operator">,</span>
        <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>MainWindow<span class="operator">::</span>updateActions);
}</pre></div>
<p>Apart from connecting all the actions' signals to their respective slots, we also connect <code translate="no">AddressWidget</code>'s <code translate="no">selectionChanged()</code> signal to its <code translate="no">updateActions()</code> slot.</p>
<p>The <code translate="no">openFile()</code> function allows the user to choose a file with the <a href="./qfiledialog.htm#getOpenFileName" translate="no">open file dialog</a>. The chosen file has to be a custom <code translate="no">.dat</code> file that contains address book contacts. This function is a slot connected to <code translate="no">openAct</code> in the <b translate="no">File</b> menu.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> MainWindow<span class="operator">::</span>openFile()
{
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> fileName <span class="operator">=</span> <span class="type"><a href="./qfiledialog.htm" translate="no">QFileDialog</a></span><span class="operator">::</span>getOpenFileName(<span class="keyword">this</span>);
    <span class="keyword">if</span> (<span class="operator">!</span>fileName<span class="operator">.</span>isEmpty())
        addressWidget<span class="operator">-</span><span class="operator">&gt;</span>readFromFile(fileName);
}</pre></div>
<p>The <code translate="no">saveFile()</code> function allows the user to save a file with the <a href="./qfiledialog.htm#getSaveFileName" translate="no">save file dialog</a>. This function is a slot connected to <code translate="no">saveAct</code> in the <b translate="no">File</b> menu.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> MainWindow<span class="operator">::</span>saveFile()
{
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> fileName <span class="operator">=</span> <span class="type"><a href="./qfiledialog.htm" translate="no">QFileDialog</a></span><span class="operator">::</span>getSaveFileName(<span class="keyword">this</span>);
    <span class="keyword">if</span> (<span class="operator">!</span>fileName<span class="operator">.</span>isEmpty())
        addressWidget<span class="operator">-</span><span class="operator">&gt;</span>writeToFile(fileName);
}</pre></div>
<p>The <code translate="no">updateActions()</code> function enables and disables <b translate="no">Edit Entry...</b> and <b translate="no">Remove Entry</b> depending on the contents of the address book. If the address book is empty, these actions are disabled; otherwise, they are enabled. This function is a slot is connected to the <code translate="no">AddressWidget</code>'s <code translate="no">selectionChanged()</code> signal.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> MainWindow<span class="operator">::</span>updateActions(<span class="keyword">const</span> <span class="type"><a href="./qitemselection.htm" translate="no">QItemSelection</a></span> <span class="operator">&amp;</span>selection)
{
    <span class="type"><a href="./qmodelindex.htm#QModelIndexList-typedef" translate="no">QModelIndexList</a></span> indexes <span class="operator">=</span> selection<span class="operator">.</span>indexes();

    <span class="keyword">if</span> (<span class="operator">!</span>indexes<span class="operator">.</span>isEmpty()) {
        removeAct<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(<span class="keyword">true</span>);
        editAct<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(<span class="keyword">true</span>);
    } <span class="keyword">else</span> {
        removeAct<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(<span class="keyword">false</span>);
        editAct<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(<span class="keyword">false</span>);
    }
}</pre></div>
<a name="main-function"></a>
<h4 id="main-function">main() Function<a class="plink" href="#main-function" title="Direct link to this headline"></a></h4>
<p>The main function for the address book instantiates <a href="./qapplication.htm" translate="no">QApplication</a> and opens a <code translate="no">MainWindow</code> before running the event loop.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">int</span> main(<span class="type">int</span> argc<span class="operator">,</span> <span class="type">char</span> <span class="operator">*</span>argv<span class="operator">[</span><span class="operator">]</span>)
{
<span class="preprocessor">#ifdef Q_OS_ANDROID</span>
    <span class="type"><a href="./qapplication.htm" translate="no">QApplication</a></span><span class="operator">::</span>setAttribute(<span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>AA_EnableHighDpiScaling);
<span class="preprocessor">#endif</span>
    <span class="type"><a href="./qapplication.htm" translate="no">QApplication</a></span> app(argc<span class="operator">,</span> argv);
    MainWindow mw;
    mw<span class="operator">.</span>show();
    <span class="keyword">return</span> app<span class="operator">.</span>exec();
}</pre></div>
<p><a href="https://code.qt.io/cgit/qt/qtbase.git/tree/examples/widgets/itemviews/addressbook?h=5.15" translate="no">Example project @ code.qt.io</a></p>
</div>
<!-- @@@itemviews/addressbook -->
</div>
<p class="copy-notice">
<acronym title="Copyright"></acronym> 2025 The Qt Company Ltd.
   Documentation contributions included herein are the copyrights of
   their respective owners.     The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the Free Software Foundation.     Qt and respective logos are <a href="https://doc.qt.io/qt/trademarks.html">    trademarks</a> of The Qt Company Ltd. in Finland and/or other countries
   worldwide. All other trademarks are property of their respective owners. </p>

                    </div>
                </article>
                
            </div>
        </div>
    </div>
</div>
</body></html>