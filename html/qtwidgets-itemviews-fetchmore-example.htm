<html lang="en"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Fetch More Example | Qt Widgets</title>
<link rel="canonical" href="https://doc.qt.io/qt-6/qtwidgets-itemviews-fetchmore-example.html">
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <!-- Google Tag Manager -->
    
  <!-- End Google Tag Manager -->
  
  
</head>
<body class="qt-design-system" style="background:var(--content-bg-color)" onload="prettyPrint()">

<div data-global-resource-path="qt-design-system/components/b-sidebar.html">
    <div class="b-sidebar b-sidebar--full-width">
        
        <div class="b-sidebar__content">
            <div class="b-sidebar__topbar" data-margin-bottom="sm">
                <div class="b-topbar">
                                        <div class="b-topbar__breadcrump" translate="no">
                        <ul class="c-breadcrump">
                            <li><a href="./index.htm" translate="no">Qt 5.15</a></li>
                            <li><a href="./qtwidgets-index.htm" translate="no">Qt Widgets</a></li>
                            <li><a href="./examples-itemviews.htm" translate="no">Item Views Examples</a></li>
                            <li><a>Fetch More Example</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="b-sidebar__content__wrapper">
                <article class="b-sidebar__content__left">
                    <div class="context mainContent" style="margin: 0;padding: 0; background: 0;">
                    

<div class="context">
<h1 class="title">Fetch More Example</h1>
<span class="subtitle"></span>
<!-- $$$itemviews/fetchmore-brief -->
<p>The Fetch More example shows how to add items to an item view model on demand.</p>
<!-- @@@itemviews/fetchmore -->
<!-- $$$itemviews/fetchmore-description -->
<div class="descr"> <a name="details"></a>
<p class="centerAlign"><img alt="" src="./images/fetchmore-example.png"></p><p>This example consists of a dialog where you can enter a directory name in the <b translate="no">Directory</b> edit field. The application loads and visualizes all files it finds as you are typing. It is not required to press [Enter] to launch the search.</p>
<p>When you have large - or perhaps even infinite - data sets, you will need to add items to the model in batches, and preferably only when the items are needed by the view (i.e., when they are visible in the view).</p>
<p>In this example, we implement <code translate="no">FileListModel</code> - an item view model containing the entries of a directory. We also have <code translate="no">Window</code>, which sets up the GUI and feeds the model with directories.</p>
<p>Let's take a tour of <code translate="no">FileListModel</code>'s code.</p>
<a name="filelistmodel-class-definition"></a>
<h4 id="filelistmodel-class-definition">FileListModel Class Definition<a class="plink" href="#filelistmodel-class-definition" title="Direct link to this headline"></a></h4>
<p>The <code translate="no">FileListModel</code> inherits <a href="./qabstractlistmodel.htm" translate="no">QAbstractListModel</a> and contains the contents of a directory. It will add items to itself only when requested to do so by the view.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="keyword">class</span> FileListModel : <span class="keyword">public</span> <span class="type"><a href="./qabstractlistmodel.htm" translate="no">QAbstractListModel</a></span>
{
    Q_OBJECT

<span class="keyword">public</span>:
    FileListModel(<span class="type"><a href="./qobject.htm" translate="no">QObject</a></span> <span class="operator">*</span>parent <span class="operator">=</span> nullptr);

    <span class="type">int</span> rowCount(<span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>parent <span class="operator">=</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span>()) <span class="keyword">const</span> override;
    <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> data(<span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>index<span class="operator">,</span> <span class="type">int</span> role <span class="operator">=</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>DisplayRole) <span class="keyword">const</span> override;

<span class="keyword">signals</span>:
    <span class="type">void</span> numberPopulated(<span class="type">int</span> number);

<span class="keyword">public</span> <span class="keyword">slots</span>:
    <span class="type">void</span> setDirPath(<span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> <span class="operator">&amp;</span>path);

<span class="keyword">protected</span>:
    bool canFetchMore(<span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>parent) <span class="keyword">const</span> override;
    <span class="type">void</span> fetchMore(<span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>parent) override;

<span class="keyword">private</span>:
    <span class="type"><a href="./qstringlist.htm" translate="no">QStringList</a></span> fileList;
    <span class="type">int</span> fileCount;
};</pre></div>
<p>The secret lies in the reimplementation of <a href="./qabstractitemmodel.htm#fetchMore" translate="no">fetchMore()</a> and <a href="./qabstractitemmodel.htm#canFetchMore" translate="no">canFetchMore()</a> from <a href="./qabstractitemmodel.htm" translate="no">QAbstractItemModel</a>. These functions are called by the item view when it needs more items.</p>
<p>The <code translate="no">setDirPath()</code> function sets the directory the model will work on. We emit <code translate="no">numberPopulated()</code> each time we add a batch of items to the model.</p>
<p>We keep all directory entries in <code translate="no">fileList</code>. <code translate="no">fileCount</code> is the number of items that have been added to the model.</p>
<a name="filelistmodel-class-implementation"></a>
<h4 id="filelistmodel-class-implementation">FileListModel Class Implementation<a class="plink" href="#filelistmodel-class-implementation" title="Direct link to this headline"></a></h4>
<p>We start by checking out the <code translate="no">setDirPath()</code>.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> FileListModel<span class="operator">::</span>setDirPath(<span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> <span class="operator">&amp;</span>path)
{
    <span class="type"><a href="./qdir.htm" translate="no">QDir</a></span> dir(path);

    beginResetModel();
    fileList <span class="operator">=</span> dir<span class="operator">.</span>entryList();
    fileCount <span class="operator">=</span> <span class="number">0</span>;
    endResetModel();
}</pre></div>
<p>We use a <a href="./qdir.htm" translate="no">QDir</a> to get the contents of the directory. We need to inform <a href="./qabstractitemmodel.htm" translate="no">QAbstractItemModel</a> that we want to remove all items - if any - from the model.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">bool FileListModel<span class="operator">::</span>canFetchMore(<span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>parent) <span class="keyword">const</span>
{
    <span class="keyword">if</span> (parent<span class="operator">.</span>isValid())
        <span class="keyword">return</span> <span class="keyword">false</span>;
    <span class="keyword">return</span> (fileCount <span class="operator">&lt;</span> fileList<span class="operator">.</span>size());
}</pre></div>
<p>The <code translate="no">canFetchMore()</code> function is called by the view when it needs more items. We return true if there still are entries that we have not added to the model; otherwise, we return false.</p>
<p>And now, the <code translate="no">fetchMore()</code> function itself:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> FileListModel<span class="operator">::</span>fetchMore(<span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>parent)
{
    <span class="keyword">if</span> (parent<span class="operator">.</span>isValid())
        <span class="keyword">return</span>;
    <span class="type">int</span> remainder <span class="operator">=</span> fileList<span class="operator">.</span>size() <span class="operator">-</span> fileCount;
    <span class="type">int</span> itemsToFetch <span class="operator">=</span> <a href="./qtglobal.htm#qMin" translate="no">qMin</a>(<span class="number">100</span><span class="operator">,</span> remainder);

    <span class="keyword">if</span> (itemsToFetch <span class="operator">&lt;</span><span class="operator">=</span> <span class="number">0</span>)
        <span class="keyword">return</span>;

    beginInsertRows(<span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span>()<span class="operator">,</span> fileCount<span class="operator">,</span> fileCount <span class="operator">+</span> itemsToFetch <span class="operator">-</span> <span class="number">1</span>);

    fileCount <span class="operator">+</span><span class="operator">=</span> itemsToFetch;

    endInsertRows();

    <span class="keyword">emit</span> numberPopulated(itemsToFetch);
}</pre></div>
<p>We first calculate the number of items to fetch. <a href="./qabstractitemmodel.htm#beginInsertRows" translate="no">beginInsertRows()</a> and <a href="./qabstractitemmodel.htm#endInsertRows" translate="no">endInsertRows()</a> are mandatory for <a href="./qabstractitemmodel.htm" translate="no">QAbstractItemModel</a> to keep up with the row insertions. Finally, we emit <code translate="no">numberPopulated()</code>, which is picked up by <code translate="no">Window</code>.</p>
<p>To complete the tour, we also look at <code translate="no">rowCount()</code> and <code translate="no">data()</code>.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">int</span> FileListModel<span class="operator">::</span>rowCount(<span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>parent) <span class="keyword">const</span>
{
    <span class="keyword">return</span> parent<span class="operator">.</span>isValid() <span class="operator">?</span> <span class="number">0</span> : fileCount;
}

<span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span> FileListModel<span class="operator">::</span>data(<span class="keyword">const</span> <span class="type"><a href="./qmodelindex.htm" translate="no">QModelIndex</a></span> <span class="operator">&amp;</span>index<span class="operator">,</span> <span class="type">int</span> role) <span class="keyword">const</span>
{
    <span class="keyword">if</span> (<span class="operator">!</span>index<span class="operator">.</span>isValid())
        <span class="keyword">return</span> <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span>();

    <span class="keyword">if</span> (index<span class="operator">.</span>row() <span class="operator">&gt;</span><span class="operator">=</span> fileList<span class="operator">.</span>size() <span class="operator">|</span><span class="operator">|</span> index<span class="operator">.</span>row() <span class="operator">&lt;</span> <span class="number">0</span>)
        <span class="keyword">return</span> <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span>();

    <span class="keyword">if</span> (role <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>DisplayRole) {
        <span class="keyword">return</span> fileList<span class="operator">.</span>at(index<span class="operator">.</span>row());
    } <span class="keyword">else</span> <span class="keyword">if</span> (role <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>BackgroundRole) {
        <span class="type">int</span> batch <span class="operator">=</span> (index<span class="operator">.</span>row() <span class="operator">/</span> <span class="number">100</span>) <span class="operator">%</span> <span class="number">2</span>;
        <span class="keyword">if</span> (batch <span class="operator">=</span><span class="operator">=</span> <span class="number">0</span>)
            <span class="keyword">return</span> <a href="./qapplication.htm#qApp" translate="no">qApp</a><span class="operator">-</span><span class="operator">&gt;</span>palette()<span class="operator">.</span>base();
        <span class="keyword">else</span>
            <span class="keyword">return</span> <a href="./qapplication.htm#qApp" translate="no">qApp</a><span class="operator">-</span><span class="operator">&gt;</span>palette()<span class="operator">.</span>alternateBase();
    }
    <span class="keyword">return</span> <span class="type"><a href="./qvariant.htm" translate="no">QVariant</a></span>();
}</pre></div>
<p>Notice that the row count is only the items we have added so far, i.e., not the number of entries in the directory.</p>
<p>In <code translate="no">data()</code>, we return the appropriate entry from the <code translate="no">fileList</code>. We also separate the batches with a different background color.</p>
<p><a href="https://code.qt.io/cgit/qt/qtbase.git/tree/examples/widgets/itemviews/fetchmore?h=5.15" translate="no">Example project @ code.qt.io</a></p>
</div>
<!-- @@@itemviews/fetchmore -->
</div>
<p class="copy-notice">
<acronym title="Copyright">Â©</acronym> 2025 The Qt Company Ltd.
   Documentation contributions included herein are the copyrights of
   their respective owners.     The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the Free Software Foundation.     Qt and respective logos are <a href="https://doc.qt.io/qt/trademarks.html">    trademarks</a> of The Qt Company Ltd. in Finland and/or other countries
   worldwide. All other trademarks are property of their respective owners. </p>

                    </div>
                </article>
                
            </div>
        </div>
    </div>
</div>
</body></html>