<html lang="en"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Part 5 - Adding a Find Function | Qt Widgets</title>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <!-- Google Tag Manager -->
    
  <!-- End Google Tag Manager -->
  
  
</head>
<body class="qt-design-system" style="background:var(--content-bg-color)" onload="prettyPrint()">

<div data-global-resource-path="qt-design-system/components/b-sidebar.html">
    <div class="b-sidebar b-sidebar--full-width">
        
        <div class="b-sidebar__content">
            <div class="b-sidebar__topbar" data-margin-bottom="sm">
                <div class="b-topbar">
                                        <div class="b-topbar__breadcrump" translate="no">
                        <ul class="c-breadcrump">
                            <li><a href="./index.htm" translate="no">Qt 5.15</a></li>
                            <li><a href="./qtwidgets-index.htm" translate="no">Qt Widgets</a></li>
                            <li><a>Part 5 - Adding a Find Function</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="b-sidebar__content__wrapper">
                <article class="b-sidebar__content__left">
                    <div class="context mainContent" style="margin: 0;padding: 0; background: 0;">
                    

<div class="context">
<h1 class="title">Part 5 - Adding a Find Function</h1>
<span class="subtitle"></span>
<!-- $$$tutorials/addressbook/part5-brief -->
<p>Describes how to add a find function.</p>
<!-- @@@tutorials/addressbook/part5 -->
<!-- $$$tutorials/addressbook/part5-description -->
<div class="descr"> <a name="details"></a>
<p>Here we look at ways to locate contacts and addresses in the address book.</p>
<p class="centerAlign"><img alt="" src="./images/addressbook-tutorial-part5-screenshot.png"></p><p>As we add contacts to our address book, it becomes tedious to navigate the list with the <i>Next</i> and <i>Previous</i> buttons. A <i>Find</i> function would be more efficient. The screenshot above shows the <i>Find</i> button and its position on the panel of buttons.</p>
<p>When the user clicks on the <i>Find</i> button, it is useful to display a dialog that prompts for a contact's name. Qt provides <a href="./qdialog.htm" translate="no">QDialog</a>, which we subclass here to implement a <code translate="no">FindDialog</code> class.</p>
<a name="defining-the-finddialog-class"></a>
<h4 id="defining-the-finddialog-class">Defining the FindDialog Class<a class="plink" href="#defining-the-finddialog-class" title="Direct link to this headline"></a></h4>
<p class="centerAlign"><img alt="" src="./images/addressbook-tutorial-part5-finddialog.png"></p><p>In order to subclass <a href="./qdialog.htm" translate="no">QDialog</a>, we first include the header for <a href="./qdialog.htm" translate="no">QDialog</a> in the <code translate="no">finddialog.h</code> file. Also, we use forward declaration to declare <a href="./qlineedit.htm" translate="no">QLineEdit</a> and <a href="./qpushbutton.htm" translate="no">QPushButton</a> since we will be using those widgets in our dialog class.</p>
<p>As in our <code translate="no">AddressBook</code> class, the <code translate="no">FindDialog</code> class includes the <a href="./qobject.htm#Q_OBJECT" translate="no">Q_OBJECT</a> macro and its constructor is defined to accept a parent <a href="./qwidget.htm" translate="no">QWidget</a>, even though the dialog will be opened as a separate window.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="preprocessor">#include &lt;QDialog&gt;</span>

<span class="keyword">class</span> <span class="type"><a href="./qlineedit.htm" translate="no">QLineEdit</a></span>;
<span class="keyword">class</span> <span class="type"><a href="./qpushbutton.htm" translate="no">QPushButton</a></span>;

<span class="keyword">class</span> FindDialog : <span class="keyword">public</span> <span class="type"><a href="./qdialog.htm" translate="no">QDialog</a></span>
{
    Q_OBJECT

<span class="keyword">public</span>:
    FindDialog(<span class="type"><a href="./qwidget.htm" translate="no">QWidget</a></span> <span class="operator">*</span>parent <span class="operator">=</span> nullptr);
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> getFindText();

<span class="keyword">public</span> <span class="keyword">slots</span>:
    <span class="type">void</span> findClicked();

<span class="keyword">private</span>:
    <span class="type"><a href="./qpushbutton.htm" translate="no">QPushButton</a></span> <span class="operator">*</span>findButton;
    <span class="type"><a href="./qlineedit.htm" translate="no">QLineEdit</a></span> <span class="operator">*</span>lineEdit;
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> findText;
};</pre></div>
<p>We define a public function, <code translate="no">getFindText()</code>, to be used by classes that instantiate <code translate="no">FindDialog</code>. This function allows these classes to obtain the search string entered by the user. A public slot, <code translate="no">findClicked()</code>, is also defined to handle the search string when the user clicks the <b translate="no">Find</b> button.</p>
<p>Lastly, we define the private variables, <code translate="no">findButton</code>, <code translate="no">lineEdit</code> and <code translate="no">findText</code>, corresponding to the <b translate="no">Find</b> button, the line edit into which the user types the search string, and an internal string used to store the search string for later use.</p>
<a name="implementing-the-finddialog-class"></a>
<h4 id="implementing-the-finddialog-class">Implementing the FindDialog Class<a class="plink" href="#implementing-the-finddialog-class" title="Direct link to this headline"></a></h4>
<p>Within the constructor of <code translate="no">FindDialog</code>, we set up the private variables, <code translate="no">lineEdit</code>, <code translate="no">findButton</code> and <code translate="no">findText</code>. We use a <a href="./qhboxlayout.htm" translate="no">QHBoxLayout</a> to position the widgets.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">FindDialog<span class="operator">::</span>FindDialog(<span class="type"><a href="./qwidget.htm" translate="no">QWidget</a></span> <span class="operator">*</span>parent)
    : <span class="type"><a href="./qdialog.htm" translate="no">QDialog</a></span>(parent)
{
    <span class="type"><a href="./qlabel.htm" translate="no">QLabel</a></span> <span class="operator">*</span>findLabel <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qlabel.htm" translate="no">QLabel</a></span>(tr(<span class="string">"Enter the name of a contact:"</span>));
    lineEdit <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qlineedit.htm" translate="no">QLineEdit</a></span>;

    findButton <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qpushbutton.htm" translate="no">QPushButton</a></span>(tr(<span class="string">"&amp;Find"</span>));
    findText <span class="operator">=</span> <span class="string">""</span>;

    <span class="type"><a href="./qhboxlayout.htm" translate="no">QHBoxLayout</a></span> <span class="operator">*</span>layout <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qhboxlayout.htm" translate="no">QHBoxLayout</a></span>;
    layout<span class="operator">-</span><span class="operator">&gt;</span>addWidget(findLabel);
    layout<span class="operator">-</span><span class="operator">&gt;</span>addWidget(lineEdit);
    layout<span class="operator">-</span><span class="operator">&gt;</span>addWidget(findButton);

    setLayout(layout);
    setWindowTitle(tr(<span class="string">"Find a Contact"</span>));
    connect(findButton<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qpushbutton.htm" translate="no">QPushButton</a></span><span class="operator">::</span>clicked<span class="operator">,</span>
            <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>FindDialog<span class="operator">::</span>findClicked);
    connect(findButton<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qpushbutton.htm" translate="no">QPushButton</a></span><span class="operator">::</span>clicked<span class="operator">,</span>
            <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>FindDialog<span class="operator">::</span>accept);
}</pre></div>
<p>We set the layout and window title, as well as connect the signals to their respective slots. Notice that <code translate="no">findButton</code>'s <a href="./qabstractbutton.htm#clicked" translate="no">clicked()</a> signal is connected to <code translate="no">findClicked()</code> and <a href="./qdialog.htm#accept" translate="no">accept()</a>. The <a href="./qdialog.htm#accept" translate="no">accept()</a> slot provided by <a href="./qdialog.htm" translate="no">QDialog</a> hides the dialog and sets the result code to <a href="./qdialog.htm#DialogCode-enum" translate="no">Accepted</a>. We use this function to help <code translate="no">AddressBook</code>'s <code translate="no">findContact()</code> function know when the <code translate="no">FindDialog</code> object has been closed. We will explain this logic in further detail when discussing the <code translate="no">findContact()</code> function.</p>
<p class="centerAlign"><img alt="" src="./images/addressbook-tutorial-part5-signals-and-slots.png"></p><p>In <code translate="no">findClicked()</code>, we validate <code translate="no">lineEdit</code> to ensure that the user did not click the <b translate="no">Find</b> button without entering a contact's name. Then, we set <code translate="no">findText</code> to the search string, extracted from <code translate="no">lineEdit</code>. After that, we clear the contents of <code translate="no">lineEdit</code> and hide the dialog.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> FindDialog<span class="operator">::</span>findClicked()
{
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> text <span class="operator">=</span> lineEdit<span class="operator">-</span><span class="operator">&gt;</span>text();

    <span class="keyword">if</span> (text<span class="operator">.</span>isEmpty()) {
        <span class="type"><a href="./qmessagebox.htm" translate="no">QMessageBox</a></span><span class="operator">::</span>information(<span class="keyword">this</span><span class="operator">,</span> tr(<span class="string">"Empty Field"</span>)<span class="operator">,</span>
            tr(<span class="string">"Please enter a name."</span>));
        <span class="keyword">return</span>;
    } <span class="keyword">else</span> {
        findText <span class="operator">=</span> text;
        lineEdit<span class="operator">-</span><span class="operator">&gt;</span>clear();
        hide();
    }
}</pre></div>
<p>The <code translate="no">findText</code> variable has a public getter function, <code translate="no">getFindText()</code>, associated with it. Since we only ever set <code translate="no">findText</code> directly in both the constructor and in the <code translate="no">findClicked()</code> function, we do not create a setter function to accompany <code translate="no">getFindText()</code>. Because <code translate="no">getFindText()</code> is public, classes instantiating and using <code translate="no">FindDialog</code> can always access the search string that the user has entered and accepted.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type"><a href="./qstring.htm" translate="no">QString</a></span> FindDialog<span class="operator">::</span>getFindText()
{
    <span class="keyword">return</span> findText;
}</pre></div>
<a name="defining-the-addressbook-class"></a>
<h4 id="defining-the-addressbook-class">Defining the AddressBook Class<a class="plink" href="#defining-the-addressbook-class" title="Direct link to this headline"></a></h4>
<p>To ensure we can use <code translate="no">FindDialog</code> from within our <code translate="no">AddressBook</code> class, we include <code translate="no">finddialog.h</code> in the <code translate="no">addressbook.h</code> file.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="preprocessor">#include "finddialog.h"</span></pre></div>
<p>So far, all our address book features have a <a href="./qpushbutton.htm" translate="no">QPushButton</a> and a corresponding slot. Similarly, for the <b translate="no">Find</b> feature we have <code translate="no">findButton</code> and <code translate="no">findContact()</code>.</p>
<p>The <code translate="no">findButton</code> is declared as a private variable and the <code translate="no">findContact()</code> function is declared as a public slot.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">    <span class="type">void</span> findContact();
    ...
    <span class="type"><a href="./qpushbutton.htm" translate="no">QPushButton</a></span> <span class="operator">*</span>findButton;</pre></div>
<p>Lastly, we declare the private variable, <code translate="no">dialog</code>, which we will use to refer to an instance of <code translate="no">FindDialog</code>.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">    FindDialog <span class="operator">*</span>dialog;</pre></div>
<p>Once we have instantiated a dialog, we will want to use it more than once; using a private variable allows us to refer to it from more than one place in the class.</p>
<a name="implementing-the-addressbook-class"></a>
<h4 id="implementing-the-addressbook-class">Implementing the AddressBook Class<a class="plink" href="#implementing-the-addressbook-class" title="Direct link to this headline"></a></h4>
<p>Within the <code translate="no">AddressBook</code> class's constructor, we instantiate our private objects, <code translate="no">findButton</code> and <code translate="no">findDialog</code>:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">    findButton <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qpushbutton.htm" translate="no">QPushButton</a></span>(tr(<span class="string">"&amp;Find"</span>));
    findButton<span class="operator">-</span><span class="operator">&gt;</span>setEnabled(<span class="keyword">false</span>);
    ...
    dialog <span class="operator">=</span> <span class="keyword">new</span> FindDialog(<span class="keyword">this</span>);</pre></div>
<p>Next, we connect the <code translate="no">findButton</code>'s <a href="./qabstractbutton.htm#clicked" translate="no">clicked()</a> signal to <code translate="no">findContact()</code>.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">    connect(findButton<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qpushbutton.htm" translate="no">QPushButton</a></span><span class="operator">::</span>clicked<span class="operator">,</span>
            <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>AddressBook<span class="operator">::</span>findContact);</pre></div>
<p>Now all that is left is the code for our <code translate="no">findContact()</code> function:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> AddressBook<span class="operator">::</span>findContact()
{
    dialog<span class="operator">-</span><span class="operator">&gt;</span>show();

    <span class="keyword">if</span> (dialog<span class="operator">-</span><span class="operator">&gt;</span>exec() <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="./qdialog.htm" translate="no">QDialog</a></span><span class="operator">::</span>Accepted) {
        <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> contactName <span class="operator">=</span> dialog<span class="operator">-</span><span class="operator">&gt;</span>getFindText();

        <span class="keyword">if</span> (contacts<span class="operator">.</span>contains(contactName)) {
            nameLine<span class="operator">-</span><span class="operator">&gt;</span>setText(contactName);
            addressText<span class="operator">-</span><span class="operator">&gt;</span>setText(contacts<span class="operator">.</span>value(contactName));
        } <span class="keyword">else</span> {
            <span class="type"><a href="./qmessagebox.htm" translate="no">QMessageBox</a></span><span class="operator">::</span>information(<span class="keyword">this</span><span class="operator">,</span> tr(<span class="string">"Contact Not Found"</span>)<span class="operator">,</span>
                tr(<span class="string">"Sorry, \"%1\" is not in your address book."</span>)<span class="operator">.</span>arg(contactName));
            <span class="keyword">return</span>;
        }
    }

    updateInterface(NavigationMode);
}</pre></div>
<p>We start out by displaying the <code translate="no">FindDialog</code> instance, <code translate="no">dialog</code>. This is when the user enters a contact name to look up. Once the user clicks the dialog's <code translate="no">findButton</code>, the dialog is hidden and the result code is set to <a href="./qdialog.htm#DialogCode-enum" translate="no">QDialog::Accepted</a>. This ensures that our <code translate="no">if</code> statement is always true.</p>
<p>We then proceed to extract the search string, which in this case is <code translate="no">contactName</code>, using <code translate="no">FindDialog</code>'s <code translate="no">getFindText()</code> function. If the contact exists in our address book, we display it immediately. Otherwise, we display the <a href="./qmessagebox.htm" translate="no">QMessageBox</a> shown below to indicate that their search failed.</p>
<p class="centerAlign"><img alt="" src="./images/addressbook-tutorial-part5-notfound.png"></p><p><a href="https://code.qt.io/cgit/qt/qtbase.git/tree/examples/widgets/tutorials/addressbook/part5?h=5.15" translate="no">Example project @ code.qt.io</a></p>
</div>
<!-- @@@tutorials/addressbook/part5 -->
</div>
<p class="copy-notice">
<acronym title="Copyright">Â©</acronym> 2025 The Qt Company Ltd.
   Documentation contributions included herein are the copyrights of
   their respective owners.     The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the Free Software Foundation.     Qt and respective logos are <a href="https://doc.qt.io/qt/trademarks.html">    trademarks</a> of The Qt Company Ltd. in Finland and/or other countries
   worldwide. All other trademarks are property of their respective owners. </p>

                    </div>
                </article>
                
            </div>
        </div>
    </div>
</div>
</body></html>