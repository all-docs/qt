<html lang="en"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Using Precompiled Headers | qmake Manual</title>
<link rel="canonical" href="https://doc.qt.io/qt-6/qmake-precompiledheaders.html">
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <!-- Google Tag Manager -->
    
  <!-- End Google Tag Manager -->
  
  
</head>
<body class="qt-design-system" style="background:var(--content-bg-color)" onload="prettyPrint()">

<div data-global-resource-path="qt-design-system/components/b-sidebar.html">
    <div class="b-sidebar b-sidebar--full-width">
        
        <div class="b-sidebar__content">
            <div class="b-sidebar__topbar" data-margin-bottom="sm">
                <div class="b-topbar">
                                        <div class="b-topbar__breadcrump" translate="no">
                        <ul class="c-breadcrump">
                            <li><a href="./index.htm" translate="no">Qt 5.15</a></li>
                            <li><a href="./qmake-manual.htm" translate="no">qmake Manual</a></li>
                            <li><a>Using Precompiled Headers</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="b-sidebar__content__wrapper">
                <article class="b-sidebar__content__left">
                    <div class="context mainContent" style="margin: 0;padding: 0; background: 0;">
                    
<link href="qmake-advanced-usage.html" rel="prev">
<link href="qmake-environment-reference.html" rel="next">
<p class="naviNextPrevious headerNavi">
<a class="" href="./qmake-advanced-usage.htm">Advanced Usage</a>
<a class="" href="./qmake-environment-reference.htm">Configuring qmake</a>
</p><p></p>

<div class="context">
<h1 class="title">Using Precompiled Headers</h1>
<span class="subtitle"></span>
<!-- $$$qmake-precompiledheaders.html-description -->
<div class="descr"> <a name="details"></a>
<a name="introduction"></a><p>Precompiled headers (PCH) are a performance feature supported by some compilers to compile a stable body of code, and store the compiled state of the code in a binary file. During subsequent compilations, the compiler will load the stored state, and continue compiling the specified file. Each subsequent compilation is faster because the stable code does not need to be recompiled.</p>
<p>qmake supports the use of precompiled headers on some platforms and build environments, including:</p>
<ul>
<li>Windows<ul>
<li>nmake</li>
<li>Visual Studio projects (VS 2008 and later)</li>
</ul>
</li>
<li>macOS, iOS, tvOS, and watchOS<ul>
<li>Makefile</li>
<li>Xcode</li>
</ul>
</li>
<li>Unix<ul>
<li>GCC 3.4 and above</li>
<li>clang</li>
</ul>
</li>
</ul>
<a name="add-pch"></a><a name="adding-precompiled-headers-to-your-project"></a>
<h2 id="adding-precompiled-headers-to-your-project">Adding Precompiled Headers to Your Project<a class="plink" href="#adding-precompiled-headers-to-your-project" title="Direct link to this headline"></a></h2>
<p>The precompiled header must contain code which is <i>stable</i> and <i>static</i> throughout your project. A typical precompiled header might look like this:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="comment">// Add C includes here</span>

<span class="preprocessor">#if defined __cplusplus</span>
<span class="comment">// Add C++ includes here</span>
<span class="preprocessor">#include &lt;stdlib&gt;</span>
<span class="preprocessor">#include &lt;iostream&gt;</span>
<span class="preprocessor">#include &lt;vector&gt;</span>
<span class="preprocessor">#include &lt;QApplication&gt; // Qt includes</span>
<span class="preprocessor">#include &lt;QPushButton&gt;</span>
<span class="preprocessor">#include &lt;QLabel&gt;</span>
<span class="preprocessor">#include "thirdparty/include/libmain.h"</span>
<span class="preprocessor">#include "my_stable_class.h"</span>
<span class="operator">.</span><span class="operator">.</span><span class="operator">.</span>
<span class="preprocessor">#endif</span></pre></div>
<div class="admonition note">
<p><b>Note: </b>A precompiled header file needs to separate C includes from C++ includes, since the precompiled header file for C files may not contain C++ code.</p>
</div>
<a name="project-options"></a><a name="project-options"></a>
<h3 id="project-options">Project Options<a class="plink" href="#project-options" title="Direct link to this headline"></a></h3>
<p>To make your project use precompiled headers, you only need to define the <a href="./qmake-variable-reference.htm#precompiled-header" translate="no">PRECOMPILED_HEADER</a> variable in your project file:</p>
<div class="pre"><pre class="cpp" translate="no">PRECOMPILED_HEADER = stable.h</pre></div>
<p>qmake will handle the rest, to ensure the creation and use of the precompiled header file. You do not need to include the precompiled header file in <code translate="no">HEADERS</code>, as qmake will do this if the configuration supports precompiled headers.</p>
<p>The MSVC and g++ specs targeting Windows enable <code translate="no">precompile_header</code> by default.</p>
<p>Using this option, you may trigger conditional blocks in your project file to add settings when using precompiled headers. For example:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">precompile_header:!isEmpty(PRECOMPILED_HEADER) {
DEFINES += USING_PCH
}</pre></div>
<p>To use the precompiled header also for C files on MSVC nmake target, add <code translate="no">precompile_header_c</code> to the <a href="./qmake-variable-reference.htm#config" translate="no">CONFIG</a> variable. If the header is used also for C++ and it contains C++ keywords/includes, enclose them with <code translate="no">#ifdef __cplusplus</code>).</p>
<a name="notes-on-possible-issues"></a>
<h2 id="notes-on-possible-issues">Notes on Possible Issues<a class="plink" href="#notes-on-possible-issues" title="Direct link to this headline"></a></h2>
<p>On some platforms, the file name suffix for precompiled header files is the same as that for other object files. For example, the following declarations may cause two different object files with the same name to be generated:</p>
<div class="pre"><pre class="cpp" translate="no">PRECOMPILED_HEADER = window.h
SOURCES            = window.cpp</pre></div>
<p>To avoid potential conflicts like these, give distinctive names to header files that will be precompiled.</p>
<a name="example-project"></a><a name="example-project"></a>
<h2 id="example-project">Example Project<a class="plink" href="#example-project" title="Direct link to this headline"></a></h2>
<p>You can find the following source code in the <code translate="no">examples/qmake/precompile</code> directory in the Qt distribution:</p>
<a name="mydialog-op-op-ui"></a>
<h3 id="mydialog-op-op-ui"><code translate="no">mydialog.ui</code><a class="plink" href="#mydialog-op-op-ui" title="Direct link to this headline"></a></h3>
<p>The following image displays the mydialog.ui file in Qt Creator Design mode. You can view the code in the Edit mode.</p>
<p class="centerAlign"><img alt="" src="./images/qmake-precompile-ui.png"></p><a name="stable-op-op-h"></a>
<h3 id="stable-op-op-h"><code translate="no">stable.h</code><a class="plink" href="#stable-op-op-h" title="Direct link to this headline"></a></h3>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="comment">/* Add C includes here */</span>

<span class="preprocessor">#if defined __cplusplus</span>
<span class="comment">/* Add C++ includes here */</span>

<span class="preprocessor"># include &lt;iostream&gt;</span>
<span class="preprocessor"># include &lt;QApplication&gt;</span>
<span class="preprocessor"># include &lt;QPushButton&gt;</span>
<span class="preprocessor"># include &lt;QLabel&gt;</span>
<span class="preprocessor">#endif</span></pre></div>
<a name="myobject-op-op-h"></a>
<h3 id="myobject-op-op-h"><code translate="no">myobject.h</code><a class="plink" href="#myobject-op-op-h" title="Direct link to this headline"></a></h3>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="preprocessor">#include &lt;QObject&gt;</span>

<span class="keyword">class</span> MyObject : <span class="keyword">public</span> <span class="type"><a href="./qobject.htm" translate="no">QObject</a></span>
{
<span class="keyword">public</span>:
    MyObject();
    <span class="operator">~</span>MyObject();
};</pre></div>
<a name="myobject-op-op-cpp"></a>
<h3 id="myobject-op-op-cpp"><code translate="no">myobject.cpp</code><a class="plink" href="#myobject-op-op-cpp" title="Direct link to this headline"></a></h3>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="preprocessor">#include &lt;iostream&gt;</span>
<span class="preprocessor">#include &lt;QDebug&gt;</span>
<span class="preprocessor">#include &lt;QObject&gt;</span>
<span class="preprocessor">#include "myobject.h"</span>

MyObject<span class="operator">::</span>MyObject()
    : <span class="type"><a href="./qobject.htm" translate="no">QObject</a></span>()
{
    std<span class="operator">::</span>cout <span class="operator">&lt;</span><span class="operator">&lt;</span> <span class="string">"MyObject::MyObject()\n"</span>;
}</pre></div>
<a name="util-op-op-cpp"></a>
<h3 id="util-op-op-cpp"><code translate="no">util.cpp</code><a class="plink" href="#util-op-op-cpp" title="Direct link to this headline"></a></h3>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> util_function_does_nothing()
{
    <span class="comment">// Nothing here...</span>
    <span class="type">int</span> x <span class="operator">=</span> <span class="number">0</span>;
    <span class="operator">+</span><span class="operator">+</span>x;
}</pre></div>
<a name="main-op-op-cpp"></a>
<h3 id="main-op-op-cpp"><code translate="no">main.cpp</code><a class="plink" href="#main-op-op-cpp" title="Direct link to this headline"></a></h3>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="preprocessor">#include &lt;QApplication&gt;</span>
<span class="preprocessor">#include &lt;QPushButton&gt;</span>
<span class="preprocessor">#include &lt;QLabel&gt;</span>
<span class="preprocessor">#include "myobject.h"</span>
<span class="preprocessor">#include "mydialog.h"</span>

<span class="type">int</span> main(<span class="type">int</span> argc<span class="operator">,</span> <span class="type">char</span> <span class="operator">*</span><span class="operator">*</span>argv)
{
    <span class="type"><a href="./qapplication.htm" translate="no">QApplication</a></span> app(argc<span class="operator">,</span> argv);

    MyObject obj;
    MyDialog dialog;

    dialog<span class="operator">.</span>connect(dialog<span class="operator">.</span>aButton<span class="operator">,</span> SIGNAL(clicked())<span class="operator">,</span> SLOT(close()));
    dialog<span class="operator">.</span>show();

    <span class="keyword">return</span> app<span class="operator">.</span>exec();
}</pre></div>
<a name="precompile-op-op-pro"></a>
<h3 id="precompile-op-op-pro"><code translate="no">precompile.pro</code><a class="plink" href="#precompile-op-op-pro" title="Direct link to this headline"></a></h3>
<div class="pre"><pre class="cpp prettyprint" translate="no">TEMPLATE  <span class="operator">=</span> app
LANGUAGE  <span class="operator">=</span> C<span class="operator">+</span><span class="operator">+</span>
CONFIG   <span class="operator">+</span><span class="operator">=</span> cmdline precompile_header

<span class="preprocessor"># Use Precompiled headers (PCH)</span>
PRECOMPILED_HEADER  <span class="operator">=</span> stable<span class="operator">.</span>h

HEADERS   <span class="operator">=</span> stable<span class="operator">.</span>h \
            mydialog<span class="operator">.</span>h \
            myobject<span class="operator">.</span>h
SOURCES   <span class="operator">=</span> main<span class="operator">.</span>cpp \
            mydialog<span class="operator">.</span>cpp \
            myobject<span class="operator">.</span>cpp \
            util<span class="operator">.</span>cpp
FORMS     <span class="operator">=</span> mydialog<span class="operator">.</span>ui</pre></div>
</div>
<!-- @@@qmake-precompiledheaders.html -->
<p class="naviNextPrevious footerNavi">
<a class="prevPage" href="./qmake-advanced-usage.htm">Advanced Usage</a>
<a class="nextPage" href="./qmake-environment-reference.htm">Configuring qmake</a>
</p>
</div>
<p class="copy-notice">
<acronym title="Copyright">Â©</acronym> 2025 The Qt Company Ltd.
   Documentation contributions included herein are the copyrights of
   their respective owners.     The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the Free Software Foundation.     Qt and respective logos are <a href="https://doc.qt.io/qt/trademarks.html">    trademarks</a> of The Qt Company Ltd. in Finland and/or other countries
   worldwide. All other trademarks are property of their respective owners. </p>

                    </div>
                </article>
                
            </div>
        </div>
    </div>
</div>
</body></html>