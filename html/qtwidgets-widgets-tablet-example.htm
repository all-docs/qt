<html lang="en"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Tablet Example | Qt Widgets</title>
<link rel="canonical" href="https://doc.qt.io/qt-6/qtwidgets-widgets-tablet-example.html">
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <!-- Google Tag Manager -->
    
  <!-- End Google Tag Manager -->
  
  
</head>
<body class="qt-design-system" style="background:var(--content-bg-color)" onload="prettyPrint()">

<div data-global-resource-path="qt-design-system/components/b-sidebar.html">
    <div class="b-sidebar b-sidebar--full-width">
        
        <div class="b-sidebar__content">
            <div class="b-sidebar__topbar" data-margin-bottom="sm">
                <div class="b-topbar">
                                        <div class="b-topbar__breadcrump" translate="no">
                        <ul class="c-breadcrump">
                            <li><a href="./index.htm" translate="no">Qt 5.15</a></li>
                            <li><a href="./qtwidgets-index.htm" translate="no">Qt Widgets</a></li>
                            <li><a href="./examples-widgets.htm" translate="no">Qt Widgets Examples</a></li>
                            <li><a>Tablet Example</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="b-sidebar__content__wrapper">
                <article class="b-sidebar__content__left">
                    <div class="context mainContent" style="margin: 0;padding: 0; background: 0;">
                    

<div class="context">
<h1 class="title">Tablet Example</h1>
<span class="subtitle"></span>
<!-- $$$widgets/tablet-brief -->
<p>This example shows how to use a Wacom tablet in Qt applications.</p>
<!-- @@@widgets/tablet -->
<!-- $$$widgets/tablet-description -->
<div class="descr"> <a name="details"></a>
<p class="centerAlign"><img alt="" src="./images/tabletexample.png"></p><p>When you use a tablet with Qt applications, <a href="./qtabletevent.htm" translate="no">QTabletEvent</a>s are generated. You need to reimplement the <a href="./qwidget.htm#tabletEvent" translate="no">tabletEvent()</a> event handler if you want to handle tablet events. Events are generated when the tool (stylus) used for drawing enters and leaves the proximity of the tablet (i.e., when it is close but not pressed down on it), when the tool is pressed down and released from it, when the tool is moved across the tablet, and when one of the buttons on the tool is pressed or released.</p>
<p>The information available in <a href="./qtabletevent.htm" translate="no">QTabletEvent</a> depends on the device used. This example can handle a tablet with up to three different drawing tools: a stylus, an airbrush, and an art pen. For any of these the event will contain the position of the tool, pressure on the tablet, button status, vertical tilt, and horizontal tilt (i.e, the angle between the device and the perpendicular of the tablet, if the tablet hardware can provide it). The airbrush has a finger wheel; the position of this is also available in the tablet event. The art pen provides rotation around the axis perpendicular to the tablet surface, so that it can be used for calligraphy.</p>
<p>In this example we implement a drawing program. You can use the stylus to draw on the tablet as you use a pencil on paper. When you draw with the airbrush you get a spray of virtual paint; the finger wheel is used to change the density of the spray. When you draw with the art pen, you get a a line whose width and endpoint angle depend on the rotation of the pen. The pressure and tilt can also be assigned to change the alpha and saturation values of the color and the width of the stroke.</p>
<p>The example consists of the following:</p>
<ul>
<li>The <code translate="no">MainWindow</code> class inherits <a href="./qmainwindow.htm" translate="no">QMainWindow</a>, creates the menus, and connects their slots and signals.</li>
<li>The <code translate="no">TabletCanvas</code> class inherits <a href="./qwidget.htm" translate="no">QWidget</a> and receives tablet events. It uses the events to paint onto an offscreen pixmap, and then renders it.</li>
<li>The <code translate="no">TabletApplication</code> class inherits <a href="./qapplication.htm" translate="no">QApplication</a>. This class handles tablet proximity events.</li>
<li>The <code translate="no">main()</code> function creates a <code translate="no">MainWindow</code> and shows it as a top level window.</li>
</ul>
<a name="mainwindow-class-definition"></a>
<h4 id="mainwindow-class-definition">MainWindow Class Definition<a class="plink" href="#mainwindow-class-definition" title="Direct link to this headline"></a></h4>
<p>The <code translate="no">MainWindow</code> creates a <code translate="no">TabletCanvas</code> and sets it as its center widget.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="keyword">class</span> MainWindow : <span class="keyword">public</span> <span class="type"><a href="./qmainwindow.htm" translate="no">QMainWindow</a></span>
{
    Q_OBJECT

<span class="keyword">public</span>:
    MainWindow(TabletCanvas <span class="operator">*</span>canvas);

<span class="keyword">private</span> <span class="keyword">slots</span>:
    <span class="type">void</span> setBrushColor();
    <span class="type">void</span> setAlphaValuator(<span class="type"><a href="./qaction.htm" translate="no">QAction</a></span> <span class="operator">*</span>action);
    <span class="type">void</span> setLineWidthValuator(<span class="type"><a href="./qaction.htm" translate="no">QAction</a></span> <span class="operator">*</span>action);
    <span class="type">void</span> setSaturationValuator(<span class="type"><a href="./qaction.htm" translate="no">QAction</a></span> <span class="operator">*</span>action);
    <span class="type">void</span> setEventCompression(bool compress);
    bool save();
    <span class="type">void</span> load();
    <span class="type">void</span> clear();
    <span class="type">void</span> about();

<span class="keyword">private</span>:
    <span class="type">void</span> createMenus();

    TabletCanvas <span class="operator">*</span>m_canvas;
    <span class="type"><a href="./qcolordialog.htm" translate="no">QColorDialog</a></span> <span class="operator">*</span>m_colorDialog <span class="operator">=</span> nullptr;
};</pre></div>
<p><code translate="no">createMenus()</code> sets up the menus with the actions. We have one <a href="./qactiongroup.htm" translate="no">QActionGroup</a> for the actions that alter the alpha channel, color saturation and line width respectively. The action groups are connected to the <code translate="no">setAlphaValuator()</code>, <code translate="no">setSaturationValuator()</code>, and <code translate="no">setLineWidthValuator()</code> slots, which call functions in <code translate="no">TabletCanvas</code>.</p>
<a name="mainwindow-class-implementation"></a>
<h4 id="mainwindow-class-implementation">MainWindow Class Implementation<a class="plink" href="#mainwindow-class-implementation" title="Direct link to this headline"></a></h4>
<p>We start with a look at the constructor <code translate="no">MainWindow()</code>:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">MainWindow<span class="operator">::</span>MainWindow(TabletCanvas <span class="operator">*</span>canvas)
    : m_canvas(canvas)
{
    createMenus();
    setWindowTitle(tr(<span class="string">"Tablet Example"</span>));
    setCentralWidget(m_canvas);
    <span class="type"><a href="./qcoreapplication.htm" translate="no">QCoreApplication</a></span><span class="operator">::</span>setAttribute(<span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>AA_CompressHighFrequencyEvents);
}</pre></div>
<p>In the constructor we call <code translate="no">createMenus()</code> to create all the actions and menus, and set the canvas as the center widget.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> MainWindow<span class="operator">::</span>createMenus()
{
    <span class="type"><a href="./qmenu.htm" translate="no">QMenu</a></span> <span class="operator">*</span>fileMenu <span class="operator">=</span> menuBar()<span class="operator">-</span><span class="operator">&gt;</span>addMenu(tr(<span class="string">"&amp;File"</span>));
    fileMenu<span class="operator">-</span><span class="operator">&gt;</span>addAction(tr(<span class="string">"&amp;Open..."</span>)<span class="operator">,</span> <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>MainWindow<span class="operator">::</span>load<span class="operator">,</span> <span class="type"><a href="./qkeysequence.htm" translate="no">QKeySequence</a></span><span class="operator">::</span>Open);
    fileMenu<span class="operator">-</span><span class="operator">&gt;</span>addAction(tr(<span class="string">"&amp;Save As..."</span>)<span class="operator">,</span> <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>MainWindow<span class="operator">::</span>save<span class="operator">,</span> <span class="type"><a href="./qkeysequence.htm" translate="no">QKeySequence</a></span><span class="operator">::</span>SaveAs);
    fileMenu<span class="operator">-</span><span class="operator">&gt;</span>addAction(tr(<span class="string">"&amp;New"</span>)<span class="operator">,</span> <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>MainWindow<span class="operator">::</span>clear<span class="operator">,</span> <span class="type"><a href="./qkeysequence.htm" translate="no">QKeySequence</a></span><span class="operator">::</span>New);
    fileMenu<span class="operator">-</span><span class="operator">&gt;</span>addAction(tr(<span class="string">"E&amp;xit"</span>)<span class="operator">,</span> <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>MainWindow<span class="operator">::</span>close<span class="operator">,</span> <span class="type"><a href="./qkeysequence.htm" translate="no">QKeySequence</a></span><span class="operator">::</span>Quit);

    <span class="type"><a href="./qmenu.htm" translate="no">QMenu</a></span> <span class="operator">*</span>brushMenu <span class="operator">=</span> menuBar()<span class="operator">-</span><span class="operator">&gt;</span>addMenu(tr(<span class="string">"&amp;Brush"</span>));
    brushMenu<span class="operator">-</span><span class="operator">&gt;</span>addAction(tr(<span class="string">"&amp;Brush Color..."</span>)<span class="operator">,</span> <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>MainWindow<span class="operator">::</span>setBrushColor<span class="operator">,</span> tr(<span class="string">"Ctrl+B"</span>));</pre></div>
<p>At the beginning of <code translate="no">createMenus()</code> we populate the <b>File</b> menu. We use an overload of <a href="./qmenu.htm#addAction" translate="no">addAction()</a>, introduced in Qt 5.6, to create a menu item with a shortcut (and optionally an icon), add it to its menu, and connect it to a slot, all with one line of code. We use <a href="./qkeysequence.htm" translate="no">QKeySequence</a> to get the platform-specific standard key shortcuts for these common menu items.</p>
<p>We also populate the <b>Brush</b> menu. The command to change a brush does not normally have a standard shortcut, so we use <a href="./qobject.htm#tr" translate="no">tr()</a> to enable translating the shortcut along with the language translation of the application.</p>
<p>Now we will look at the creation of one group of mutually-exclusive actions in a submenu of the <b>Tablet</b> menu, for selecting which property of each <a href="./qtabletevent.htm" translate="no">QTabletEvent</a> will be used to vary the translucency (alpha channel) of the line being drawn or color being airbrushed. (See the <a href="./qtwidgets-mainwindows-application-example.htm" translate="no">application example</a> if you want a high-level introduction to QActions.)</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">    <span class="type"><a href="./qmenu.htm" translate="no">QMenu</a></span> <span class="operator">*</span>alphaChannelMenu <span class="operator">=</span> tabletMenu<span class="operator">-</span><span class="operator">&gt;</span>addMenu(tr(<span class="string">"&amp;Alpha Channel"</span>));
    <span class="type"><a href="./qaction.htm" translate="no">QAction</a></span> <span class="operator">*</span>alphaChannelPressureAction <span class="operator">=</span> alphaChannelMenu<span class="operator">-</span><span class="operator">&gt;</span>addAction(tr(<span class="string">"&amp;Pressure"</span>));
    alphaChannelPressureAction<span class="operator">-</span><span class="operator">&gt;</span>setData(TabletCanvas<span class="operator">::</span>PressureValuator);
    alphaChannelPressureAction<span class="operator">-</span><span class="operator">&gt;</span>setCheckable(<span class="keyword">true</span>);

    <span class="type"><a href="./qaction.htm" translate="no">QAction</a></span> <span class="operator">*</span>alphaChannelTangentialPressureAction <span class="operator">=</span> alphaChannelMenu<span class="operator">-</span><span class="operator">&gt;</span>addAction(tr(<span class="string">"T&amp;angential Pressure"</span>));
    alphaChannelTangentialPressureAction<span class="operator">-</span><span class="operator">&gt;</span>setData(TabletCanvas<span class="operator">::</span>TangentialPressureValuator);
    alphaChannelTangentialPressureAction<span class="operator">-</span><span class="operator">&gt;</span>setCheckable(<span class="keyword">true</span>);
    alphaChannelTangentialPressureAction<span class="operator">-</span><span class="operator">&gt;</span>setChecked(<span class="keyword">true</span>);

    <span class="type"><a href="./qaction.htm" translate="no">QAction</a></span> <span class="operator">*</span>alphaChannelTiltAction <span class="operator">=</span> alphaChannelMenu<span class="operator">-</span><span class="operator">&gt;</span>addAction(tr(<span class="string">"&amp;Tilt"</span>));
    alphaChannelTiltAction<span class="operator">-</span><span class="operator">&gt;</span>setData(TabletCanvas<span class="operator">::</span>TiltValuator);
    alphaChannelTiltAction<span class="operator">-</span><span class="operator">&gt;</span>setCheckable(<span class="keyword">true</span>);

    <span class="type"><a href="./qaction.htm" translate="no">QAction</a></span> <span class="operator">*</span>noAlphaChannelAction <span class="operator">=</span> alphaChannelMenu<span class="operator">-</span><span class="operator">&gt;</span>addAction(tr(<span class="string">"No Alpha Channel"</span>));
    noAlphaChannelAction<span class="operator">-</span><span class="operator">&gt;</span>setData(TabletCanvas<span class="operator">::</span>NoValuator);
    noAlphaChannelAction<span class="operator">-</span><span class="operator">&gt;</span>setCheckable(<span class="keyword">true</span>);

    <span class="type"><a href="./qactiongroup.htm" translate="no">QActionGroup</a></span> <span class="operator">*</span>alphaChannelGroup <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qactiongroup.htm" translate="no">QActionGroup</a></span>(<span class="keyword">this</span>);
    alphaChannelGroup<span class="operator">-</span><span class="operator">&gt;</span>addAction(alphaChannelPressureAction);
    alphaChannelGroup<span class="operator">-</span><span class="operator">&gt;</span>addAction(alphaChannelTangentialPressureAction);
    alphaChannelGroup<span class="operator">-</span><span class="operator">&gt;</span>addAction(alphaChannelTiltAction);
    alphaChannelGroup<span class="operator">-</span><span class="operator">&gt;</span>addAction(noAlphaChannelAction);
    connect(alphaChannelGroup<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qactiongroup.htm" translate="no">QActionGroup</a></span><span class="operator">::</span>triggered<span class="operator">,</span>
            <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>MainWindow<span class="operator">::</span>setAlphaValuator);</pre></div>
<p>We want the user to be able to choose whether the drawing color's alpha component should be modulated by the tablet pressure, tilt, or the position of the thumbwheel on the airbrush tool. We have one action for each choice, and an additional action to choose not to change the alpha, that is, to keep the color opaque. We make the actions checkable; the <code translate="no">alphaChannelGroup</code> will then ensure that only one of the actions are checked at any time. The <code translate="no">triggered()</code> signal is emitted from the group when an action is checked, so we connect that to <code translate="no">MainWindow::setAlphaValuator()</code>. It will need to know which property (valuator) of the <a href="./qtabletevent.htm" translate="no">QTabletEvent</a> to pay attention to from now on, so we use the <a href="./qaction.htm#data" translate="no">QAction::data</a> property to pass this information along. (In order for this to be possible, the enum <code translate="no">Valuator</code> must be a registered metatype, so that it can be inserted into a <a href="./qvariant.htm" translate="no">QVariant</a>. That is accomplished by the <code translate="no">Q_ENUM</code> declaration in tabletcanvas.h.)</p>
<p>Here is the implementation of <code translate="no">setAlphaValuator()</code>:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> MainWindow<span class="operator">::</span>setAlphaValuator(<span class="type"><a href="./qaction.htm" translate="no">QAction</a></span> <span class="operator">*</span>action)
{
    m_canvas<span class="operator">-</span><span class="operator">&gt;</span>setAlphaChannelValuator(qvariant_cast<span class="operator">&lt;</span>TabletCanvas<span class="operator">::</span>Valuator<span class="operator">&gt;</span>(action<span class="operator">-</span><span class="operator">&gt;</span>data()));
}</pre></div>
<p>It simply needs to retrieve the <code translate="no">Valuator</code> enum from <a href="./qaction.htm#data" translate="no">QAction::data</a>(), and pass that to <code translate="no">TabletCanvas::setAlphaChannelValuator()</code>. If we were not using the <code translate="no">data</code> property, we would instead need to compare the <a href="./qaction.htm" translate="no">QAction</a> pointer itself, for example in a switch statement. But that would require keeping pointers to each <a href="./qaction.htm" translate="no">QAction</a> in class variables, for comparison purposes.</p>
<p>Here is the implementation of <code translate="no">setBrushColor()</code>:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> MainWindow<span class="operator">::</span>setBrushColor()
{
    <span class="keyword">if</span> (<span class="operator">!</span>m_colorDialog) {
        m_colorDialog <span class="operator">=</span> <span class="keyword">new</span> <span class="type"><a href="./qcolordialog.htm" translate="no">QColorDialog</a></span>(<span class="keyword">this</span>);
        m_colorDialog<span class="operator">-</span><span class="operator">&gt;</span>setModal(<span class="keyword">false</span>);
        m_colorDialog<span class="operator">-</span><span class="operator">&gt;</span>setCurrentColor(m_canvas<span class="operator">-</span><span class="operator">&gt;</span>color());
        connect(m_colorDialog<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qcolordialog.htm" translate="no">QColorDialog</a></span><span class="operator">::</span>colorSelected<span class="operator">,</span> m_canvas<span class="operator">,</span> <span class="operator">&amp;</span>TabletCanvas<span class="operator">::</span>setColor);
    }
    m_colorDialog<span class="operator">-</span><span class="operator">&gt;</span>setVisible(<span class="keyword">true</span>);
}</pre></div>
<p>We do lazy initialization of a <a href="./qcolordialog.htm" translate="no">QColorDialog</a> the first time the user chooses <b>Brush color...</b> from the menu or via the action shortcut. While the dialog is open, each time the user chooses a different color, <code translate="no">TabletCanvas::setColor()</code> will be called to change the drawing color. Because it is a non-modal dialog, the user is free to leave the color dialog open, so as to be able to conveniently and frequently change colors, or close it and re-open it later.</p>
<p>Here is the implementation of <code translate="no">save()</code>:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">bool MainWindow<span class="operator">::</span>save()
{
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> path <span class="operator">=</span> <span class="type"><a href="./qdir.htm" translate="no">QDir</a></span><span class="operator">::</span>currentPath() <span class="operator">+</span> <span class="string">"/untitled.png"</span>;
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> fileName <span class="operator">=</span> <span class="type"><a href="./qfiledialog.htm" translate="no">QFileDialog</a></span><span class="operator">::</span>getSaveFileName(<span class="keyword">this</span><span class="operator">,</span> tr(<span class="string">"Save Picture"</span>)<span class="operator">,</span>
                             path);
    bool success <span class="operator">=</span> m_canvas<span class="operator">-</span><span class="operator">&gt;</span>saveImage(fileName);
    <span class="keyword">if</span> (<span class="operator">!</span>success)
        <span class="type"><a href="./qmessagebox.htm" translate="no">QMessageBox</a></span><span class="operator">::</span>information(<span class="keyword">this</span><span class="operator">,</span> <span class="string">"Error Saving Picture"</span><span class="operator">,</span>
                                 <span class="string">"Could not save the image"</span>);
    <span class="keyword">return</span> success;
}</pre></div>
<p>We use the <a href="./qfiledialog.htm" translate="no">QFileDialog</a> to let the user select a file to save the drawing, and then call <code translate="no">TabletCanvas::saveImage()</code> to actually write it to the file.</p>
<p>Here is the implementation of <code translate="no">load()</code>:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> MainWindow<span class="operator">::</span>load()
{
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> fileName <span class="operator">=</span> <span class="type"><a href="./qfiledialog.htm" translate="no">QFileDialog</a></span><span class="operator">::</span>getOpenFileName(<span class="keyword">this</span><span class="operator">,</span> tr(<span class="string">"Open Picture"</span>)<span class="operator">,</span>
                                                    <span class="type"><a href="./qdir.htm" translate="no">QDir</a></span><span class="operator">::</span>currentPath());

    <span class="keyword">if</span> (<span class="operator">!</span>m_canvas<span class="operator">-</span><span class="operator">&gt;</span>loadImage(fileName))
        <span class="type"><a href="./qmessagebox.htm" translate="no">QMessageBox</a></span><span class="operator">::</span>information(<span class="keyword">this</span><span class="operator">,</span> <span class="string">"Error Opening Picture"</span><span class="operator">,</span>
                                 <span class="string">"Could not open picture"</span>);
}</pre></div>
<p>We let the user select the image file to be opened with a <a href="./qfiledialog.htm" translate="no">QFileDialog</a>; we then ask the canvas to load the image with <code translate="no">loadImage()</code>.</p>
<p>Here is the implementation of <code translate="no">about()</code>:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> MainWindow<span class="operator">::</span>about()
{
    <span class="type"><a href="./qmessagebox.htm" translate="no">QMessageBox</a></span><span class="operator">::</span>about(<span class="keyword">this</span><span class="operator">,</span> tr(<span class="string">"About Tablet Example"</span>)<span class="operator">,</span>
                       tr(<span class="string">"This example shows how to use a graphics drawing tablet in Qt."</span>));
}</pre></div>
<p>We show a message box with a short description of the example.</p>
<a name="tabletcanvas-class-definition"></a>
<h4 id="tabletcanvas-class-definition">TabletCanvas Class Definition<a class="plink" href="#tabletcanvas-class-definition" title="Direct link to this headline"></a></h4>
<p>The <code translate="no">TabletCanvas</code> class provides a surface on which the user can draw with a tablet.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="keyword">class</span> TabletCanvas : <span class="keyword">public</span> <span class="type"><a href="./qwidget.htm" translate="no">QWidget</a></span>
{
    Q_OBJECT

<span class="keyword">public</span>:
    <span class="keyword">enum</span> Valuator { PressureValuator<span class="operator">,</span> TangentialPressureValuator<span class="operator">,</span>
                    TiltValuator<span class="operator">,</span> VTiltValuator<span class="operator">,</span> HTiltValuator<span class="operator">,</span> NoValuator };
    Q_ENUM(Valuator)

    TabletCanvas();

    bool saveImage(<span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> <span class="operator">&amp;</span>file);
    bool loadImage(<span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> <span class="operator">&amp;</span>file);
    <span class="type">void</span> clear();
    <span class="type">void</span> setAlphaChannelValuator(Valuator type)
        { m_alphaChannelValuator <span class="operator">=</span> type; }
    <span class="type">void</span> setColorSaturationValuator(Valuator type)
        { m_colorSaturationValuator <span class="operator">=</span> type; }
    <span class="type">void</span> setLineWidthType(Valuator type)
        { m_lineWidthValuator <span class="operator">=</span> type; }
    <span class="type">void</span> setColor(<span class="keyword">const</span> <span class="type"><a href="./qcolor.htm" translate="no">QColor</a></span> <span class="operator">&amp;</span>c)
        { <span class="keyword">if</span> (c<span class="operator">.</span>isValid()) m_color <span class="operator">=</span> c; }
    <span class="type"><a href="./qcolor.htm" translate="no">QColor</a></span> color() <span class="keyword">const</span>
        { <span class="keyword">return</span> m_color; }
    <span class="type">void</span> setTabletDevice(<span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span> <span class="operator">*</span>event)
        { updateCursor(event); }

<span class="keyword">protected</span>:
    <span class="type">void</span> tabletEvent(<span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span> <span class="operator">*</span>event) override;
    <span class="type">void</span> paintEvent(<span class="type"><a href="./qpaintevent.htm" translate="no">QPaintEvent</a></span> <span class="operator">*</span>event) override;
    <span class="type">void</span> resizeEvent(<span class="type"><a href="./qresizeevent.htm" translate="no">QResizeEvent</a></span> <span class="operator">*</span>event) override;

<span class="keyword">private</span>:
    <span class="type">void</span> initPixmap();
    <span class="type">void</span> paintPixmap(<span class="type"><a href="./qpainter.htm" translate="no">QPainter</a></span> <span class="operator">&amp;</span>painter<span class="operator">,</span> <span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span> <span class="operator">*</span>event);
    <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>BrushStyle brushPattern(<span class="type"><a href="./qtglobal.htm#qreal-typedef" translate="no">qreal</a></span> value);
    <span class="keyword">static</span> <span class="type"><a href="./qtglobal.htm#qreal-typedef" translate="no">qreal</a></span> pressureToWidth(<span class="type"><a href="./qtglobal.htm#qreal-typedef" translate="no">qreal</a></span> pressure);
    <span class="type">void</span> updateBrush(<span class="keyword">const</span> <span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span> <span class="operator">*</span>event);
    <span class="type">void</span> updateCursor(<span class="keyword">const</span> <span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span> <span class="operator">*</span>event);

    Valuator m_alphaChannelValuator <span class="operator">=</span> TangentialPressureValuator;
    Valuator m_colorSaturationValuator <span class="operator">=</span> NoValuator;
    Valuator m_lineWidthValuator <span class="operator">=</span> PressureValuator;
    <span class="type"><a href="./qcolor.htm" translate="no">QColor</a></span> m_color <span class="operator">=</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>red;
    <span class="type"><a href="./qpixmap.htm" translate="no">QPixmap</a></span> m_pixmap;
    <span class="type"><a href="./qbrush.htm" translate="no">QBrush</a></span> m_brush;
    <span class="type"><a href="./qpen.htm" translate="no">QPen</a></span> m_pen;
    bool m_deviceDown <span class="operator">=</span> <span class="keyword">false</span>;

    <span class="keyword">struct</span> Point {
        <span class="type"><a href="./qpointf.htm" translate="no">QPointF</a></span> pos;
        <span class="type"><a href="./qtglobal.htm#qreal-typedef" translate="no">qreal</a></span> pressure <span class="operator">=</span> <span class="number">0</span>;
        <span class="type"><a href="./qtglobal.htm#qreal-typedef" translate="no">qreal</a></span> rotation <span class="operator">=</span> <span class="number">0</span>;
    } lastPoint;
};</pre></div>
<p>The canvas can change the alpha channel, color saturation, and line width of the stroke. We have an enum listing the <a href="./qtabletevent.htm" translate="no">QTabletEvent</a> properties with which it is possible to modulate them. We keep a private variable for each: <code translate="no">m_alphaChannelValuator</code>, <code translate="no">m_colorSaturationValuator</code> and <code translate="no">m_lineWidthValuator</code>, and we provide accessor functions for them.</p>
<p>We draw on a <a href="./qpixmap.htm" translate="no">QPixmap</a> with <code translate="no">m_pen</code> and <code translate="no">m_brush</code> using <code translate="no">m_color</code>. Each time a <a href="./qtabletevent.htm" translate="no">QTabletEvent</a> is received, the stroke is drawn from <code translate="no">lastPoint</code> to the point given in the current <a href="./qtabletevent.htm" translate="no">QTabletEvent</a>, and then the position and rotation are saved in <code translate="no">lastPoint</code> for next time. The <code translate="no">saveImage()</code> and <code translate="no">loadImage()</code> functions save and load the <a href="./qpixmap.htm" translate="no">QPixmap</a> to disk. The pixmap is drawn on the widget in <code translate="no">paintEvent()</code>.</p>
<p>The interpretation of events from the tablet is done in <code translate="no">tabletEvent()</code>, and <code translate="no">paintPixmap()</code>, <code translate="no">updateBrush()</code>, and <code translate="no">updateCursor()</code> are helper functions used by <code translate="no">tabletEvent()</code>.</p>
<a name="tabletcanvas-class-implementation"></a>
<h4 id="tabletcanvas-class-implementation">TabletCanvas Class Implementation<a class="plink" href="#tabletcanvas-class-implementation" title="Direct link to this headline"></a></h4>
<p>We start with a look at the constructor:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">TabletCanvas<span class="operator">::</span>TabletCanvas()
    : <span class="type"><a href="./qwidget.htm" translate="no">QWidget</a></span>(nullptr)<span class="operator">,</span> m_brush(m_color)
    <span class="operator">,</span> m_pen(m_brush<span class="operator">,</span> <span class="number">1.0</span><span class="operator">,</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>SolidLine<span class="operator">,</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>RoundCap<span class="operator">,</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>RoundJoin)
{
    resize(<span class="number">500</span><span class="operator">,</span> <span class="number">500</span>);
    setAutoFillBackground(<span class="keyword">true</span>);
    setAttribute(<span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>WA_TabletTracking);
}</pre></div>
<p>In the constructor we initialize most of our class variables.</p>
<p>Here is the implementation of <code translate="no">saveImage()</code>:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">bool TabletCanvas<span class="operator">::</span>saveImage(<span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> <span class="operator">&amp;</span>file)
{
    <span class="keyword">return</span> m_pixmap<span class="operator">.</span>save(file);
}</pre></div>
<p><a href="./qpixmap.htm" translate="no">QPixmap</a> implements functionality to save itself to disk, so we simply call <a href="./qpixmap.htm#save" translate="no">save()</a>.</p>
<p>Here is the implementation of <code translate="no">loadImage()</code>:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">bool TabletCanvas<span class="operator">::</span>loadImage(<span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> <span class="operator">&amp;</span>file)
{
    bool success <span class="operator">=</span> m_pixmap<span class="operator">.</span>load(file);

    <span class="keyword">if</span> (success) {
        update();
        <span class="keyword">return</span> <span class="keyword">true</span>;
    }
    <span class="keyword">return</span> <span class="keyword">false</span>;
}</pre></div>
<p>We simply call <a href="./qpixmap.htm#load" translate="no">load()</a>, which loads the image from <i translate="no">file</i>.</p>
<p>Here is the implementation of <code translate="no">tabletEvent()</code>:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> TabletCanvas<span class="operator">::</span>tabletEvent(<span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span> <span class="operator">*</span>event)
{
    <span class="keyword">switch</span> (event<span class="operator">-</span><span class="operator">&gt;</span>type()) {
        <span class="keyword">case</span> <span class="type"><a href="./qevent.htm" translate="no">QEvent</a></span><span class="operator">::</span>TabletPress:
            <span class="keyword">if</span> (<span class="operator">!</span>m_deviceDown) {
                m_deviceDown <span class="operator">=</span> <span class="keyword">true</span>;
                lastPoint<span class="operator">.</span>pos <span class="operator">=</span> event<span class="operator">-</span><span class="operator">&gt;</span>posF();
                lastPoint<span class="operator">.</span>pressure <span class="operator">=</span> event<span class="operator">-</span><span class="operator">&gt;</span>pressure();
                lastPoint<span class="operator">.</span>rotation <span class="operator">=</span> event<span class="operator">-</span><span class="operator">&gt;</span>rotation();
            }
            <span class="keyword">break</span>;
        <span class="keyword">case</span> <span class="type"><a href="./qevent.htm" translate="no">QEvent</a></span><span class="operator">::</span>TabletMove:
<span class="preprocessor">#ifndef Q_OS_IOS</span>
            <span class="keyword">if</span> (event<span class="operator">-</span><span class="operator">&gt;</span>deviceType() <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span><span class="operator">::</span>RotationStylus)
                updateCursor(event);
<span class="preprocessor">#endif</span>
            <span class="keyword">if</span> (m_deviceDown) {
                updateBrush(event);
                <span class="type"><a href="./qpainter.htm" translate="no">QPainter</a></span> painter(<span class="operator">&amp;</span>m_pixmap);
                paintPixmap(painter<span class="operator">,</span> event);
                lastPoint<span class="operator">.</span>pos <span class="operator">=</span> event<span class="operator">-</span><span class="operator">&gt;</span>posF();
                lastPoint<span class="operator">.</span>pressure <span class="operator">=</span> event<span class="operator">-</span><span class="operator">&gt;</span>pressure();
                lastPoint<span class="operator">.</span>rotation <span class="operator">=</span> event<span class="operator">-</span><span class="operator">&gt;</span>rotation();
            }
            <span class="keyword">break</span>;
        <span class="keyword">case</span> <span class="type"><a href="./qevent.htm" translate="no">QEvent</a></span><span class="operator">::</span>TabletRelease:
            <span class="keyword">if</span> (m_deviceDown <span class="operator">&amp;</span><span class="operator">&amp;</span> event<span class="operator">-</span><span class="operator">&gt;</span>buttons() <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>NoButton)
                m_deviceDown <span class="operator">=</span> <span class="keyword">false</span>;
            update();
            <span class="keyword">break</span>;
        <span class="keyword">default</span>:
            <span class="keyword">break</span>;
    }
    event<span class="operator">-</span><span class="operator">&gt;</span>accept();
}</pre></div>
<p>We get three kind of events to this function: <code translate="no">TabletPress</code>, <code translate="no">TabletRelease</code>, and <code translate="no">TabletMove</code>, which are generated when a drawing tool is pressed down on, lifed up from, or moved across the tablet. We set <code translate="no">m_deviceDown</code> to <code translate="no">true</code> when a device is pressed down on the tablet; we then know that we should draw when we receive move events. We have implemented <code translate="no">updateBrush()</code> to update <code translate="no">m_brush</code> and <code translate="no">m_pen</code> depending on which of the tablet event properties the user has chosen to pay attention to. The <code translate="no">updateCursor()</code> function selects a cursor to represent the drawing tool in use, so that as you hover with the tool in proximity of the tablet, you can see what kind of stroke you are about to make.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> TabletCanvas<span class="operator">::</span>updateCursor(<span class="keyword">const</span> <span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span> <span class="operator">*</span>event)
{
    <span class="type"><a href="./qcursor.htm" translate="no">QCursor</a></span> cursor;
    <span class="keyword">if</span> (event<span class="operator">-</span><span class="operator">&gt;</span>type() <span class="operator">!</span><span class="operator">=</span> <span class="type"><a href="./qevent.htm" translate="no">QEvent</a></span><span class="operator">::</span>TabletLeaveProximity) {
        <span class="keyword">if</span> (event<span class="operator">-</span><span class="operator">&gt;</span>pointerType() <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span><span class="operator">::</span>Eraser) {
            cursor <span class="operator">=</span> <span class="type"><a href="./qcursor.htm" translate="no">QCursor</a></span>(<span class="type"><a href="./qpixmap.htm" translate="no">QPixmap</a></span>(<span class="string">":/images/cursor-eraser.png"</span>)<span class="operator">,</span> <span class="number">3</span><span class="operator">,</span> <span class="number">28</span>);
        } <span class="keyword">else</span> {
            <span class="keyword">switch</span> (event<span class="operator">-</span><span class="operator">&gt;</span>deviceType()) {
            <span class="keyword">case</span> <span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span><span class="operator">::</span>Stylus:
                cursor <span class="operator">=</span> <span class="type"><a href="./qcursor.htm" translate="no">QCursor</a></span>(<span class="type"><a href="./qpixmap.htm" translate="no">QPixmap</a></span>(<span class="string">":/images/cursor-pencil.png"</span>)<span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="number">0</span>);
                <span class="keyword">break</span>;
            <span class="keyword">case</span> <span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span><span class="operator">::</span>Airbrush:
                cursor <span class="operator">=</span> <span class="type"><a href="./qcursor.htm" translate="no">QCursor</a></span>(<span class="type"><a href="./qpixmap.htm" translate="no">QPixmap</a></span>(<span class="string">":/images/cursor-airbrush.png"</span>)<span class="operator">,</span> <span class="number">3</span><span class="operator">,</span> <span class="number">4</span>);
                <span class="keyword">break</span>;
            <span class="keyword">case</span> <span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span><span class="operator">::</span>RotationStylus: {
                <span class="type"><a href="./qimage.htm" translate="no">QImage</a></span> origImg(QLatin1String(<span class="string">":/images/cursor-felt-marker.png"</span>));
                <span class="type"><a href="./qimage.htm" translate="no">QImage</a></span> img(<span class="number">32</span><span class="operator">,</span> <span class="number">32</span><span class="operator">,</span> <span class="type"><a href="./qimage.htm" translate="no">QImage</a></span><span class="operator">::</span>Format_ARGB32);
                <span class="type"><a href="./qcolor.htm" translate="no">QColor</a></span> solid <span class="operator">=</span> m_color;
                solid<span class="operator">.</span>setAlpha(<span class="number">255</span>);
                img<span class="operator">.</span>fill(solid);
                <span class="type"><a href="./qpainter.htm" translate="no">QPainter</a></span> painter(<span class="operator">&amp;</span>img);
                <span class="type"><a href="./qtransform.htm" translate="no">QTransform</a></span> transform <span class="operator">=</span> painter<span class="operator">.</span>transform();
                transform<span class="operator">.</span>translate(<span class="number">16</span><span class="operator">,</span> <span class="number">16</span>);
                transform<span class="operator">.</span>rotate(event<span class="operator">-</span><span class="operator">&gt;</span>rotation());
                painter<span class="operator">.</span>setTransform(transform);
                painter<span class="operator">.</span>setCompositionMode(<span class="type"><a href="./qpainter.htm" translate="no">QPainter</a></span><span class="operator">::</span>CompositionMode_DestinationIn);
                painter<span class="operator">.</span>drawImage(<span class="operator">-</span><span class="number">24</span><span class="operator">,</span> <span class="operator">-</span><span class="number">24</span><span class="operator">,</span> origImg);
                painter<span class="operator">.</span>setCompositionMode(<span class="type"><a href="./qpainter.htm" translate="no">QPainter</a></span><span class="operator">::</span>CompositionMode_HardLight);
                painter<span class="operator">.</span>drawImage(<span class="operator">-</span><span class="number">24</span><span class="operator">,</span> <span class="operator">-</span><span class="number">24</span><span class="operator">,</span> origImg);
                painter<span class="operator">.</span>end();
                cursor <span class="operator">=</span> <span class="type"><a href="./qcursor.htm" translate="no">QCursor</a></span>(<span class="type"><a href="./qpixmap.htm" translate="no">QPixmap</a></span><span class="operator">::</span>fromImage(img)<span class="operator">,</span> <span class="number">16</span><span class="operator">,</span> <span class="number">16</span>);
            } <span class="keyword">break</span>;
            <span class="keyword">default</span>:
                <span class="keyword">break</span>;
            }
        }
    }
    setCursor(cursor);
}</pre></div>
<p>If an art pen (<code translate="no">RotationStylus</code>) is in use, <code translate="no">updateCursor()</code> is also called for each <code translate="no">TabletMove</code> event, and renders a rotated cursor so that you can see the angle of the pen tip.</p>
<p>Here is the implementation of <code translate="no">paintEvent()</code>:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> TabletCanvas<span class="operator">::</span>initPixmap()
{
    <span class="type"><a href="./qtglobal.htm#qreal-typedef" translate="no">qreal</a></span> dpr <span class="operator">=</span> devicePixelRatioF();
    <span class="type"><a href="./qpixmap.htm" translate="no">QPixmap</a></span> newPixmap <span class="operator">=</span> <span class="type"><a href="./qpixmap.htm" translate="no">QPixmap</a></span>(<a href="./qtglobal.htm#qRound" translate="no">qRound</a>(width() <span class="operator">*</span> dpr)<span class="operator">,</span> <a href="./qtglobal.htm#qRound" translate="no">qRound</a>(height() <span class="operator">*</span> dpr));
    newPixmap<span class="operator">.</span>setDevicePixelRatio(dpr);
    newPixmap<span class="operator">.</span>fill(<span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>white);
    <span class="type"><a href="./qpainter.htm" translate="no">QPainter</a></span> painter(<span class="operator">&amp;</span>newPixmap);
    <span class="keyword">if</span> (<span class="operator">!</span>m_pixmap<span class="operator">.</span>isNull())
        painter<span class="operator">.</span>drawPixmap(<span class="number">0</span><span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> m_pixmap);
    painter<span class="operator">.</span>end();
    m_pixmap <span class="operator">=</span> newPixmap;
}

<span class="type">void</span> TabletCanvas<span class="operator">::</span>paintEvent(<span class="type"><a href="./qpaintevent.htm" translate="no">QPaintEvent</a></span> <span class="operator">*</span>event)
{
    <span class="keyword">if</span> (m_pixmap<span class="operator">.</span>isNull())
        initPixmap();
    <span class="type"><a href="./qpainter.htm" translate="no">QPainter</a></span> painter(<span class="keyword">this</span>);
    <span class="type"><a href="./qrect.htm" translate="no">QRect</a></span> pixmapPortion <span class="operator">=</span> <span class="type"><a href="./qrect.htm" translate="no">QRect</a></span>(event<span class="operator">-</span><span class="operator">&gt;</span>rect()<span class="operator">.</span>topLeft() <span class="operator">*</span> devicePixelRatioF()<span class="operator">,</span>
                                event<span class="operator">-</span><span class="operator">&gt;</span>rect()<span class="operator">.</span>size() <span class="operator">*</span> devicePixelRatioF());
    painter<span class="operator">.</span>drawPixmap(event<span class="operator">-</span><span class="operator">&gt;</span>rect()<span class="operator">.</span>topLeft()<span class="operator">,</span> m_pixmap<span class="operator">,</span> pixmapPortion);
}</pre></div>
<p>The first time Qt calls paintEvent(), m_pixmap is default-constructed, so <a href="./qpixmap.htm#isNull" translate="no">QPixmap::isNull</a>() returns <code translate="no">true</code>. Now that we know which screen we will be rendering to, we can create a pixmap with the appropriate resolution. The size of the pixmap with which we fill the window depends on the screen resolution, as the example does not support zoom; and it may be that one screen is <a href="./highdpi.htm" translate="no">high DPI</a> while another is not. We need to draw the background too, as the default is gray.</p>
<p>After that, we simply draw the pixmap to the top left of the widget.</p>
<p>Here is the implementation of <code translate="no">paintPixmap()</code>:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> TabletCanvas<span class="operator">::</span>paintPixmap(<span class="type"><a href="./qpainter.htm" translate="no">QPainter</a></span> <span class="operator">&amp;</span>painter<span class="operator">,</span> <span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span> <span class="operator">*</span>event)
{
    <span class="keyword">static</span> <span class="type"><a href="./qtglobal.htm#qreal-typedef" translate="no">qreal</a></span> maxPenRadius <span class="operator">=</span> pressureToWidth(<span class="number">1.0</span>);
    painter<span class="operator">.</span>setRenderHint(<span class="type"><a href="./qpainter.htm" translate="no">QPainter</a></span><span class="operator">::</span>Antialiasing);

    <span class="keyword">switch</span> (event<span class="operator">-</span><span class="operator">&gt;</span>deviceType()) {
        <span class="keyword">case</span> <span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span><span class="operator">::</span>Airbrush:
            {
                painter<span class="operator">.</span>setPen(<span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>NoPen);
                <span class="type"><a href="./qradialgradient.htm" translate="no">QRadialGradient</a></span> grad(lastPoint<span class="operator">.</span>pos<span class="operator">,</span> m_pen<span class="operator">.</span>widthF() <span class="operator">*</span> <span class="number">10.0</span>);
                <span class="type"><a href="./qcolor.htm" translate="no">QColor</a></span> color <span class="operator">=</span> m_brush<span class="operator">.</span>color();
                color<span class="operator">.</span>setAlphaF(color<span class="operator">.</span>alphaF() <span class="operator">*</span> <span class="number">0.25</span>);
                grad<span class="operator">.</span>setColorAt(<span class="number">0</span><span class="operator">,</span> m_brush<span class="operator">.</span>color());
                grad<span class="operator">.</span>setColorAt(<span class="number">0.5</span><span class="operator">,</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>transparent);
                painter<span class="operator">.</span>setBrush(grad);
                <span class="type"><a href="./qtglobal.htm#qreal-typedef" translate="no">qreal</a></span> radius <span class="operator">=</span> grad<span class="operator">.</span>radius();
                painter<span class="operator">.</span>drawEllipse(event<span class="operator">-</span><span class="operator">&gt;</span>posF()<span class="operator">,</span> radius<span class="operator">,</span> radius);
                update(<span class="type"><a href="./qrect.htm" translate="no">QRect</a></span>(event<span class="operator">-</span><span class="operator">&gt;</span>pos() <span class="operator">-</span> <span class="type"><a href="./qpoint.htm" translate="no">QPoint</a></span>(radius<span class="operator">,</span> radius)<span class="operator">,</span> <span class="type"><a href="./qsize.htm" translate="no">QSize</a></span>(radius <span class="operator">*</span> <span class="number">2</span><span class="operator">,</span> radius <span class="operator">*</span> <span class="number">2</span>)));
            }
            <span class="keyword">break</span>;
        <span class="keyword">case</span> <span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span><span class="operator">::</span>RotationStylus:
            {
                m_brush<span class="operator">.</span>setStyle(<span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>SolidPattern);
                painter<span class="operator">.</span>setPen(<span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>NoPen);
                painter<span class="operator">.</span>setBrush(m_brush);
                <span class="type"><a href="./qpolygonf.htm" translate="no">QPolygonF</a></span> poly;
                <span class="type"><a href="./qtglobal.htm#qreal-typedef" translate="no">qreal</a></span> halfWidth <span class="operator">=</span> pressureToWidth(lastPoint<span class="operator">.</span>pressure);
                <span class="type"><a href="./qpointf.htm" translate="no">QPointF</a></span> brushAdjust(<a href="./qtmath.htm#qSin" translate="no">qSin</a>(<a href="./qtmath.htm#qDegreesToRadians" translate="no">qDegreesToRadians</a>(<span class="operator">-</span>lastPoint<span class="operator">.</span>rotation)) <span class="operator">*</span> halfWidth<span class="operator">,</span>
                                    <a href="./qtmath.htm#qCos" translate="no">qCos</a>(<a href="./qtmath.htm#qDegreesToRadians" translate="no">qDegreesToRadians</a>(<span class="operator">-</span>lastPoint<span class="operator">.</span>rotation)) <span class="operator">*</span> halfWidth);
                poly <span class="operator">&lt;</span><span class="operator">&lt;</span> lastPoint<span class="operator">.</span>pos <span class="operator">+</span> brushAdjust;
                poly <span class="operator">&lt;</span><span class="operator">&lt;</span> lastPoint<span class="operator">.</span>pos <span class="operator">-</span> brushAdjust;
                halfWidth <span class="operator">=</span> m_pen<span class="operator">.</span>widthF();
                brushAdjust <span class="operator">=</span> <span class="type"><a href="./qpointf.htm" translate="no">QPointF</a></span>(<a href="./qtmath.htm#qSin" translate="no">qSin</a>(<a href="./qtmath.htm#qDegreesToRadians" translate="no">qDegreesToRadians</a>(<span class="operator">-</span>event<span class="operator">-</span><span class="operator">&gt;</span>rotation())) <span class="operator">*</span> halfWidth<span class="operator">,</span>
                                      <a href="./qtmath.htm#qCos" translate="no">qCos</a>(<a href="./qtmath.htm#qDegreesToRadians" translate="no">qDegreesToRadians</a>(<span class="operator">-</span>event<span class="operator">-</span><span class="operator">&gt;</span>rotation())) <span class="operator">*</span> halfWidth);
                poly <span class="operator">&lt;</span><span class="operator">&lt;</span> event<span class="operator">-</span><span class="operator">&gt;</span>posF() <span class="operator">-</span> brushAdjust;
                poly <span class="operator">&lt;</span><span class="operator">&lt;</span> event<span class="operator">-</span><span class="operator">&gt;</span>posF() <span class="operator">+</span> brushAdjust;
                painter<span class="operator">.</span>drawConvexPolygon(poly);
                update(poly<span class="operator">.</span>boundingRect()<span class="operator">.</span>toRect());
            }
            <span class="keyword">break</span>;
        <span class="keyword">case</span> <span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span><span class="operator">::</span>Puck:
        <span class="keyword">case</span> <span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span><span class="operator">::</span>FourDMouse:
            {
                <span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> error(tr(<span class="string">"This input device is not supported by the example."</span>));
<span class="preprocessor">#if QT_CONFIG(statustip)</span>
                <span class="type"><a href="./qstatustipevent.htm" translate="no">QStatusTipEvent</a></span> status(error);
                <span class="type"><a href="./qcoreapplication.htm" translate="no">QCoreApplication</a></span><span class="operator">::</span>sendEvent(<span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>status);
<span class="preprocessor">#else</span>
                <a href="./qtglobal.htm#qWarning" translate="no">qWarning</a>() <span class="operator">&lt;</span><span class="operator">&lt;</span> error;
<span class="preprocessor">#endif</span>
            }
            <span class="keyword">break</span>;
        <span class="keyword">default</span>:
            {
                <span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> error(tr(<span class="string">"Unknown tablet device - treating as stylus"</span>));
<span class="preprocessor">#if QT_CONFIG(statustip)</span>
                <span class="type"><a href="./qstatustipevent.htm" translate="no">QStatusTipEvent</a></span> status(error);
                <span class="type"><a href="./qcoreapplication.htm" translate="no">QCoreApplication</a></span><span class="operator">::</span>sendEvent(<span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>status);
<span class="preprocessor">#else</span>
                <a href="./qtglobal.htm#qWarning" translate="no">qWarning</a>() <span class="operator">&lt;</span><span class="operator">&lt;</span> error;
<span class="preprocessor">#endif</span>
            }
            Q_FALLTHROUGH();
        <span class="keyword">case</span> <span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span><span class="operator">::</span>Stylus:
            painter<span class="operator">.</span>setPen(m_pen);
            painter<span class="operator">.</span>drawLine(lastPoint<span class="operator">.</span>pos<span class="operator">,</span> event<span class="operator">-</span><span class="operator">&gt;</span>posF());
            update(<span class="type"><a href="./qrect.htm" translate="no">QRect</a></span>(lastPoint<span class="operator">.</span>pos<span class="operator">.</span>toPoint()<span class="operator">,</span> event<span class="operator">-</span><span class="operator">&gt;</span>pos())<span class="operator">.</span>normalized()
                   <span class="operator">.</span>adjusted(<span class="operator">-</span>maxPenRadius<span class="operator">,</span> <span class="operator">-</span>maxPenRadius<span class="operator">,</span> maxPenRadius<span class="operator">,</span> maxPenRadius));
            <span class="keyword">break</span>;
    }
}</pre></div>
<p>In this function we draw on the pixmap based on the movement of the tool. If the tool used on the tablet is a stylus, we want to draw a line from the last-known position to the current position. We also assume that this is a reasonable handling of any unknown device, but update the status bar with a warning. If it is an airbrush, we want to draw a circle filled with a soft gradient, whose density can depend on various event parameters. By default it depends on the tangential pressure, which is the position of the finger wheel on the airbrush. If the tool is a rotation stylus, we simulate a felt marker by drawing trapezoidal stroke segments.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">        <span class="keyword">case</span> <span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span><span class="operator">::</span>Airbrush:
            {
                painter<span class="operator">.</span>setPen(<span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>NoPen);
                <span class="type"><a href="./qradialgradient.htm" translate="no">QRadialGradient</a></span> grad(lastPoint<span class="operator">.</span>pos<span class="operator">,</span> m_pen<span class="operator">.</span>widthF() <span class="operator">*</span> <span class="number">10.0</span>);
                <span class="type"><a href="./qcolor.htm" translate="no">QColor</a></span> color <span class="operator">=</span> m_brush<span class="operator">.</span>color();
                color<span class="operator">.</span>setAlphaF(color<span class="operator">.</span>alphaF() <span class="operator">*</span> <span class="number">0.25</span>);
                grad<span class="operator">.</span>setColorAt(<span class="number">0</span><span class="operator">,</span> m_brush<span class="operator">.</span>color());
                grad<span class="operator">.</span>setColorAt(<span class="number">0.5</span><span class="operator">,</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>transparent);
                painter<span class="operator">.</span>setBrush(grad);
                <span class="type"><a href="./qtglobal.htm#qreal-typedef" translate="no">qreal</a></span> radius <span class="operator">=</span> grad<span class="operator">.</span>radius();
                painter<span class="operator">.</span>drawEllipse(event<span class="operator">-</span><span class="operator">&gt;</span>posF()<span class="operator">,</span> radius<span class="operator">,</span> radius);
                update(<span class="type"><a href="./qrect.htm" translate="no">QRect</a></span>(event<span class="operator">-</span><span class="operator">&gt;</span>pos() <span class="operator">-</span> <span class="type"><a href="./qpoint.htm" translate="no">QPoint</a></span>(radius<span class="operator">,</span> radius)<span class="operator">,</span> <span class="type"><a href="./qsize.htm" translate="no">QSize</a></span>(radius <span class="operator">*</span> <span class="number">2</span><span class="operator">,</span> radius <span class="operator">*</span> <span class="number">2</span>)));
            }
            <span class="keyword">break</span>;
        <span class="keyword">case</span> <span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span><span class="operator">::</span>RotationStylus:
            {
                m_brush<span class="operator">.</span>setStyle(<span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>SolidPattern);
                painter<span class="operator">.</span>setPen(<span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>NoPen);
                painter<span class="operator">.</span>setBrush(m_brush);
                <span class="type"><a href="./qpolygonf.htm" translate="no">QPolygonF</a></span> poly;
                <span class="type"><a href="./qtglobal.htm#qreal-typedef" translate="no">qreal</a></span> halfWidth <span class="operator">=</span> pressureToWidth(lastPoint<span class="operator">.</span>pressure);
                <span class="type"><a href="./qpointf.htm" translate="no">QPointF</a></span> brushAdjust(<a href="./qtmath.htm#qSin" translate="no">qSin</a>(<a href="./qtmath.htm#qDegreesToRadians" translate="no">qDegreesToRadians</a>(<span class="operator">-</span>lastPoint<span class="operator">.</span>rotation)) <span class="operator">*</span> halfWidth<span class="operator">,</span>
                                    <a href="./qtmath.htm#qCos" translate="no">qCos</a>(<a href="./qtmath.htm#qDegreesToRadians" translate="no">qDegreesToRadians</a>(<span class="operator">-</span>lastPoint<span class="operator">.</span>rotation)) <span class="operator">*</span> halfWidth);
                poly <span class="operator">&lt;</span><span class="operator">&lt;</span> lastPoint<span class="operator">.</span>pos <span class="operator">+</span> brushAdjust;
                poly <span class="operator">&lt;</span><span class="operator">&lt;</span> lastPoint<span class="operator">.</span>pos <span class="operator">-</span> brushAdjust;
                halfWidth <span class="operator">=</span> m_pen<span class="operator">.</span>widthF();
                brushAdjust <span class="operator">=</span> <span class="type"><a href="./qpointf.htm" translate="no">QPointF</a></span>(<a href="./qtmath.htm#qSin" translate="no">qSin</a>(<a href="./qtmath.htm#qDegreesToRadians" translate="no">qDegreesToRadians</a>(<span class="operator">-</span>event<span class="operator">-</span><span class="operator">&gt;</span>rotation())) <span class="operator">*</span> halfWidth<span class="operator">,</span>
                                      <a href="./qtmath.htm#qCos" translate="no">qCos</a>(<a href="./qtmath.htm#qDegreesToRadians" translate="no">qDegreesToRadians</a>(<span class="operator">-</span>event<span class="operator">-</span><span class="operator">&gt;</span>rotation())) <span class="operator">*</span> halfWidth);
                poly <span class="operator">&lt;</span><span class="operator">&lt;</span> event<span class="operator">-</span><span class="operator">&gt;</span>posF() <span class="operator">-</span> brushAdjust;
                poly <span class="operator">&lt;</span><span class="operator">&lt;</span> event<span class="operator">-</span><span class="operator">&gt;</span>posF() <span class="operator">+</span> brushAdjust;
                painter<span class="operator">.</span>drawConvexPolygon(poly);
                update(poly<span class="operator">.</span>boundingRect()<span class="operator">.</span>toRect());
            }
            <span class="keyword">break</span>;</pre></div>
<p>In <code translate="no">updateBrush()</code> we set the pen and brush used for drawing to match <code translate="no">m_alphaChannelValuator</code>, <code translate="no">m_lineWidthValuator</code>, <code translate="no">m_colorSaturationValuator</code>, and <code translate="no">m_color</code>. We will examine the code to set up <code translate="no">m_brush</code> and <code translate="no">m_pen</code> for each of these variables:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> TabletCanvas<span class="operator">::</span>updateBrush(<span class="keyword">const</span> <span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span> <span class="operator">*</span>event)
{
    <span class="type">int</span> hue<span class="operator">,</span> saturation<span class="operator">,</span> value<span class="operator">,</span> alpha;
    m_color<span class="operator">.</span>getHsv(<span class="operator">&amp;</span>hue<span class="operator">,</span> <span class="operator">&amp;</span>saturation<span class="operator">,</span> <span class="operator">&amp;</span>value<span class="operator">,</span> <span class="operator">&amp;</span>alpha);

    <span class="type">int</span> vValue <span class="operator">=</span> <span class="type">int</span>(((event<span class="operator">-</span><span class="operator">&gt;</span>yTilt() <span class="operator">+</span> <span class="number">60.0</span>) <span class="operator">/</span> <span class="number">120.0</span>) <span class="operator">*</span> <span class="number">255</span>);
    <span class="type">int</span> hValue <span class="operator">=</span> <span class="type">int</span>(((event<span class="operator">-</span><span class="operator">&gt;</span>xTilt() <span class="operator">+</span> <span class="number">60.0</span>) <span class="operator">/</span> <span class="number">120.0</span>) <span class="operator">*</span> <span class="number">255</span>);</pre></div>
<p>We fetch the current drawingcolor's hue, saturation, value, and alpha values. <code translate="no">hValue</code> and <code translate="no">vValue</code> are set to the horizontal and vertical tilt as a number from 0 to 255. The original values are in degrees from -60 to 60, i.e., 0 equals -60, 127 equals 0, and 255 equals 60 degrees. The angle measured is between the device and the perpendicular of the tablet (see <a href="./qtabletevent.htm" translate="no">QTabletEvent</a> for an illustration).</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">    <span class="keyword">switch</span> (m_alphaChannelValuator) {
        <span class="keyword">case</span> PressureValuator:
            m_color<span class="operator">.</span>setAlphaF(event<span class="operator">-</span><span class="operator">&gt;</span>pressure());
            <span class="keyword">break</span>;
        <span class="keyword">case</span> TangentialPressureValuator:
            <span class="keyword">if</span> (event<span class="operator">-</span><span class="operator">&gt;</span>deviceType() <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span><span class="operator">::</span>Airbrush)
                m_color<span class="operator">.</span>setAlphaF(<a href="./qtglobal.htm#qMax" translate="no">qMax</a>(<span class="number">0.01</span><span class="operator">,</span> (event<span class="operator">-</span><span class="operator">&gt;</span>tangentialPressure() <span class="operator">+</span> <span class="number">1.0</span>) <span class="operator">/</span> <span class="number">2.0</span>));
            <span class="keyword">else</span>
                m_color<span class="operator">.</span>setAlpha(<span class="number">255</span>);
            <span class="keyword">break</span>;
        <span class="keyword">case</span> TiltValuator:
            m_color<span class="operator">.</span>setAlpha(std<span class="operator">::</span>max(std<span class="operator">::</span>abs(vValue <span class="operator">-</span> <span class="number">127</span>)<span class="operator">,</span>
                                      std<span class="operator">::</span>abs(hValue <span class="operator">-</span> <span class="number">127</span>)));
            <span class="keyword">break</span>;
        <span class="keyword">default</span>:
            m_color<span class="operator">.</span>setAlpha(<span class="number">255</span>);
    }</pre></div>
<p>The alpha channel of <a href="./qcolor.htm" translate="no">QColor</a> is given as a number between 0 and 255 where 0 is transparent and 255 is opaque, or as a floating-point number where 0 is transparent and 1.0 is opaque. <a href="./qtabletevent.htm#pressure" translate="no">pressure()</a> returns the pressure as a qreal between 0.0 and 1.0. We get the smallest alpha values (i.e., the color is most transparent) when the pen is perpendicular to the tablet. We select the largest of the vertical and horizontal tilt values.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">    <span class="keyword">switch</span> (m_colorSaturationValuator) {
        <span class="keyword">case</span> VTiltValuator:
            m_color<span class="operator">.</span>setHsv(hue<span class="operator">,</span> vValue<span class="operator">,</span> value<span class="operator">,</span> alpha);
            <span class="keyword">break</span>;
        <span class="keyword">case</span> HTiltValuator:
            m_color<span class="operator">.</span>setHsv(hue<span class="operator">,</span> hValue<span class="operator">,</span> value<span class="operator">,</span> alpha);
            <span class="keyword">break</span>;
        <span class="keyword">case</span> PressureValuator:
            m_color<span class="operator">.</span>setHsv(hue<span class="operator">,</span> <span class="type">int</span>(event<span class="operator">-</span><span class="operator">&gt;</span>pressure() <span class="operator">*</span> <span class="number">255.0</span>)<span class="operator">,</span> value<span class="operator">,</span> alpha);
            <span class="keyword">break</span>;
        <span class="keyword">default</span>:
            ;
    }</pre></div>
<p>The color saturation in the HSV color model can be given as an integer between 0 and 255 or as a floating-point value between 0 and 1. We chose to represent alpha as an integer, so we call <a href="./qcolor.htm#setHsv" translate="no">setHsv()</a> with integer values. That means we need to multiply the pressure to a number between 0 and 255.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">    <span class="keyword">switch</span> (m_lineWidthValuator) {
        <span class="keyword">case</span> PressureValuator:
            m_pen<span class="operator">.</span>setWidthF(pressureToWidth(event<span class="operator">-</span><span class="operator">&gt;</span>pressure()));
            <span class="keyword">break</span>;
        <span class="keyword">case</span> TiltValuator:
            m_pen<span class="operator">.</span>setWidthF(std<span class="operator">::</span>max(std<span class="operator">::</span>abs(vValue <span class="operator">-</span> <span class="number">127</span>)<span class="operator">,</span>
                                     std<span class="operator">::</span>abs(hValue <span class="operator">-</span> <span class="number">127</span>)) <span class="operator">/</span> <span class="number">12</span>);
            <span class="keyword">break</span>;
        <span class="keyword">default</span>:
            m_pen<span class="operator">.</span>setWidthF(<span class="number">1</span>);
    }</pre></div>
<p>The width of the pen stroke can increase with pressure, if so chosen. But when the pen width is controlled by tilt, we let the width increase with the angle between the tool and the perpendicular of the tablet.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">    <span class="keyword">if</span> (event<span class="operator">-</span><span class="operator">&gt;</span>pointerType() <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span><span class="operator">::</span>Eraser) {
        m_brush<span class="operator">.</span>setColor(<span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>white);
        m_pen<span class="operator">.</span>setColor(<span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>white);
        m_pen<span class="operator">.</span>setWidthF(event<span class="operator">-</span><span class="operator">&gt;</span>pressure() <span class="operator">*</span> <span class="number">10</span> <span class="operator">+</span> <span class="number">1</span>);
    } <span class="keyword">else</span> {
        m_brush<span class="operator">.</span>setColor(m_color);
        m_pen<span class="operator">.</span>setColor(m_color);
    }
}</pre></div>
<p>We finally check whether the pointer is the stylus or the eraser. If it is the eraser, we set the color to the background color of the pixmap and let the pressure decide the pen width, else we set the colors we have decided previously in the function.</p>
<a name="tabletapplication-class-definition"></a>
<h4 id="tabletapplication-class-definition">TabletApplication Class Definition<a class="plink" href="#tabletapplication-class-definition" title="Direct link to this headline"></a></h4>
<p>We inherit <a href="./qapplication.htm" translate="no">QApplication</a> in this class because we want to reimplement the <a href="./qapplication.htm#event" translate="no">event()</a> function.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="keyword">class</span> TabletApplication : <span class="keyword">public</span> <span class="type"><a href="./qapplication.htm" translate="no">QApplication</a></span>
{
    Q_OBJECT

<span class="keyword">public</span>:
    <span class="keyword">using</span> <span class="type"><a href="./qapplication.htm" translate="no">QApplication</a></span><span class="operator">::</span><span class="type"><a href="./qapplication.htm" translate="no">QApplication</a></span>;

    bool event(<span class="type"><a href="./qevent.htm" translate="no">QEvent</a></span> <span class="operator">*</span>event) override;
    <span class="type">void</span> setCanvas(TabletCanvas <span class="operator">*</span>canvas)
        { m_canvas <span class="operator">=</span> canvas; }

<span class="keyword">private</span>:
    TabletCanvas <span class="operator">*</span>m_canvas <span class="operator">=</span> nullptr;
};</pre></div>
<p><code translate="no">TabletApplication</code> exists as a subclass of <a href="./qapplication.htm" translate="no">QApplication</a> in order to receive tablet proximity events and forward them to <code translate="no">TabletCanvas</code>. The <code translate="no">TabletEnterProximity</code> and <code translate="no">TabletLeaveProximity</code> events are sent to the <a href="./qapplication.htm" translate="no">QApplication</a> object, while other tablet events are sent to the <a href="./qwidget.htm" translate="no">QWidget</a>'s <code translate="no">event()</code> hander, which sends them on to <a href="./qwidget.htm#tabletEvent" translate="no">tabletEvent()</a>.</p>
<a name="tabletapplication-class-implementation"></a>
<h4 id="tabletapplication-class-implementation">TabletApplication Class Implementation<a class="plink" href="#tabletapplication-class-implementation" title="Direct link to this headline"></a></h4>
<p>Here is the implementation of <code translate="no">event()</code>:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">bool TabletApplication<span class="operator">::</span>event(<span class="type"><a href="./qevent.htm" translate="no">QEvent</a></span> <span class="operator">*</span>event)
{
    <span class="keyword">if</span> (event<span class="operator">-</span><span class="operator">&gt;</span>type() <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="./qevent.htm" translate="no">QEvent</a></span><span class="operator">::</span>TabletEnterProximity <span class="operator">|</span><span class="operator">|</span>
        event<span class="operator">-</span><span class="operator">&gt;</span>type() <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="./qevent.htm" translate="no">QEvent</a></span><span class="operator">::</span>TabletLeaveProximity) {
        m_canvas<span class="operator">-</span><span class="operator">&gt;</span>setTabletDevice(<span class="keyword">static_cast</span><span class="operator">&lt;</span><span class="type"><a href="./qtabletevent.htm" translate="no">QTabletEvent</a></span> <span class="operator">*</span><span class="operator">&gt;</span>(event));
        <span class="keyword">return</span> <span class="keyword">true</span>;
    }
    <span class="keyword">return</span> <span class="type"><a href="./qapplication.htm" translate="no">QApplication</a></span><span class="operator">::</span>event(event);
}</pre></div>
<p>We use this function to handle the <code translate="no">TabletEnterProximity</code> and <code translate="no">TabletLeaveProximity</code> events, which are generated when a drawing tool enters or leaves the proximity of the tablet. Here we call <code translate="no">TabletCanvas::setTabletDevice()</code>, which then calls <code translate="no">updateCursor()</code>, which will set an appropriate cursor. This is the only reason we need the proximity events; for the purpose of correct drawing, it is enough for <code translate="no">TabletCanvas</code> to observe the <a href="./qtabletevent-obsolete.htm#device" translate="no">device()</a> and <a href="./qtabletevent.htm#pointerType" translate="no">pointerType()</a> in each event that it receives.</p>
<a name="the-main-function"></a>
<h4 id="the-main-function">The <code translate="no">main()</code> function<a class="plink" href="#the-main-function" title="Direct link to this headline"></a></h4>
<p>Here is the example's <code translate="no">main()</code> function:</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">int</span> main(<span class="type">int</span> argv<span class="operator">,</span> <span class="type">char</span> <span class="operator">*</span>args<span class="operator">[</span><span class="operator">]</span>)
{
    TabletApplication app(argv<span class="operator">,</span> args);
    TabletCanvas <span class="operator">*</span>canvas <span class="operator">=</span> <span class="keyword">new</span> TabletCanvas;
    app<span class="operator">.</span>setCanvas(canvas);

    MainWindow mainWindow(canvas);
    mainWindow<span class="operator">.</span>resize(<span class="number">500</span><span class="operator">,</span> <span class="number">500</span>);
    mainWindow<span class="operator">.</span>show();
    <span class="keyword">return</span> app<span class="operator">.</span>exec();
}</pre></div>
<p>Here we create a <code translate="no">MainWindow</code> and display it as a top level window. We use the <code translate="no">TabletApplication</code> class. We need to set the canvas after the application is created. We cannot use classes that implement event handling before an <a href="./qapplication.htm" translate="no">QApplication</a> object is instantiated.</p>
<p><a href="https://code.qt.io/cgit/qt/qtbase.git/tree/examples/widgets/widgets/tablet?h=5.15" translate="no">Example project @ code.qt.io</a></p>
</div>
<!-- @@@widgets/tablet -->
</div>
<p class="copy-notice">
<acronym title="Copyright"></acronym> 2025 The Qt Company Ltd.
   Documentation contributions included herein are the copyrights of
   their respective owners.     The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the Free Software Foundation.     Qt and respective logos are <a href="https://doc.qt.io/qt/trademarks.html">    trademarks</a> of The Qt Company Ltd. in Finland and/or other countries
   worldwide. All other trademarks are property of their respective owners. </p>

                    </div>
                </article>
                
            </div>
        </div>
    </div>
</div>
</body></html>