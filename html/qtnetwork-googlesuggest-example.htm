<html lang="en"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Google Suggest Example | Qt Network</title>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <!-- Google Tag Manager -->
    
  <!-- End Google Tag Manager -->
  
  
</head>
<body class="qt-design-system" style="background:var(--content-bg-color)" onload="prettyPrint()">

<div data-global-resource-path="qt-design-system/components/b-sidebar.html">
    <div class="b-sidebar b-sidebar--full-width">
        
        <div class="b-sidebar__content">
            <div class="b-sidebar__topbar" data-margin-bottom="sm">
                <div class="b-topbar">
                                        <div class="b-topbar__breadcrump" translate="no">
                        <ul class="c-breadcrump">
                            <li><a href="./index.htm" translate="no">Qt 5.15</a></li>
                            <li><a href="./qtnetwork-index.htm" translate="no">Qt Network</a></li>
                            <li><a href="./examples-network.htm" translate="no">Network Examples</a></li>
                            <li><a>Google Suggest Example</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="b-sidebar__content__wrapper">
                <article class="b-sidebar__content__left">
                    <div class="context mainContent" style="margin: 0;padding: 0; background: 0;">
                    

<div class="context">
<h1 class="title">Google Suggest Example</h1>
<span class="subtitle"></span>
<!-- $$$googlesuggest-brief -->
<p>Obtains the list of search recommendations by the Google search engine.</p>
<!-- @@@googlesuggest -->
<!-- $$$googlesuggest-description -->
<div class="descr"> <a name="details"></a>
<p>The example uses the <a href="./qnetworkaccessmanager.htm" translate="no">QNetworkAccessManager</a> to obtain the list of search recommendations by Google as the user types into a QLineEdit.</p>
<p class="centerAlign"><img alt="" src="./images/googlesuggest-example.png"></p><p>The application makes use of the <code translate="no">get</code> function in <a href="./qnetworkaccessmanager.htm" translate="no">QNetworkAccessManager</a> to post a request and obtain the result of the search query sent to the Google search engine. The results returned are listed as clickable links appearing below the search box as a drop-down menu.</p>
<p>The widget is built up by a QLineEdit as the search box, and a QTreeView used as a popup menu below the search box.</p>
<a name="gsuggestcompletion-class-declaration"></a>
<h4 id="gsuggestcompletion-class-declaration">GSuggestCompletion Class Declaration<a class="plink" href="#gsuggestcompletion-class-declaration" title="Direct link to this headline"></a></h4>
<p>This class implements an event filter and a number of functions to display the search results and to determent when and how to perform the search.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="keyword">class</span> GSuggestCompletion : <span class="keyword">public</span> <span class="type"><a href="./qobject.htm" translate="no">QObject</a></span>
{
    Q_OBJECT

<span class="keyword">public</span>:
    <span class="keyword">explicit</span> GSuggestCompletion(<span class="type">QLineEdit</span> <span class="operator">*</span>parent <span class="operator">=</span> nullptr);
    <span class="operator">~</span>GSuggestCompletion();
    bool eventFilter(<span class="type"><a href="./qobject.htm" translate="no">QObject</a></span> <span class="operator">*</span>obj<span class="operator">,</span> <span class="type"><a href="./qevent.htm" translate="no">QEvent</a></span> <span class="operator">*</span>ev) override;
    <span class="type">void</span> showCompletion(<span class="keyword">const</span> <span class="type"><a href="./qvector.htm" translate="no">QVector</a></span><span class="operator">&lt;</span><span class="type"><a href="./qstring.htm" translate="no">QString</a></span><span class="operator">&gt;</span> <span class="operator">&amp;</span>choices);

<span class="keyword">public</span> <span class="keyword">slots</span>:

    <span class="type">void</span> doneCompletion();
    <span class="type">void</span> preventSuggest();
    <span class="type">void</span> autoSuggest();
    <span class="type">void</span> handleNetworkData(<span class="type"><a href="./qnetworkreply.htm" translate="no">QNetworkReply</a></span> <span class="operator">*</span>networkReply);

<span class="keyword">private</span>:
    <span class="type">QLineEdit</span> <span class="operator">*</span>editor <span class="operator">=</span> nullptr;
    <span class="type">QTreeWidget</span> <span class="operator">*</span>popup <span class="operator">=</span> nullptr;
    <span class="type"><a href="./qtimer.htm" translate="no">QTimer</a></span> timer;
    <span class="type"><a href="./qnetworkaccessmanager.htm" translate="no">QNetworkAccessManager</a></span> networkManager;
};</pre></div>
<p>The class connects to a QLineEdit and uses a QTreeWidget to display the results. A <a href="./qtimer.htm" translate="no">QTimer</a> controls the start of the network requests that are executed using a <a href="./qnetworkaccessmanager.htm" translate="no">QNetworkAccessManager</a>.</p>
<a name="gsuggestcompletion-class-implementation"></a>
<h4 id="gsuggestcompletion-class-implementation">GSuggestCompletion Class Implementation<a class="plink" href="#gsuggestcompletion-class-implementation" title="Direct link to this headline"></a></h4>
<p>We start by defining a constant containing the URL to be used in the Google queries. This is the basis for the query. The letters typed into the search box will be added to the query to perform the search itself.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="keyword">const</span> <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> gsuggestUrl(<span class="type"><a href="./qstring.htm#QStringLiteral" translate="no">QStringLiteral</a></span>(<span class="string">"http://google.com/complete/search?output=toolbar&amp;q=%1"</span>));</pre></div>
<p>In the constructor, we set the parent of this GSuggestCompletion instance to be the QLineEdit passed in. For simplicity, the QLineEdit is also stored in the explicit <code translate="no">editor</code> member variable.</p>
<p>We then create a QTreeWidget as a toplevel widget and configure the various properties to give it the look of a popup widget. The widget is populated with the results by Google Suggest API request.</p>
<p>Furthermore, we install the GSuggestCompletion instance as an event filter on the QTreeWidget, and connect the <code translate="no">itemClicked()</code> signal with the <code translate="no">doneCompletion()</code> slot.</p>
<p>A single-shot <a href="./qtimer.htm" translate="no">QTimer</a> is used to start the request when the user has stopped typing for 500 ms.</p>
<p>Finally, we connect the networkManagers <code translate="no">finished()</code> signal with the <code translate="no">handleNetworkData()</code> slot to handle the incoming data.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">GSuggestCompletion<span class="operator">::</span>GSuggestCompletion(<span class="type">QLineEdit</span> <span class="operator">*</span>parent): <span class="type"><a href="./qobject.htm" translate="no">QObject</a></span>(parent)<span class="operator">,</span> editor(parent)
{
    popup <span class="operator">=</span> <span class="keyword">new</span> <span class="type">QTreeWidget</span>;
    popup<span class="operator">-</span><span class="operator">&gt;</span>setWindowFlags(<span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>Popup);
    popup<span class="operator">-</span><span class="operator">&gt;</span>setFocusPolicy(<span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>NoFocus);
    popup<span class="operator">-</span><span class="operator">&gt;</span>setFocusProxy(parent);
    popup<span class="operator">-</span><span class="operator">&gt;</span>setMouseTracking(<span class="keyword">true</span>);

    popup<span class="operator">-</span><span class="operator">&gt;</span>setColumnCount(<span class="number">1</span>);
    popup<span class="operator">-</span><span class="operator">&gt;</span>setUniformRowHeights(<span class="keyword">true</span>);
    popup<span class="operator">-</span><span class="operator">&gt;</span>setRootIsDecorated(<span class="keyword">false</span>);
    popup<span class="operator">-</span><span class="operator">&gt;</span>setEditTriggers(<span class="type">QTreeWidget</span><span class="operator">::</span>NoEditTriggers);
    popup<span class="operator">-</span><span class="operator">&gt;</span>setSelectionBehavior(<span class="type">QTreeWidget</span><span class="operator">::</span>SelectRows);
    popup<span class="operator">-</span><span class="operator">&gt;</span>setFrameStyle(<span class="type">QFrame</span><span class="operator">::</span>Box <span class="operator">|</span> <span class="type">QFrame</span><span class="operator">::</span>Plain);
    popup<span class="operator">-</span><span class="operator">&gt;</span>setHorizontalScrollBarPolicy(<span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>ScrollBarAlwaysOff);
    popup<span class="operator">-</span><span class="operator">&gt;</span>header()<span class="operator">-</span><span class="operator">&gt;</span>hide();

    popup<span class="operator">-</span><span class="operator">&gt;</span>installEventFilter(<span class="keyword">this</span>);

    connect(popup<span class="operator">,</span> <span class="operator">&amp;</span><span class="type">QTreeWidget</span><span class="operator">::</span>itemClicked<span class="operator">,</span>
            <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>GSuggestCompletion<span class="operator">::</span>doneCompletion);

    timer<span class="operator">.</span>setSingleShot(<span class="keyword">true</span>);
    timer<span class="operator">.</span>setInterval(<span class="number">500</span>);
    connect(<span class="operator">&amp;</span>timer<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qtimer.htm" translate="no">QTimer</a></span><span class="operator">::</span>timeout<span class="operator">,</span>
            <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>GSuggestCompletion<span class="operator">::</span>autoSuggest);
    connect(editor<span class="operator">,</span> <span class="operator">&amp;</span><span class="type">QLineEdit</span><span class="operator">::</span>textEdited<span class="operator">,</span>
            <span class="operator">&amp;</span>timer<span class="operator">,</span> <span class="type">QOverload</span><span class="operator">&lt;</span><span class="operator">&gt;</span><span class="operator">::</span>of(<span class="operator">&amp;</span><span class="type"><a href="./qtimer.htm" translate="no">QTimer</a></span><span class="operator">::</span>start));

    connect(<span class="operator">&amp;</span>networkManager<span class="operator">,</span> <span class="operator">&amp;</span><span class="type"><a href="./qnetworkaccessmanager.htm" translate="no">QNetworkAccessManager</a></span><span class="operator">::</span>finished<span class="operator">,</span>
            <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>GSuggestCompletion<span class="operator">::</span>handleNetworkData);

}</pre></div>
<p>Since the QTreeWidget popup has been instantiated as a toplevel widget, the destructor has to delete it explicitly from memory to avoid a memory leak.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">GSuggestCompletion<span class="operator">::</span><span class="operator">~</span>GSuggestCompletion()
{
    <span class="keyword">delete</span> popup;
}</pre></div>
<p>The event filter handles mouse press and key press events that are delivered to the popup. For mouse press events we just hide the popup and return focus to the editor widget, and then return true to prevent further event processing.</p>
<p>Key event handling is implemented so that Enter and Return execute the selected link, while the Escape key hides the popup. Since we want to be able to navigate the list of suggestions using the different navigation keys on the keyboard we let Qt continue regular event processing for those by returning false from the eventFilter reimplementation.</p>
<p>For all other keys, the event will be passed on to the editor widget and the popup is hidden. This way the user's typing will not be interrupted by the popping up of the completion list.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">bool GSuggestCompletion<span class="operator">::</span>eventFilter(<span class="type"><a href="./qobject.htm" translate="no">QObject</a></span> <span class="operator">*</span>obj<span class="operator">,</span> <span class="type"><a href="./qevent.htm" translate="no">QEvent</a></span> <span class="operator">*</span>ev)
{
    <span class="keyword">if</span> (obj <span class="operator">!</span><span class="operator">=</span> popup)
        <span class="keyword">return</span> <span class="keyword">false</span>;

    <span class="keyword">if</span> (ev<span class="operator">-</span><span class="operator">&gt;</span>type() <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="./qevent.htm" translate="no">QEvent</a></span><span class="operator">::</span>MouseButtonPress) {
        popup<span class="operator">-</span><span class="operator">&gt;</span>hide();
        editor<span class="operator">-</span><span class="operator">&gt;</span>setFocus();
        <span class="keyword">return</span> <span class="keyword">true</span>;
    }

    <span class="keyword">if</span> (ev<span class="operator">-</span><span class="operator">&gt;</span>type() <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="./qevent.htm" translate="no">QEvent</a></span><span class="operator">::</span>KeyPress) {
        bool consumed <span class="operator">=</span> <span class="keyword">false</span>;
        <span class="type">int</span> key <span class="operator">=</span> <span class="keyword">static_cast</span><span class="operator">&lt;</span><span class="type"><a href="./qkeyevent.htm" translate="no">QKeyEvent</a></span><span class="operator">*</span><span class="operator">&gt;</span>(ev)<span class="operator">-</span><span class="operator">&gt;</span>key();
        <span class="keyword">switch</span> (key) {
        <span class="keyword">case</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>Key_Enter:
        <span class="keyword">case</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>Key_Return:
            doneCompletion();
            consumed <span class="operator">=</span> <span class="keyword">true</span>;
            <span class="keyword">break</span>;

        <span class="keyword">case</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>Key_Escape:
            editor<span class="operator">-</span><span class="operator">&gt;</span>setFocus();
            popup<span class="operator">-</span><span class="operator">&gt;</span>hide();
            consumed <span class="operator">=</span> <span class="keyword">true</span>;
            <span class="keyword">break</span>;

        <span class="keyword">case</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>Key_Up:
        <span class="keyword">case</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>Key_Down:
        <span class="keyword">case</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>Key_Home:
        <span class="keyword">case</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>Key_End:
        <span class="keyword">case</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>Key_PageUp:
        <span class="keyword">case</span> <span class="type"><a href="./qt.htm" translate="no">Qt</a></span><span class="operator">::</span>Key_PageDown:
            <span class="keyword">break</span>;

        <span class="keyword">default</span>:
            editor<span class="operator">-</span><span class="operator">&gt;</span>setFocus();
            editor<span class="operator">-</span><span class="operator">&gt;</span>event(ev);
            popup<span class="operator">-</span><span class="operator">&gt;</span>hide();
            <span class="keyword">break</span>;
        }

        <span class="keyword">return</span> consumed;
    }

    <span class="keyword">return</span> <span class="keyword">false</span>;
}</pre></div>
<p>The <code translate="no">showCompletion()</code> function populates the QTreeWidget with the results returned from the query. It takes a <a href="./qstringlist.htm" translate="no">QStringList</a> of the suggested search terms.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> GSuggestCompletion<span class="operator">::</span>showCompletion(<span class="keyword">const</span> <span class="type"><a href="./qvector.htm" translate="no">QVector</a></span><span class="operator">&lt;</span><span class="type"><a href="./qstring.htm" translate="no">QString</a></span><span class="operator">&gt;</span> <span class="operator">&amp;</span>choices)
{
    <span class="keyword">if</span> (choices<span class="operator">.</span>isEmpty())
        <span class="keyword">return</span>;

    <span class="keyword">const</span> <span class="type"><a href="./qpalette.htm" translate="no">QPalette</a></span> <span class="operator">&amp;</span>pal <span class="operator">=</span> editor<span class="operator">-</span><span class="operator">&gt;</span>palette();
    <span class="type"><a href="./qcolor.htm" translate="no">QColor</a></span> color <span class="operator">=</span> pal<span class="operator">.</span>color(<span class="type"><a href="./qpalette.htm" translate="no">QPalette</a></span><span class="operator">::</span>Disabled<span class="operator">,</span> <span class="type"><a href="./qpalette.htm" translate="no">QPalette</a></span><span class="operator">::</span>WindowText);

    popup<span class="operator">-</span><span class="operator">&gt;</span>setUpdatesEnabled(<span class="keyword">false</span>);
    popup<span class="operator">-</span><span class="operator">&gt;</span>clear();

    <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> <span class="operator">&amp;</span>choice : choices) {
        <span class="keyword">auto</span> item  <span class="operator">=</span> <span class="keyword">new</span> <span class="type">QTreeWidgetItem</span>(popup);
        item<span class="operator">-</span><span class="operator">&gt;</span>setText(<span class="number">0</span><span class="operator">,</span> choice);
        item<span class="operator">-</span><span class="operator">&gt;</span>setForeground(<span class="number">0</span><span class="operator">,</span> color);
    }

    popup<span class="operator">-</span><span class="operator">&gt;</span>setCurrentItem(popup<span class="operator">-</span><span class="operator">&gt;</span>topLevelItem(<span class="number">0</span>));
    popup<span class="operator">-</span><span class="operator">&gt;</span>resizeColumnToContents(<span class="number">0</span>);
    popup<span class="operator">-</span><span class="operator">&gt;</span>setUpdatesEnabled(<span class="keyword">true</span>);

    popup<span class="operator">-</span><span class="operator">&gt;</span>move(editor<span class="operator">-</span><span class="operator">&gt;</span>mapToGlobal(<span class="type"><a href="./qpoint.htm" translate="no">QPoint</a></span>(<span class="number">0</span><span class="operator">,</span> editor<span class="operator">-</span><span class="operator">&gt;</span>height())));
    popup<span class="operator">-</span><span class="operator">&gt;</span>setFocus();
    popup<span class="operator">-</span><span class="operator">&gt;</span>show();
}</pre></div>
<p>A QTreeWidgetItem is created for each index in the list and inserted into the QTreeWidget. Finally, we adjust position and size of the popup to make sure that it pops up in the correct position below the editor, and show it.</p>
<p>The <code translate="no">doneCompletion()</code> function, which is called by the event filter when either Enter or Return keys are pressed, stops the timer to prevent further requests and passes the text of the selected item to the editor. We then make the <code translate="no">editor</code> QLineEdit emit the returnPressed() signal, to which the application can connect to open the respective web page.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> GSuggestCompletion<span class="operator">::</span>doneCompletion()
{
    timer<span class="operator">.</span>stop();
    popup<span class="operator">-</span><span class="operator">&gt;</span>hide();
    editor<span class="operator">-</span><span class="operator">&gt;</span>setFocus();
    <span class="type">QTreeWidgetItem</span> <span class="operator">*</span>item <span class="operator">=</span> popup<span class="operator">-</span><span class="operator">&gt;</span>currentItem();
    <span class="keyword">if</span> (item) {
        editor<span class="operator">-</span><span class="operator">&gt;</span>setText(item<span class="operator">-</span><span class="operator">&gt;</span>text(<span class="number">0</span>));
        <span class="type"><a href="./qmetaobject.htm" translate="no">QMetaObject</a></span><span class="operator">::</span>invokeMethod(editor<span class="operator">,</span> <span class="string">"returnPressed"</span>);
    }
}</pre></div>
<p>The <code translate="no">autoSuggest()</code> slot is called when the timer times out, and uses the text in the editor to build the complete search query. The query is then passed to the <a href="./qnetworkaccessmanager.htm" translate="no">QNetworkAccessManager</a>'s <code translate="no">get()</code> function to start the request.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> GSuggestCompletion<span class="operator">::</span>autoSuggest()
{
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> str <span class="operator">=</span> editor<span class="operator">-</span><span class="operator">&gt;</span>text();
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> url <span class="operator">=</span> gsuggestUrl<span class="operator">.</span>arg(str);
    networkManager<span class="operator">.</span>get(<span class="type"><a href="./qnetworkrequest.htm" translate="no">QNetworkRequest</a></span>(url));
}</pre></div>
<p>The function <code translate="no">preventSuggest()</code> stops the timer to prevent further requests from being started.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> GSuggestCompletion<span class="operator">::</span>preventSuggest()
{
    timer<span class="operator">.</span>stop();
}</pre></div>
<p>When the network request is finished, the <a href="./qnetworkaccessmanager.htm" translate="no">QNetworkAccessManager</a> delivers the data received from the server through the networkReply object.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> GSuggestCompletion<span class="operator">::</span>handleNetworkData(<span class="type"><a href="./qnetworkreply.htm" translate="no">QNetworkReply</a></span> <span class="operator">*</span>networkReply)
{
    <span class="type"><a href="./qurl.htm" translate="no">QUrl</a></span> url <span class="operator">=</span> networkReply<span class="operator">-</span><span class="operator">&gt;</span>url();
    <span class="keyword">if</span> (networkReply<span class="operator">-</span><span class="operator">&gt;</span>error() <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="./qnetworkreply.htm" translate="no">QNetworkReply</a></span><span class="operator">::</span>NoError) {
        <span class="type"><a href="./qvector.htm" translate="no">QVector</a></span><span class="operator">&lt;</span><span class="type"><a href="./qstring.htm" translate="no">QString</a></span><span class="operator">&gt;</span> choices;

        <span class="type"><a href="./qbytearray.htm" translate="no">QByteArray</a></span> response(networkReply<span class="operator">-</span><span class="operator">&gt;</span>readAll());
        <span class="type"><a href="./qxmlstreamreader.htm" translate="no">QXmlStreamReader</a></span> xml(response);
        <span class="keyword">while</span> (<span class="operator">!</span>xml<span class="operator">.</span>atEnd()) {
            xml<span class="operator">.</span>readNext();
            <span class="keyword">if</span> (xml<span class="operator">.</span>tokenType() <span class="operator">=</span><span class="operator">=</span> <span class="type"><a href="./qxmlstreamreader.htm" translate="no">QXmlStreamReader</a></span><span class="operator">::</span>StartElement)
                <span class="keyword">if</span> (xml<span class="operator">.</span>name() <span class="operator">=</span><span class="operator">=</span> <span class="string">"suggestion"</span>) {
                    <span class="type"><a href="./qstringref.htm" translate="no">QStringRef</a></span> str <span class="operator">=</span> xml<span class="operator">.</span>attributes()<span class="operator">.</span>value(<span class="string">"data"</span>);
                    choices <span class="operator">&lt;</span><span class="operator">&lt;</span> str<span class="operator">.</span>toString();
                }
        }

        showCompletion(choices);
    }

    networkReply<span class="operator">-</span><span class="operator">&gt;</span>deleteLater();
}</pre></div>
<p>To extract the data from the reply we use the <code translate="no">readAll()</code> function, which is inherited from <a href="./qiodevice.htm" translate="no">QIODevice</a> and returns a <a href="./qbytearray.htm" translate="no">QByteArray</a>. Since this data is encoded in XML we can use a <a href="./qxmlstreamreader.htm" translate="no">QXmlStreamReader</a> to traverse the data and extract the search result as QStrings, which we can stream into two QStringLists used to populate the popup.</p>
<p>Finally, we schedule the <a href="./qnetworkreply.htm" translate="no">QNetworkReply</a> object for deletion using the <code translate="no">deleteLater</code> function.</p>
<a name="searchbox-class-declaration"></a>
<h4 id="searchbox-class-declaration">SearchBox Class Declaration<a class="plink" href="#searchbox-class-declaration" title="Direct link to this headline"></a></h4>
<p>The SearchBox class inherits QLineEdit and adds the protected slot <code translate="no">doSearch()</code>.</p>
<p>A <code translate="no">GSuggestCompletion</code> member provides the SearchBox with the request functionality and the suggestions returned from the Google search engine.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="preprocessor">#include &lt;QLineEdit&gt;</span>

<span class="keyword">class</span> GSuggestCompletion;

<span class="keyword">class</span> SearchBox: <span class="keyword">public</span> <span class="type">QLineEdit</span>
{
    Q_OBJECT

<span class="keyword">public</span>:
    <span class="keyword">explicit</span> SearchBox(<span class="type">QWidget</span> <span class="operator">*</span>parent <span class="operator">=</span> nullptr);

<span class="keyword">protected</span> <span class="keyword">slots</span>:
    <span class="type">void</span> doSearch();

<span class="keyword">private</span>:
    GSuggestCompletion <span class="operator">*</span>completer <span class="operator">=</span> nullptr;</pre></div>
<a name="searchbox-class-implementation"></a>
<h4 id="searchbox-class-implementation">SearchBox Class Implementation<a class="plink" href="#searchbox-class-implementation" title="Direct link to this headline"></a></h4>
<p>The search box constructor instantiates the GSuggestCompletion object and connects the returnPressed() signal to the doSearch() slot.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no">SearchBox<span class="operator">::</span>SearchBox(<span class="type">QWidget</span> <span class="operator">*</span>parent)
    : <span class="type">QLineEdit</span>(parent)
    <span class="operator">,</span> completer(<span class="keyword">new</span> GSuggestCompletion(<span class="keyword">this</span>))
{
    connect(<span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>SearchBox<span class="operator">::</span>returnPressed<span class="operator">,</span> <span class="keyword">this</span><span class="operator">,</span> <span class="operator">&amp;</span>SearchBox<span class="operator">::</span>doSearch);

    setWindowTitle(<span class="string">"Search with Google"</span>);

    adjustSize();
    resize(<span class="number">400</span><span class="operator">,</span> height());
    setFocus();
}</pre></div>
<p>The function <code translate="no">doSearch()</code> stops the completer from sending any further queries to the search engine.</p>
<p>Further, the function extracts the selected search phrase and opens it in the default web browser using <a href="./qdesktopservices.htm" translate="no">QDesktopServices</a>.</p>
<div class="pre"><pre class="cpp prettyprint" translate="no"><span class="type">void</span> SearchBox<span class="operator">::</span>doSearch()
{
    completer<span class="operator">-</span><span class="operator">&gt;</span>preventSuggest();
    <span class="type"><a href="./qstring.htm" translate="no">QString</a></span> url <span class="operator">=</span> gsearchUrl<span class="operator">.</span>arg(text());
    <span class="type"><a href="./qdesktopservices.htm" translate="no">QDesktopServices</a></span><span class="operator">::</span>openUrl(url);
}</pre></div>
<p><a href="https://code.qt.io/cgit/qt/qtbase.git/tree/examples/network/googlesuggest?h=5.15" translate="no">Example project @ code.qt.io</a></p>
</div>
<!-- @@@googlesuggest -->
</div>
<p class="copy-notice">
<acronym title="Copyright">Â©</acronym> 2025 The Qt Company Ltd.
   Documentation contributions included herein are the copyrights of
   their respective owners.     The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the Free Software Foundation.     Qt and respective logos are <a href="https://doc.qt.io/qt/trademarks.html">    trademarks</a> of The Qt Company Ltd. in Finland and/or other countries
   worldwide. All other trademarks are property of their respective owners. </p>

                    </div>
                </article>
                
            </div>
        </div>
    </div>
</div>
</body></html>